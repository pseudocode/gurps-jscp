<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 4.01 Transitional//EN" "http://www.w3.org/TR/html4/loose.dtd">

<html>
<head>
  <title>GURPS NPC Record Card</title>

  <meta charset="utf-8" />

  <script type="text/javascript" src="../code/jquery.js"></script>
  <script type="text/javascript" src="../code/jquery.json.js"></script>
  <script type="text/javascript" src="../code/JSONstring.js"></script>
  <script type="text/javascript" src="../code/jquery-base64.js"></script><!-- used for encoding JSON in the Save link -->
  <script type="text/javascript" src="../code/jquery-ui/ui/jquery-ui.js"></script>

  <script type="text/javascript" src="../pro_drop_1/stuHover.js"></script>
  <script type="text/javascript" src="../code/simplesets.js"></script>

  <script type="text/javascript">
    var sheet = 'NPCcard';
    var characterFileName = '';
    //if (window.File && window.FileReader && window.FileList && window.Blob) {
    if (window.File && window.FileList && window.FileReader) {
      // Great - success! All the required File APIs are supported.
    } else {
      alert("The File APIs are not fully supported in this browser.\nYou may not be able to load Characters saved as local files.");
    }
  </script>

  <script type="text/javascript" src="../code/gurps.js"></script>
  <script type="text/javascript" src="../code/character.js"></script>
  <script type="text/javascript" src="../code/traits.js"></script>
  <script type="text/javascript" src="../code/skills.js"></script>
  <script type="text/javascript" src="../code/equipment.js"></script>

  <script type="text/javascript" src="../libraries/basic4e_library.js"></script>

  <link type="text/css" rel="stylesheet" href="../pro_drop_1/pro_drop_1.css" />
  <link type="text/css" rel="stylesheet" href="../css/gurps.css" />
  <link type="text/css" rel="stylesheet" href="../css/gurps4e.css" />
  <link type="text/css" rel="stylesheet" href="../css/gurps_green.css" id="themeCSSlink" title="theme" />
  <link type="text/css" rel="stylesheet" href="../css/gurps_print.css" media="print" />

</head>


<style>
.wrapper div {
  position: relative;
  text-align: center;
}
.BPgridrow td {
  border: 1px solid black;
  vertical-align: middle;
  height: 25px;
}
.angledHeaders td > div {
  font-weight: normal;
  transform: rotate(300deg);
  overflow: visible;
}
#SkillsBox span {
  white-space: nowrap;
}
</style>

<body>

  <div id="csheet_dialogs">
    
  <!-- File menu -->
    <div id="newCharDialog" class="dialog" style="max-width:none;">
      <form onSubmit="loadNewCharacterFromDialog(); return false;">
        <div class="titlebar">New character</div>
        <div class="dialogBody" style="margin-top:1em;">

          <table class="prefsTable">
            <colgroup>
              <col />
              <col />
              <col />
            </colgroup>
            <tbody>
              <tr>
                <th>Name&emsp;</th>
                <td colspan="4">
                  <input id="newCharName" type="text" placeholder="New Character" style="width:98%;"
                         onkeyup="document.getElementById('newChName').innerHTML=this.value"
                         onchange="document.getElementById('newChName').innerHTML=this.value" />
                </td>
              </tr>
              <tr>
                <th>Point&nbsp;Value&emsp;</th>
                <td>
                  <input id="newCharPoints" value="100" style="width:4em;" type="text"
                   onchange="if(ruleset.match(/e4/)){document.getElementById('newCharDisadPointsLimit').value=Math.floor(this.value/2)}"/>
                   <select id="newCharTemplate"></select>
                </td>
                <td colspan="2">
                  <label style="float:left; margin-right:2em; "><div style="float:left; line-height:24px">male  </div><input name="newCharGender" id="newCharGenderMale"   value="male"   type="radio" checked="checked" /></label>
                  <label style="float:left; margin-right:2em; "><div style="float:left; line-height:24px">female</div><input name="newCharGender" id="newCharGenderFemale" value="female" type="radio" /></label>
                  <label style="float:left; "><div style="float:left; line-height:24px">non   </div><input name="newCharGender" id="newCharGenderNon"    value="non"    type="radio" /></label>
                </td>
              </tr>
              <tr>
                <th>Point&nbsp;Limits&emsp;</th>
                <td>
                  <input id="newCharDisadPointsLimit" name="newCharDisadPointsLimit" style="width:4em;" />
                  pts in disads
                </td>
                <td colspan="2">
                  <input id="newCharQuirkPointsLimit" name="newCharQuirkPointsLimit" value="5" style="width:4em;" />
                  pts in quirks
                </td>
              </tr>
              <tr>
                <th>Ruleset&emsp;</th>
                <td>
                  <select id="newCharRuleset" onchange="newCharacterDialog(this.value)"></select>
                </td>
                <th style="padding-left:1em;">Tech&nbsp;Level&emsp;</th>
                <td>
                  <select id="newCharTL"></select>
                </td>
              </tr>
            </tbody>
          </table>

          <div class="fieldsetWrapper">

            <fieldset>

              <legend onclick="toggleFieldset2(document.getElementById('characterGenerationToggleButton'),'characterGenerationFormWrapper')">
                <img id="characterGenerationToggleButton" src="../images/plus_blue.gif" />
                <span id="characterGenerationFieldsetLegendText">Random Character Generation</span>
              </legend>

              <div class="fieldsetNote">If this section is open, choices entered here will be used with those above to generate a 'random' character.</div>

              <div id="characterGenerationFormWrapper" style="display:none; padding:0px;">

                <div>

                  <table class="prefsTable">
                    <colgroup>
                      <col />
                      <col />
                      <col style="width:24px" />
                      <col />
                      <col />
                      <col />
                    </colgroup>
                    <tbody>
                      <tr>
                        <th>Character Type&emsp;</th>
                        <td>
                          <select id="newCharType"></select>
                        </td>
                        <td>
                          <input type="checkbox" id="newCharRandomGender" style="padding:0"></input>
                        </td>
                        <td><label for="newCharRandomGender">&nbsp;randomize gender</label></td>
                      </tr>
                    </tbody>
                  </table>

                </div>

              </div><!-- #characterGenerationFormWrapper -->

            </fieldset>

          </div><!-- .fieldsetWrapper -->

          <input value="Close" style="float:left; width:auto; margin:1em;" onclick="document.getElementById('newCharDialog').style.display='none'; return false;" type="submit" />
          <button              style="float:right;"                        onclick="loadNewCharacterFromDialog(); return false;">Create&nbsp;<em id="newChName">New Character</em></button>
        </div>
      </form>
    </div>

    <div id="openFileDialog" class="dialog" style="left:4em; max-width:none; width:560px;">
      <form method="post">
        <div class="titlebar">Open local character file</div>
        <div style="padding:1em; text-align:left;">
          <input type="file" id="selectedFile" name="selectedFile" size="72" />
        <!--
          <br /><br />
          Load file into
          <select id="pageType" name="pageType">
            <option value="">current</option>
            <option value="3e1pg.html"          >3<sup>rd</sup> edition,    1-page</option>
            <option value="3e2pg.html"          >3<sup>rd</sup> edition,    2-page</option>
            <option value="4e2pg.html"          >4<sup>th</sup> edition,  standard</option>
            <option value="4e2pg_landscape.html">4<sup>th</sup> edition, landscape</option>
            <option value="Jim4e.html"          >4<sup>th</sup> edition,     remix</option>
          </select>
          sheet
        -->
          <div style="clear:both;"></div>
          <input type="submit" value="Close"     style="float: left; width:auto; margin:1em;" onClick="document.getElementById('openFileDialog').style.display='none'; return false;" />
          <input type="button" value="Open file" style="float:right; width:auto; margin:1em;" onClick="loadCharacterFromFile(/*this.form.pageType.value*/); return false;" />
        </div>
      </form>
    </div>

    <div id="openRemoteFileDialog" class="dialog" style="left:4em; max-width:none; width:560px;">
      <form method="post">
        <div class="titlebar">Open remote character file</div>
        <div class="dialogBody" style="padding:1em; text-align:left;">
          Enter or paste valid URL:
          <input type="text" id="fileURL" name="fileURL" style="width:40em;" />
          <div style="clear:both;"></div>
          <p>
            The server where the file is kept may need to have <span title="Cross-Origin Resource Sharing">CORS</span> enabled.
            Only JSON files created by JCSP will be compatible.
          </p>
          <div style="clear:both;"></div>
          <input type="submit" value="Close"     style="float: left; width:auto; margin:1em;" onClick="document.getElementById('openRemoteFileDialog').style.display='none'; return false;" />
          <input type="button" value="Open file" style="float:right; width:auto; margin:1em;" onClick="loadCharacterFromURL(); return false;" />
        </div>
      </form>
    </div>

    <!-- Open New Sheet flyout -->

    <!-- - - - - - -->

    <!-- View As File (not a dialog) -->

    <!-- Save As File (not a dialog) -->

    <div id="saveAsTemplateDialog" class="dialog">
      <form id="saveAsTemplateForm" name="saveAsTemplateForm" method="post">
        <div class="titlebar">Save a custom Template</div>
        <div class="dialogBody" style="margin-top:1em;">
          <div style="text-align:left;">
            The attributes, traits, and skills in this character sheet will be packaged into a
            template.
          </div>
          <div style="margin-top:1em; text-align:left; font-weight:bold;">
            Template name:
            <input id="templateName" onchange="document.getElementById('newTemplateName').innerHTML=this.value"
                                      onkeyup="document.getElementById('newTemplateName').innerHTML=this.value" />
            <div style="clear: both;"></div>
            <input id="applyTemplate"  name="templateSaveOption" value="apply"  type="radio" style="width:1em;" />
            <label for="applyTemplate" title="A new character will be created with this template already applied to it.">apply to a new character</label>
  <!--
  -->
            <br />
            <input id="offerTemplate" name="templateSaveOption" value="offer" type="radio" style="width:1em;" />
            <label for="offerTemplate" title="The template created will be temporarily available in the 'Use a Template' menu, until the browser page is reloaded.">load into the 'Use a Template' menu (temporary)</label>
            <br />
            <input id="exportTemplate" name="templateSaveOption" value="export" type="radio" style="width:1em;" />
  <!-- title="A text file will be created that can be saved, and/or appended to a library file using a text editor.  Templates properly appended to an included library file should become permanently available in the 'Use a Template' menu." -->
            <label for="exportTemplate" title="Template will be saved as a character file.  Re-open the file later to use the 'apply to a new character' option.">export as a template file</label>
          </div>
          <input value="Close" style="float:left;  width:auto; margin:1em;" onclick="document.getElementById('saveAsTemplateDialog').style.display='none'; return false;" type="submit" />
          <button              style="float:right;"                         onclick="createTemplate(); return false;">Save&nbsp;<em id="newTemplateName"></em>&nbsp;&nbsp;template</button>
        </div>
      </form>
    </div>

    <!-- - - - - - -->

    <input type="file" id="uploadLibrary" name="uploadLibrary" onchange="loadLibrary(this.value);" size="72" style="display:none;" />

    <!-- - - - - - -->

    <div id="applyCharacterArtDialog" class="dialog">
      <form method="post" name="applyCharacterArtForm">
        <div class="titlebar">Character Art</div>
        <div style="padding: 1em; text-align:left;">
          <input type="file" id="characterArtFile" name="selectedFile" onchange="document.getElementById('characterArtPath').value=this.value" style="width:100%" />
        </div>
        <div style="padding:1em;">
          <span style="font-size:9pt;">Copy/paste the path you navigated to above into this text box:</span>
          <input id="characterArtPath" name="characterArtPath" style="width:100%" />
          <span style="font-size:9pt;">
            You may use an absolute file path, or a relative path to a local file based on the location of this HTML file.
            The file browser above will likely not show the path to the file, but the file browser window it opens will.
            You may also use an internet URL.
          </span>
        </div>
        <input type="submit" value="Close"     style="float: left; width:auto; margin:1em;" onClick="document.getElementById('applyCharacterArtDialog').style.display='none'; return false;" />
        <input type="button" value="Find File" style="float:right; width:auto; margin:1em;" onClick="loadCharacterArt(); return false;" />
      </form>
    </div>
  
    <!-- - - - - - -->

    <!-- Print (not a dialog) -->


  <!-- Edit menu -->
    <!-- Undo (not a dialog) -->

    <!-- Redo (not a dialog) -->

    <!-- - - - - - -->

    <div id="editTraitDialog" class="dialog">

      <form method="post" id="editTraitForm" name="editTraitForm">

        <div class="titlebar">Edit Advantage or Disadvantage</div>

        <div class="dialogBody" style="margin-top:1em;">

          <select id="editTraitMenu" name="editTraitMenu" size="6" style="width: 100%;" onchange="showEditTraitInfoInDialog(this.value);">
          </select>

          <div style="float:left; width:auto; padding:0" >
            edit
            <a href="#" onclick="openEditListDialog('advantages')" >advantages</a>
            list
          </div>
          <div id="displayTraitRefund" class="noticeBox" style="text-align:right;">&nbsp;</div>


          <table class="prefsTable">
            <tbody>
              <!-- remove trait -->
              <tr>
                <td style="width:2em;"><input type="radio" id="deleteTraitAction" name="editTraitAction" value="delete" checked="checked" onclick="showEditTraitInfoInDialog(this.form.editTraitMenu.value)" /></td>
                <td colspan="2"><label for="deleteTraitAction">remove <span id="adType_Name_remove"></span></label></td>
              </tr>
              <!-- insert formatting -->
              <tr>
                <td><input type="radio" id="formatTraitAction" name="editTraitAction" value="insert after" onclick="showEditTraitInfoInDialog(this.form.editTraitMenu.value);" /></td>
                <td><label for="formatTraitAction">insert formatting after <span id="TraitType_Name_format"></span> row</label></td>
              </tr>
              <tr>
                <td></td>
                <td>

                  <table id="editTraitsListFormattingTable" style="display:none; width:100%;">
                    <colgroup>
                      <col style="width:2em;" />
                      <col />
                    </colgroup>
                    <tbody>
                      <!-- insert a spacer row -->
                      <tr id="insertTraitSpacerTR">
                        <td><input id="insertTraitsListSpacerChbox" name="insertTraitsListFormattingChbox" type="radio" value="space" checked="checked" /></td>
                        <td><label for="insertTraitsListSpacerChbox">insert a spacer row</label></td>
                      </tr>
                      <!-- insert a heading -->
                      <tr id="insertTraitHeadingTR">
                        <td><input id="insertTraitsListHeadingChbox" name="insertTraitsListFormattingChbox" type="radio" value="heading" /></td>
                        <td><label for="insertTraitsListHeadingChbox">insert heading:&ensp;<input id="insertTraitHeadingText" style="width:20em;" /></label></td>
                      </tr>
                    </tbody>
                  </table>

                </td>
              </tr>
              <!-- edit trait -->
              <tr id="editRadioTR">
                <td><input type="radio" id="editTraitAction" name="editTraitAction" value="edit" onclick="showEditTraitInfoInDialog(this.form.editTraitMenu.value); toggleViewCB(this,'display','table',[document.getElementById('editTraitFieldsTable')])" /></td>
                <td colspan="2"><label for="editTraitAction">edit <span id="adType_Name_edit"></span></label></td>
              </tr>
            </tbody>
          </table>


          <table id="editTraitFieldsTable" class="prefsTable" style="display:none; width:100%;">
            <tbody>

              <!-- edit trait name text -->
              <tr id="editNameTR">
                <th>Name Text&emsp;</th>
                <td colspan="3"><input id="editNameText" style="width:98%;" /></td>
              </tr>

              <!-- change trait category (Mundane, Exotic, Supernatural) and type (social, physical, mental) -->
              <tr id="editTraitTypeTR">
                <th>Category&emsp;</th>
                <td id="editTraitCategoryTD">
                  <select id="editTraitCategory" name="editTraitCategory">
                    <option value="M" selected="selected">Mundane (default)</option>
                    <option value="Ex">Exotic</option>
                    <option value="Su">Supernatural</option>
                  </select>
                </td>
                <th>Type&emsp;</th>
                <td id="editTraitTypeTD">
                  <select id="editTraitType" name="editTraitType" style="width:100%;">
                    <option value="M" selected="selected">Mental</option>
                    <option value="P">Physical</option>
                    <option value="MP">Mntl/Phys</option>
                    <option value="So">Social</option>
                  </select>
                </td>
              </tr>

              <!-- edit description -->
              <tr id="editDescriptionTR1">
                <th>Description&emsp;</th>
                <td colspan="3"><input id="editDescription" style="width:98%;" /></td>
              </tr>

              <!-- change how many levels character has -->
              <tr id="editLevelsTR" style="visibility:hidden;">
                <th><span id="editTraitLevelsName">Level</span>&emsp;</th>
                <td id="editLevelsTD"><!-- put a select list here with level options --></td>
              </tr>

              <!-- alter basic cost -->
              <tr id="editRevalueTR1" style="display:none;">
                <th>Base Cost&emsp;</th>
                <td><input id="editCostValue" style="width: 4em; text-align:right;" onkeyup="showPointCostOrRecoup()" />pts</td>
              </tr>

              <!-- edit modifiers -->
              <tr>
                <td colspan="4">

                  <div class="fieldsetWrapper">

                    <fieldset>

                      <legend onclick="toggleFieldset2(document.getElementById('editTraitModifiersToggleButton'),'editTraitModifiersTable')">
                        <img id="editTraitModifiersToggleButton" src="../images/plus_blue.gif" />
                        Modifiers
                      </legend>

                      <table id="editTraitModifiersTable" class="prefsTable" style="display:none;">
                        <colgroup>
                          <col style="width:320px;" />
                        </colgroup>
                        <tbody>


                          <!-- alter 'constant' modifiers -->
                          <tr id="editConstantModsTR">
                            <td>
                              <a onclick="addNewConstantModRow('editTrait')" class="label">
                                <img id="editTraitConstantMod" src="../images/plus_blue.gif" />
                                <span>Constant Modifiers</span>
                              </a>
                              <table id="editTraitConstantModsTable" style="clear:both; text-align:left;">
                                <tbody></tbody>
                              </table>
                              <input type="hidden" id="editTraitConstantModRows" value="0" />
                            </td>
                          </tr>


                          <!-- alter multipliers -->
                          <tr id="editMultipliersTR">
                            <td>
                              <a onclick="addNewMultiplierRow('editTrait')" class="label">
                                <img id="editTraitMultiplier" src="../images/plus_blue.gif" />
                                <span>Multipliers</span>
                              </a>
                              <table id="editTraitMultipliersTable" style="clear:both; text-align:left;">
                                <tbody></tbody>
                              </table>
                              <input type="hidden" id="editTraitMultiplierRows" value="0" />
                            </td>
                          </tr>


                          <!-- alter enhancements and/or limitations -->
                          <tr id="editEnhLimTR">
                            <td>
                              <a onclick="addNewEnhLimRow('editTrait')" class="label">
                                <img id="editTraitEnhanceLimit" src="../images/plus_blue.gif" />
                                <span>Enhancements/Limitations</span>
                              </a>
                              <table id="editTraitEnhLimsTable" style="clear:both; text-align:left;">
                                <tbody></tbody>
                              </table>
                              <input type="hidden" id="editTraitEnhLimitRows" value="0" />
                            </td>
                          </tr>


                        </tbody>
                      </table>

                    </fieldset>

                  </div>

                </td>
              </tr>

            </tbody>
          </table>

  <!-- .fieldsetWrapper
          <div class="fieldsetWrapper">

            <fieldset>

              <legend onclick="toggleFieldset2(document.getElementById('editTraitsFiltersToggleButton'),'editTraitsFiltersTable')" style="cursor:pointer;">
                <img id="editTraitsFiltersToggleButton" src="../images/plus_blue.gif" />
                Filters
              </legend>

              <table id="editTraitsFiltersTable" class="customOptionsTable" style="display:none;">
                <colgroup>
                  <col style="width:5em" />
                </colgroup>
                <tbody>
                  <tr>
                    <th style="text-align:right;">Show</th>
                    <td><input type="checkbox" id="showAdsEdit"    name="showAdsEdit"    value="advantage"    checked="checked" onclick="editTraitDialog();" /><label for="showAdsEdit">advantages</label></td>
                    <td><input type="checkbox" id="showDisadsEdit" name="showDisadsEdit" value="disadvantage" checked="checked" onclick="editTraitDialog();" /><label for="showDisadsEdit">disadvantages</label></td>
                  </tr>
                  <tr>
                    <td>&nbsp;</td>
                    <td><input type="checkbox" id="showPerksEdit"  name="showPerksEdit"  value="perk"  checked="checked" onclick="editTraitDialog();" /><label for="showPerksEdit">perks</label></td>
                    <td><input type="checkbox" id="showQuirksEdit" name="showQuirksEdit" value="quirk" checked="checked" onclick="editTraitDialog();" /><label for="showQuirksEdit">quirks</label></td>
                  </tr>
                </tbody>
              </table>

            </fieldset>

          </div> -->

          <div style="clear: both;"></div>

          <input type="hidden" id="editTraitIndex" name="editTraitIndex" value="" />
          <button type="button" style="float:left;"  onclick="document.getElementById('editTraitDialog').style.display='none';">Close</button>
          <button type="button" style="float:right;" onclick="editTrait();" id="editTraitSubmit" disabled="disabled">edit an advantage</button>

        </div><!-- .dialogBody -->

      </form>

    </div>

    <div id="editSkillDialog" class="dialog" style="max-width:inherit;">

      <form method="post" id="editSkillForm" name="editSkillForm">

        <div class="titlebar">Edit <em><span id="editTitlebarSkilltype"></span></em> Skill</div>

        <div class="dialogBody" style="margin-top:1em;">

          <select id="editSkillMenu" name="editSkillMenu" size="6" class="mainSelect" onchange="showEditSkillInfoInDialog(this.value);">
          </select>

          <table class="prefsTable" style="width:100%">
            <tbody>
              <!-- remove skill -->
              <tr>
                <td style="width:2em;"><input type="radio" id="deleteSkillAction" name="editSkillAction" value="delete" checked="checked" onclick="showEditSkillInfoInDialog(this.form.editSkillMenu.value);" /></td>
                <td><label for="deleteSkillAction">remove <span id="skillType_Name_remove"></span></label></td>
              </tr>
              <!-- insert formatting -->
              <tr>
                <td><input type="radio" id="formatSkillsAction" name="editSkillAction" value="insert after" onclick="showEditSkillInfoInDialog(this.form.editSkillMenu.value);" /></td>
                <td><label for="formatSkillsAction">insert format item after <span id="skillType_Name_format"></span> row</label></td>
              </tr>
              <tr>
                <td></td>
                <td>

                  <table id="editSkillsListFormattingTable" style="display:none; width:100%;">
                    <colgroup>
                      <col style="width:2em;" />
                      <col style="width:6em;" />
                      <col />
                    </colgroup>
                    <tbody>
                      <!-- insert a spacer row -->
                      <tr id="insertSkillSpacerTR">
                        <td><input id="insertSkillsListSpacerChbox" name="insertSkillsListFormattingChbox" type="radio" value="space" checked="checked" onclick="showEditSkillInfoInDialog(this.form.editSkillMenu.value);" /></td>
                        <td colspan="2"><label for="insertSkillsListSpacerChbox">insert a spacer row</label></td>
                      </tr>
                      <!-- insert a heading -->
                      <tr id="insertSkillHeadingTR">
                        <td><input id="insertSkillsListHeadingChbox" name="insertSkillsListFormattingChbox" type="radio" value="heading" onclick="showEditSkillInfoInDialog(this.form.editSkillMenu.value);" /></td>
                        <td><label for="insertSkillsListHeadingChbox">insert heading:</label></td>
                        <td><input id="insertSkillHeadingText" style="width:98%;" /></td>
                      </tr>
                    </tbody>
                  </table>

                </td>
              </tr>
              <!-- need to be able to REMOVE formatting, too (should I leave that as a shift-click on the sheet?) -->
              <!-- edit skill -->
              <tr id="editSkillRadioTR">
                <td><input type="radio" id="editSkillAction" name="editSkillAction" value="edit" onclick="showEditSkillInfoInDialog(this.form.editSkillMenu.value);" /></td>
                <td><label for="editSkillAction">edit <span id="skillType_Name_edit"></span></label></td>
              </tr>
              <!-- skill editing options table goes in this row/cell -->
              <tr>
                <td colspan="2">

                  <table id="editSkillOptionsTable" class="prefsTable" style="width:98%; display:none;">

                    <colgroup>
                      <col />
                      <col style="width:4em;" />
                      <col />
                      <col style="width:5em;" />
                      <col />
                      <col style="width:6em;" />
                    </colgroup>

                    <tbody>

                      <!-- edit skill name text (& TL) -->
                      <tr id="editSkillNameTR">
                        <th>Name Text&emsp;</th>
                        <td colspan="3"><input id="editSkillNameText" style="width:100%;" /></td>
                        <th id="editSkillTechLevelInputLabelTD" style="display:none;">&emsp;TL&ensp;</th><!-- -->
                        <td id="editSkillTechLevelInputTD" style="display:none;"></td><!-- -->
                      </tr>

                      <!-- attribute, type, difficulty -->
                      <tr>
                        <th>Attribute&emsp;</th>
                        <td id="editSkillAttributeInputTD"></td>
                        <th>&emsp;Difficulty&ensp;</th>
                        <td id="editSkillDifficultyInputTD"></td>
                        <th id="editSkillTypeLabelCell">&emsp;Type&ensp;</th>
                        <td id="editSkillTypeInputCell">
                          <select id="editSkillType" name="editSkillType" style="width:100%;">
                            <option value="M">Mental  </option>
                            <option value="P">Physical</option>
                          </select>
                        </td>
                      </tr>

                      <!-- technique/maneuver fields -->
                      <tr id="editSkillTechManFieldsTR1" style="display:none;">
                        <th>Parent&nbsp;Skill&emsp;</th>
                        <td colspan="4"><select id="editSkillTechManDefaultSkillList"></select></td>
                        <td></td>
                      </tr>
                      <tr id="editSkillTechManFieldsTR2" style="display:none;">
                        <th>Penalty&emsp;</th>
                        <td id="editSkillTechManDefaultPenaltyInputTD">
                          <select id="editSkillTechManDefaultPenalty" style="width:50px; text-align:right;">
                          </select>
                        </td>
                        <th>&emsp;Maximum&ensp;</th>
                        <td id="editSkillTechManMaxInputTD">
                          <select id="editSkillTechManMaxIncrease" style="width:40px; text-align:right;">
                            <option value="-2">-2</option>
                            <option value="-1">-1</option>
                            <option value="0">+0</option>
                            <option value="1">+1</option>
                            <option value="2">+2</option>
                            <option value="3">+3</option>
                            <option value="4">+4</option>
                            <option value="5">+5</option>
                          </select>
                        </td>
                      </tr>

                      <!-- edit description -->
                      <tr id="editSkillDescriptionTR" ><!-- style="display:none;" -->
                        <th>
                          <input id="skillDescChbox" name="skillDescChbox" type="checkbox"
                                 onChange="var inpt=document.getElementById('editSkillDescription'); if(this.checked){inpt.style.visibility='visible';} else{inpt.style.visibility='hidden';} " />
                          <label for="skillDescChbox">Description&emsp;</label>
                        </th>
                        <td colspan="5"><input id="editSkillDescription" style="width:100%; visibility:hidden;" /></td>
                      </tr>

                      <!-- edit specialization -->
                      <tr id="editSkillSpecializationsTR1" ><!-- style="display:none;" -->
                        <th>Specialization&emsp;</th>
                        <td colspan="5"><input id="editSkillReqSpecialization" style="width:100%;" /></td>
                      </tr>
                      <tr id="editSkillSpecializationsTR2" ><!-- style="display:none;" -->
                        <td colspan="6">
                          <a><img id="editSkillOptSpecialization" src="../images/plus_blue.gif" onclick="if(document.getElementById('editSkillOptSpecializationRows').value<2) addNewCustomizerRow( 'editSkill', 'OptSpecialization' )" /></a>
                          <span style="font-size:12px;">Add, change or remove an optional specialization</span>
                          <table id="editSkillOptSpecializationsTable" style="clear:both; text-align:left;">
                            <tbody>
                            </tbody>
                          </table>
                          <input type="hidden" id="editSkillOptSpecializationRows" value="0" />
                        </td>
                      </tr>

                      <!-- edit spell fields -->
                      <tr id="editSpellFieldsRow1">
                        <th title="select all that apply">College(s)&emsp;</th>
                        <td title="select all that apply" colspan="2">
                          <select id="editSkillSpellCollegeMenu" name="editSkillSpellCollegeMenu" multiple size="5" style="">
                          </select>
                        </td>
                        <td colspan="2" rowspan="5" style="text-align:center;">
                          <table style="line-height:16px; margin-left:6px; width:100%">
                            <tr>
                              <th colspan="2" style="text-align:center;">Spell Classes&emsp;</th>
                            </tr>
                            <tr>
                              <td><input id="editSpellClassCB_reg"  name="editSpellClassCB_reg"  type="checkbox" /><label for="editSpellClassCB_reg">Regular</label></td>
                              <td><input id="editSpellClassCB_area" name="editSpellClassCB_area" type="checkbox" /><label for="editSpellClassCB_area">Area</label></td>
                            </tr>
                            <tr>
                              <td><input id="editSpellClassCB_melee" name="editSpellClassCB_melee" type="checkbox" /><label for="editSpellClassCB_melee">Melee</label></td>
                              <td><input id="editSpellClassCB_msl"   name="editSpellClassCB_msl"   type="checkbox" /><label for="editSpellClassCB_msl">Missile</label></td>
                            </tr>
                            <tr>
                              <td><input id="editSpellClassCB_block" name="editSpellClassCB_block" type="checkbox" /><label for="editSpellClassCB_block">Blocking</label></td>
                              <td><input id="editSpellClassCB_info"  name="editSpellClassCB_info"  type="checkbox" /><label for="editSpellClassCB_info">Info</label></td>
                            </tr>
                            <tr>
                              <td><input id="editSpellClassCB_ench" name="editSpellClassCB_ench" type="checkbox" /><label for="editSpellClassCB_ench">Enchant</label></td>
                              <td><input id="editSpellClassCB_spcl" name="editSpellClassCB_spcl" type="checkbox" /><label for="editSpellClassCB_spcl">Special</label></td>
                            </tr>
                            <tr>
                              <td colspan="2">
                                <input id="editSpellClassResistedCB" name="editSpellClassResistedCB" type="checkbox" /><label for="editSpellClassResistedCB">Resisted by</label>
                                <select id="editSpellResistedByMenu">
                                </select>
                              </td>
                            </tr>
                          </table>
                        </td>
                      </tr>
                      <tr id="editSpellFieldsRow2">
                        <th>Custom&nbsp;College&emsp;</th>
                        <td colspan="2"><input id="customSkillSpell_customCollege" name="customSkillSpell_customCollege" type="text" style="width:10em;" /></td>
                      </tr>
                      <tr id="editSpellFieldsRow3">
                        <th>Casting&nbsp;Cost&emsp;</th>
                        <td colspan="2"><input id="editSkillSpell_castcost" name="editSkillSpell_castcost" type="text" style="width:10em;" /></td>
                      </tr>
                      <tr id="editSpellFieldsRow4">
                        <th>Maint.&nbsp;Cost&emsp;</th>
                        <td colspan="2"><input id="editSkillSpell_maintaincost" name="editSkillSpell_maintaincost" type="text" style="width:10em;" /></td>
                      </tr>
                      <tr id="editSpellFieldsRow5">
                        <th>Time&nbsp;to&nbsp;Cast&emsp;</th>
                        <td colspan="2"><input id="editSkillSpell_time" name="editSkillSpell_time" type="text" placeholder="1" style="width:10em;" /></td>
                      </tr>
                      <tr id="editSpellFieldsRow6">
                        <th>Duration&emsp;</th>
                        <td colspan="2"><input id="editSkillSpell_duration" name="editSkillSpell_duration" type="text" style="width:10em;" /></td>
                      </tr>
                      <tr id="editSpellFieldsRow7">
                        <th>Notes&emsp;</th>
                        <td colspan="5"><textarea id="editSkillSpell_notes" name="editSkillSpell_notes" style="width:100%;"></textarea></td>
                      </tr>


                      <!-- edit prerequisites -->
                      <tr id="editSkillPrerequisitesTR" ><!-- style="display:none;" -->
                        <th>Prerequisites&emsp;</th>
                        <td colspan="5">
                          <div id="skillPrereqsList" style="line-height:normal;"></div>
                        </td>
                      </tr>


                      <!-- change (i.e., specify) skill from which this one calculates its default (not yet implemented) -->
                      <tr id="editSkillDefaultsTR" ><!-- style="display:none;" -->
                        <th title="only defaults from skills character actually has are shown">Defaults From&emsp;</th>
                        <td colspan="5">
                          <!--<input id="editSkillDefaults" style="visibility:hidden;" />-->
                          <div id="skillDefaultsList" style="line-height:normal;"></div>
                        </td>
                      </tr>


                      <!-- other things I might want to edit: points, attribute, TL -->

                      <!--  Do I want to roll in the technique properties here?  techniqueDefaultPenalty, maxRelLevel, etc.?
                            Yes, I do.
                            already there: attribute, difficulty, type, specialization, description, prereq
                            need to add: techniqueDefaultPenalty, maxRelLevel -->

                    </tbody>

                  </table>

                </td>
              </tr>
            </tbody>
          </table>

        </div>

        <div style="clear: both;"></div>

        <button type="button" style="float:left; width: auto;" onclick="document.getElementById('editSkillDialog').style.display='none'; return false;">Close</button>
        <button id="editSkillSubmit" type="button" disabled="disabled" style="float:right; width: auto;" onclick="editSkill(this.form.editSkillMenu.value);">edit a skill</button>

      </form>

    </div>

    <!-- Edit Languages calls the same dialog as Build -> Languages (below) -->

    <div id="editEquipmentDialog" class="dialog" style="max-width:500px;">

      <form method="post" id="editEquipmentForm" name="editEquipmentForm">

        <div class="titlebar">Edit Equipment</div>

        <div class="dialogBody" style="margin-top:1em;">

          <div>
            <select id="editEquipmentMenu" size="6" style="width: 100%;" onchange="showEditEquipmentInfoInDialog(this.value.split('_'))">

            </select>
          </div>

          <div id="displayEquipmentRefund" class="noticeBox" style="text-align:right;">&nbsp;</div>

          <div style="text-align:left;">
            <input type="radio" id="deleteEquipmentAction" name="editEquipmentAction" value="remove" checked="checked" style="width:auto;" onclick="document.getElementById('editEquipmentFormTables').style.display='none'; document.getElementById('editEquipmentVerb').innerHTML=this.value" /> <!-- Need to have this click update submit button text (at least), but NOT update the text fields. -->
            <label for="deleteEquipmentAction">remove <span id="equipType_Name_remove"></span></label>
            &emsp;
            <input type="radio" id="editEquipmentAction" name="editEquipmentAction" value="edit" style="width:auto;"  onclick="document.getElementById('editEquipmentFormTables').style.display='block'; document.getElementById('editEquipmentVerb').innerHTML=this.value"/>
            <label for="editEquipmentAction">edit <span id="equipType_Name_edit"></span></label>
          </div>

          <div id="editEquipmentFormTables" style="">

            <table id="editEquipmentTable" class="prefsTable" style="width:100%;">
              <colgroup>
                <col style="width:8em;" />
                <col />
                <col style="width:6em;" />
                <col style="width:6em;" />
              </colgroup>
              <tbody>
                <tr id="editEquipmentNameTR">
                  <!-- edit equipment name text -->
                  <th>Name&emsp;</th>
                  <td><input id="editEquipmentNameText" style="width:98%;" onkeyup="this.form.editEquipmentSubmit.value='edit '+this.value" /></td>
                  <th>Number&emsp;</th>
                  <td><input id="editEquipmentNumber" style="width:90%" /></td>
                </tr>
                <tr id="editEquipmentDescriptionTR">
                  <!-- edit equipment description text -->
                  <th>Description&emsp;</th>
                  <td colspan="3"><input id="editEquipmentDescriptionText" style="width:98%;" /></td>
                </tr>
                <tr id="editEquipmentWeightTR">
                  <!-- change cost -->
                  <th>Cost&ensp;$</th>
                  <td>
                    <input id="editEquipmentCost" style="width:4em;" onkeyup="showCostChange()" 
                           title="Put 'normal' cost (unmodified for quality) here." />
                    &plus;
                    <b>$</b><input id="editEquipmentAddedCost" name="editEquipmentAddedCost" style="width:4em;" 
                                   title="Modify cost (upward for decoration, reputation, magic, etc., or downward for wear, curses, etc.) here." />
                  </td>
                  <!-- change weight (do I want this to be editable?) -->
                  <th>Weight&emsp;</th>
                  <td><input id="editEquipmentWeight" style="width:4em;" /> <span id="editEquipmentWeightUnit">lbs</span></td>
                </tr>
                <!-- edit number -->
                <tr id="editEquipmentNumberTR">
                </tr>
                <tr>
                  <th style="text-align:right;" title="Tech Level (see 3rd ed., page 185 or 4th ed., page B22)">Tech&nbsp;Level&emsp;</th>
                  <td>
                    <select id="editEquipmentItemTL" name="editEquipmentItemTL" style="width:12em;" title="Tech Level (see 3rd ed., page 185 or 4th ed., page B22)">
                    </select>
                  </td>
                  <th style="text-align:right;" title="Legality Class (see 4th ed., page B267)">Legality&emsp;</th>
                  <td>
                    <select id="editEquipmentItemLC" name="editEquipmentItemLC" style="width:100%;" title="Legality Class (see 4th ed., page B267)">
                    </select>
                  </td>
                </tr>
              </tbody>
            </table>

            <table id="editWeaponTable" class="prefsTable">
              <colgroup>
                <col style="width:10em;" />
                <col style="width:12em;" />
                <col style="width:8em;" />
                <col />
              </colgroup>
              <tbody style="width:100%;">
                <tr>
                  <th style="text-align:right;" title="see Weapon Quality (3rd ed., page 74 sidebar; 4th ed., page B274, B277, B280)">Quality Group&emsp;</th>
                  <td>
                    <select id="editWeaponItemQualGp" name="editWeaponItemQualGp" style="width:12em;" title="see Weapon Quality (3rd ed., page 74 sidebar; 4th ed., page B274, B277, B280)">
                    </select>
                  </td>
                  <!-- change weapon/equipment quality level -->
                  <th id="editEquipmentQualityLabelTD" style="text-align:right;">Quality&emsp;</th>
                  <td id="editEquipmentQualityTD"><select id="editEquipmentQualityLevel"></select></td>
                </tr>
              <!--
                <tr>
                  <th style="text-align:right;" title="Bulk; measures weapon size and 'handiness' (4th ed., page B270)">Bulk&emsp;</th>
                  <td>
                    <select id="editWeaponItemBulk" name="editWeaponItemBulk" style="width:auto;" title="Bulk; measures weapon size and 'handiness' (4th ed., page B270)">
                    </select>
                  </td>
                  <th style="text-align:right;" title="see 3rd ed., page 208; 4th ed., page B270)">Shots&emsp;</th>
                  <td><input id="editWeaponItemShots" name="editWeaponItemShots" style="width:4em;" /></td>
                </tr>
              -->
                <tr><!-- This row only applies to ranged weapons (although I have defined 'bulk' for a number of melee weapons). -->
                  <th style="text-align:right;" title="Weapon Strength; Bows, etc. have their own ST used to determine damage (3rd ed., page B114; 4th ed., page B270)">Weapon ST&emsp;</th>
                  <td colspan="2">
                    <div style="float:left; font-weight:bold; width:6em;" title="Weapon Strength; Bows, etc. have their own ST used to determine damage (3rd ed., page B114; 4th ed., page B270)">
                      <select id="editWeaponItemST" name="editWeaponItemST" style="width:auto;">
                      </select>
                    </div>
                    <div style="float:left; font-weight:bold; text-align:right;" title="Bulk; measures weapon size and 'handiness' (4th ed., page B270)">
                      Bulk&emsp;
                      <select id="editWeaponItemBulk" name="editWeaponItemBulk" style="width:auto;">
                      </select>
                    </div>
                    <div style="float:right; font-weight:bold; text-align:right;" title="see 3rd ed., page 208; 4th ed., page B270)">
                      Shots&emsp;
                    </div>
                  </td>
                  <td><input id="editWeaponItemShots" name="editWeaponItemShots" style="width:4em;" /></td>
                </tr>
                <!-- weaponST, shots inputs? -->
                <tr>
                  <td colspan="4">
                    <fieldset style="font-size:8pt;">
                      <legend>Attack Options</legend>
                      <button onclick="addNewAttackOptionRow(this.form.editWeaponItemAttackOptionSkillsMenu.value,1*this.form.attackOptionRows.value+1,null,this.form.editWeaponItemAttackOptionAttackTypeMenu.value,'edit'); return false;">Add</button>new
                      <select id="editWeaponItemAttackOptionAttackTypeMenu"><option value="melee">melee</option><option value="ranged">ranged</option></select>
                      attack option using
                      <select id="editWeaponItemAttackOptionSkillsMenu" name="editWeaponItemAttackOptionSkillsMenu" style="width:12em;"
                              title="Select an attack skill; an 'attack option' form row will appear.">
                      </select>
                      skill
                      <table id="editWeaponAttackOptionsTable" style="width:450px; padding-bottom:1em; display:none; overflow:auto;">
                      </table>
                      <input type="hidden" id="editWeaponAttackOptionRows" name="attackOptionRows" value="0" />
                    </fieldset>
                  </td>
                </tr>
              </tbody>
            </table>

            <table id="editShieldFormTable" class="prefsTable">
              <colgroup>
                <col style="width:10em;" />
                <col style="width:3em;" />
                <col style="width:9em;" />
                <col />
                <col style="width:3em;" />
                <col style="width:1em;" />
                <col style="width:3em;" />
              </colgroup>
              <tbody>
                <tr style="line-height:5px; height:16px; ">
                  <td></td>
                  <th id="editShieldPDB" style="text-align:center; vertical-align:bottom;">PD</th>
                  <td></td>
                  <td></td>
                  <th style="text-align:center; vertical-align:bottom;" title="The shield's Damage Resistance and Hit Points if using the optional Damage to Shields rule (B120 or Campaigns 484). This DR protects the shield, not the wielder.">DR</th>
                  <th style="text-align:center; vertical-align:bottom;">/</th>
                  <th style="text-align:center; vertical-align:bottom;" title="The shield's Damage Resistance and Hit Points if using the optional Damage to Shields rule (B120 or Campaigns 484). This DR protects the shield, not the wielder.">HP</th>
                </tr>
                <tr>
                  <th id="editShieldPDBlabel" style="text-align:right;">&nbsp;Protection&emsp;</th>
                  <td ><input id="editShieldDialogPDB" name="editShieldDialogPDB" style="text-align:center;width:3em;" /></td>
                  <th colspan="2" style="text-align:right;" title="The shield's Damage Resistance and Hit Points if using the optional Damage to Shields rule (B120 or Campaigns 484). This DR protects the shield, not the wielder.">Shield&nbsp;Damage&emsp;</th>
                  <td title="The shield's Damage Resistance and Hit Points if using the optional Damage to Shields rule (B120 or Campaigns 484). This DR protects the shield, not the wielder.">
                    <input id="editShieldDialogDR" name="editShieldDialogDR" style="text-align:center;width:3em;" />
                  </td>
                  <td style="text-align:center;">/</td>
                  <td title="The shield's Damage Resistance and Hit Points if using the optional Damage to Shields rule (B120 or Campaigns 484). This DR protects the shield, not the wielder.">
                    <input id="editShieldDialogHP" name="editShieldDialogHP" style="text-align:center;width:3em;" />
                  </td>
                </tr>
                <tr>
                  <th style="text-align:right;">Skill&emsp;</th>
                  <td colspan="2">
                    <select id="editShieldDialogSkill" name="editShieldDialogSkill" style="width:12em;" >
                    </select>
                  </td>
                </tr>
                <tr>
                  <th style="text-align:right;">Made&nbsp;of&emsp;</th>
                  <td colspan="2">
                    <select id="editShieldComposition" style="width:6em;" onchange="alert('Other stats (weight, cost, etc.) will not automatically update when shield composition is changed.  Be sure to make any necessary edits.')">
                      <option value="wood" selected="selected">wood</option>
                      <option value="metal" title="bronze (TL 2+) or iron (TL 3+)">metal</option>
                      <option value="plastic" title="Lexan, etc. (TL 7+)">plastic</option>
                    </select>
                  </td>
                  <th id="editShieldBucklerChoiceCell"> <!-- toggle display by ruleset -->
                    <input id="editShieldBuckler" type="checkbox" style="width:1em;" onclick="this.form.editShieldDialogSkill.value=(this.checked)?'Shield_Buckler':'Shield_Shield'" />
                    <label for="editShieldBuckler">Buckler</label>
                  </th>
                </tr>
              </tbody>
            </table>

            <table id="editArmorTable" class="prefsTable" style="width:auto;">
            <colgroup>
              <col style="width:2em;" />
              <col style="width:8em;" />
              <col style="width:3em;" />
              <col style="width:4em;" />
              <col />
              <col />
            </colgroup>
            <tbody>
            <!--
              <tr style="line-height:7px; height:16px; "><th></th><th></th><th style="vertical-align:bottom;">DR</th><th style="vertical-align:bottom;">PD</th><th colspan="2" style="vertical-align:bottom;">split&nbsp;DR split&nbsp;PD</th></tr>
              <tr>
                <th style="text-align:right;" colspan="2">Protection&emsp;</th>
                <th><input id="editArmorDialogDR" name="editArmorDialogDR" style="text-align:center;width:3em;" /></th>
                <th><input id="editArmorDialogPD" name="editArmorDialogPD" style="text-align:center;width:3em;" /></th>
                <th colspan="2">
                  <input id="editArmorDialogsplitDR" name="editArmorDialogsplitDR" style="text-align:center;width:3em;" />
                  <input id="editArmorDialogsplitPD" name="editArmorDialogsplitPD" style="text-align:center;width:3em;" />
                </th>
              </tr>
            -->
              <tr id="editArmorDialogPDrow">
                <th style="text-align:right;" colspan="2">Passive&nbsp;Defense&emsp;</th>
                <th>
                    <input id="editArmorDialogPD" name="editArmorDialogPD" style="text-align:center; width:3em;" />
                </th>
                <th id="editArmorDialogsplitPDcell" style="text-align:left; display:none;" title="Split PD">
                  / <input id="editArmorDialogsplitPD" name="editArmorDialogsplitPD" style="text-align:center; width:3em;" />
                </th>
              </tr>
              <tr>
                <th style="text-align:right;" colspan="2">Damage&nbsp;Resistance&emsp;</th>
                <th>
                    <input id="editArmorDialogDR" name="editArmorDialogDR" style="text-align:center;width:3em;" />
                </th>
                <th id="editArmorDialogsplitDRcell" style="text-align:left; display:none;" title="Split DR">
                  / <input id="editArmorDialogsplitDR" name="editArmorDialogsplitDR" style="text-align:center;width:3em;" />
                </th>
              </tr>
              <tr>
                <th style="text-align:right;" colspan="2">Layering&emsp;</th>
                <td colspan="4">
                  <input id="editArmorDialoglayerableCB" name="editArmorDialoglayerableCB" value="layerable" type="checkbox" />
                  can wear under clothing / armor
                </td>
              </tr>
              <tr><th style="text-align:right;" colspan="2">Coverage&emsp;</th></tr>
              <tr>
                <td></td>
                <td></td>
                <td style="text-align:right;">skull</td>
                <td style="text-align:left;">
                  <input id="editArmorDialogskullCB" name="editArmorDialogskullCB" value="skull" type="checkbox" />
                </td>
                <td style="text-align:right;">
                  <input id="editArmorDialogsuitCB" name="editArmorDialogsuitCB" value="suit" type="checkbox"
                          onchange="/* toggle all the 'body' checkboxes */" />
                </td>
                <td style="text-align:left;">full suit</td>
              </tr>
              <tr>
                <td></td>
                <td></td>
                <td style="text-align:right;">eyes</td>
                <td style="text-align:left;">
                  <input id="editArmorDialogeyesCB" name="editArmorDialogeyesCB" value="eyes" type="checkbox" />
                </td>
                <td></td>
                <td></td>
              </tr>
              <tr>
                <td></td>
                <td></td>
                <td style="text-align:right;">face</td>
                <td style="text-align:left;">
                  <input id="editArmorDialogfaceCB" name="editArmorDialogfaceCB" value="face" type="checkbox" />
                </td>
                <td></td>
                <td></td>
              </tr>
              <tr>
                <td></td>
                <td></td>
                <td style="text-align:right;">neck</td>
                <td style="text-align:left;">
                  <input id="editArmorDialogneckCB" name="editArmorDialogneckCB" value="neck" type="checkbox" />
                </td>
                <td></td>
                <td></td>
              </tr>
              <tr>
                <!--<td style="text-align:right;">dom arm</td>-->
                <td colspan="2" style="text-align:right;">
                  dom arm
                  <input id="editArmorDialogdomArmCB" name="editArmorDialogdomArmCB" value="domArm" type="checkbox" />
                </td>
                <td style="text-align:right;">torso</td>
                <td style="text-align:left;">
                  <input id="editArmorDialogtorsoCB" name="editArmorDialogtorsoCB" value="torso" type="checkbox" />
                </td>
                <td style="text-align:right;">
                  <input id="editArmorDialogoffArmCB" name="editArmorDialogoffArmCB" value="offArm" type="checkbox" />
                </td>
                <td style="text-align:left;">off arm</td>
              </tr>
              <tr>
                <!--<td style="text-align:right;">dom hand</td>-->
                <td colspan="2" style="text-align:right;">
                  dom hand
                  <input id="editArmorDialogdomHandCB" name="editArmorDialogdomHandCB" value="domHand" type="checkbox" />
                </td>
                <td style="text-align:right;">waist</td>
                <td style="text-align:left;">
                  <input id="editArmorDialogwaistCB" name="editArmorDialogwaistCB" value="waist" type="checkbox" />
                </td>
                <td style="text-align:right;">
                  <input id="editArmorDialogoffHandCB" name="editArmorDialogoffHandCB" value="offHand" type="checkbox" />
                </td>
                <td style="text-align:left;">off hand</td>
              </tr>
              <tr>
                <td></td>
                <td></td>
                <td style="text-align:right;">groin</td>
                <td style="text-align:left;">
                  <input id="editArmorDialoggroinCB" name="editArmorDialoggroinCB" value="groin" type="checkbox" />
                </td>
                <td></td>
                <td></td>
              </tr>
              <tr>
                <td></td>
                <td style="text-align:right;">dom leg</td>
                <td style="text-align:left;">
                  <input id="editArmorDialogdomLegCB" name="editArmorDialogdomLegCB" value="domLeg" type="checkbox" />
                </td>
                <td style="text-align:right;">
                  <input id="editArmorDialogoffLegCB" name="editArmorDialogoffLegCB" value="offLeg" type="checkbox" />
                </td>
                <td colspan="2" style="text-align:left;">off leg</td>
              </tr>
              <tr>
                <td></td>
                <td style="text-align:right;">dom foot</td>
                <td style="text-align:left;">
                  <input id="editArmorDialogdomFootCB" name="editArmorDialogdomFootCB" value="domFoot" type="checkbox" />
                </td>
                <td style="text-align:right;">
                  <input id="editArmorDialogoffFootCB" name="editArmorDialogoffFootCB" value="offFoot" type="checkbox" />
                </td>
                <td colspan="2" style="text-align:left;">off foot</td>
              </tr>
            </tbody>
          </table>

          </div>

        </div>

        <div style="clear: both;"></div>

        <input type="hidden" id="editEquipmentName" name="editEquipmentName" value="" />
        <button type="button" style="float:left; width: auto;" onclick="document.getElementById('editEquipmentDialog').style.display='none'; return false;">Close</button>
        <button id="editEquipmentSubmit" type="button" disabled="disabled" style="float:right; width: auto;" onclick="editEquipment();">
          <!-- the contents of these spans will always be replaced -->
          <span id="editEquipmentVerb">edit</span>
          <span id="editEquipmentShortName">this equipment</span>
          item
        </button>

      </form>

    </div>

    <div id="editLinkersDialog" class="dialog" style="width:400px">
      <form method="post" name="editLinkersForm">
        <div class="titlebar">Edit Linkers</div>

        <div class="dialogBody" style="margin-top:1em">
          <style>
          .dialog .linkersTableContainer {
            overflow: hidden;
            overflow-y: auto;
            height: 200px;
            margin-bottom: 1em;
          }
          #editLinkersTable tbody tr:hover {
            background-color: yellow;
          }
          #editLinkersTable thead tr {
            width: 100%;
            background-color: #eee;
            border-bottom: 2px solid grey;
          }
          /*button { margin:0 }*/
          </style>

          <span>Showing:</span>
          <select id="editLinkersSelect" onchange="editLinkersDialog(this.value)" style="margin-bottom:1em;">
            <option value="defaults">Defaults</option>
            <option value="prerequisites" >Prerequisites</option>
            <option value="adjustments" >Adjustments</option>
            <option value="groups" >Groups</option>
          </select>

          <div class="linkersTableContainer">
            <table class="prefsTable linkersTable" id="editLinkersTable" style="width:100%; table-layout:fixed">
              <thead id="editLinkersThead">
              </thead>
              <tbody id="editLinkersTbody">
              </tbody>
            </table>
          </div>

          <div class="fieldsetWrapper" style="width:100%;">

            <fieldset>

              <legend onclick="toggleFieldset2(document.getElementById('editLinkersToggleButton'),'editLinkersHelp')">
                <img id="editLinkersToggleButton" src="../images/plus_blue.gif" />
                Help
              </legend>

              <div id="editLinkersHelp" style="display:none">

                <p style="text-align:left">
                  These are attached to your character because they <i>could</i> apply at some point
                  (because your character has the Trait/Skill <i>etc.</i> from which they derive,
                  or has the Trait/Skill <i>etc.</i> to which it applies),
                  not because they necessarily apply currently.
                  <span class="ready">Highlighted items</span> are in use now.
                </p>
                <p style="text-align:left">
                  Use this form to edit linker items, with caution of course.
                  You can also this form to remove items that were added because of
                  Traits/Skills <i>etc.</i> your character once had,
                  but that have now been removed from this character,
                  so the item will no longer ever be 'activated'.
                </p>
                <p style="text-align:left">
                  You can remove items you feel will never be used (to make the Character file smaller),
                  but if they are here because of a Trait/Skill <i>etc.</i> that your character still has,
                  they will be put back each time you re-load the library where they were found.
                </p>
                <p style="text-align:left">
                  Usually Groups that your character isn't using can be removed safely.
                  If you later add a Skill that is part of such a Group,
                  you will have to load the library with that Skill first,
                  which will re-attach the Group anyway.
                </p>

              </div>

            </fieldset>

          </div>

        </div>

        <div style="text-align:center;">
          <input type="submit" value="Close" style="width: auto; margin: 1em;" onClick="document.getElementById('editLinkersDialog').style.display='none'; return false;" />
        </div>

      </form>
    </div>
    <div id="editLinkerDialog" class="dialog" style="width:360px">
      <style>
       /* #editLinkerTable input { width: 100%; } */
        #editLinkerTable td { text-align: center; }
      </style>
      <form method="post" name="editLinkerForm">
        <div class="titlebar">Edit <span id="linkerType">Linker</span></div>

        <div class="dialogBody" style="margin-top:1em">

          <div style="max-height:400px; overflow-y:auto;">

            <table class="prefsTable" id="editLinkerTable">
              <colgroup>
                <col />
                <col />
                <col style="width:2em" />
              </colgroup>
              <tfoot>
                <tr title="add a new attribute to this linker" style="border-top: 2px solid grey">
                  <th style="text-align:right"><input placeholder="property" id="editLinker_newPropertyKey" name="editLinker_newPropertyKey" style="width:8em;text-align:right;font-weight:bold" />&ensp;</th>
                  <td><input placeholder="value" id="editLinker_newPropertyValue" name="editLinker_newPropertyValue" style="width:100%" /></td>
                  <td style="cursor:pointer;" onclick="addLinkerAttribute();"><img src="../images/plus_blue.gif" /></td>
                </tr>
              </tfoot>
              <tbody id="editLinkerTbody">
              </tbody>
            </table>

          </div>

          <div class="fieldsetWrapper">

            <fieldset style="">

              <legend onclick="toggleFieldset2(document.getElementById('editLinkerToggleButton'),'editLinkerHelp')">
                <img id="editLinkerToggleButton" src="../images/plus_blue.gif" />
                Help
              </legend>

              <div id="editLinkerHelp" style="display:none; ">

                <p style="text-align:left;">
                  Don't try to edit the values above unless you are quite familiar with these objects.
                  Na&iuml;ve editing can easily break things.
                </p>

              </div>

            </fieldset>

          </div>

        </div>

        <input type="hidden" id="editLinker_linker" name="editLinker_linker" />
        <input type="hidden" id="editLinker_key"    name="editLinker_key"    />

        <div style="text-align:center;">
          <button style="width: auto; margin: 1em; float: left;" id="deleteLinkerButton" onClick="deleteLinker(this.form.editLinker_linker.value,this.form.editLinker_key.value); return false;">Delete</button>
          <button style="width: auto; margin: 1em;"                                      onClick="document.getElementById('editLinkerDialog').style.display='none'; return false;">Close</button>
          <button style="width: auto; margin: 1em; float: right;" id="editLinkerButton"  onClick="editLinker(this.form.editLinker_linker.value,this.form.editLinker_key.value); return false;">Save Changes</button>
        </div>

      </form>
    </div>

    <!-- - - - - - -->

    <div id="editCharacterInfoDialog" class="dialog" style="top:20em;">
      <form method="post" name="modifyCharacterInfoForm">
        <div class="titlebar">Modify Character Information</div>

        <div class="dialogBody" style="margin-top:1em;">

          <span id="editCharacterShowCreateDate" class="fill-in"></span>
          <table class="prefsTable" style="margin-bottom:1em;">
            <tbody>
              <tr>
                <th>Name&emsp;</th>
                <td colspan="5">
                  <input id="editCharacterName" type="text" style="width:25em;"
                         onkeyup="var ch=document.loadedCharacter; ch.description.name=this.value; loadCharacter(ch)"/>
                </td>
              </tr>
              <tr>
                <th>Height&emsp;</th>
                <td>
                  <input id="editCharacterHeight" type="text" style="width:3em;"
                         onkeyup="var ch=document.loadedCharacter; ch.height(this.value); loadCharacter(ch)"/>
                  in
                </td>
                <th>Weight&emsp;</th>
                <td>
                  <input id="editCharacterWeight" type="text" style="width:3em;"
                         title="'Base' weight; will be modified for Build traits"
                         onkeyup="var ch=document.loadedCharacter; ch.weight(this.value); loadCharacter(ch)"/>
                  <span id="editCharacterWeightUnit">lbs</span>
                </td>
                <th>Age&emsp;</th>
                <td>
                  <input id="editCharacterAge" type="text" style="width:3em;"
                         onkeyup="var ch=document.loadedCharacter; ch.description.age=this.value; loadCharacter(ch)"/>
                  yrs
                </td>
              </tr>
              <tr>
                <th>Gender&emsp;</th>
                <td colspan="3">
                  male  <input name="editCharacterGender" id="editCharacterGenderMale"   value="male"   type="radio" checked="checked"
                         onchange="var ch=document.loadedCharacter; ch.gender('male'); loadCharacter(ch)"/>
                  &emsp;
                  female<input name="editCharacterGender" id="editCharacterGenderFemale" value="female" type="radio"
                         onchange="var ch=document.loadedCharacter; ch.gender('female'); loadCharacter(ch)" />
                </td>
              </tr>
            </tbody>
          </table>

        </div>

        <div style="text-align:center;">
          <input type="submit" value="Close" style="width: auto; margin: 1em;" onClick="document.getElementById('editCharacterInfoDialog').style.display='none'; return false;" />
        </div>

      </form>
    </div>

    <div id="editGameInfoDialog" class="dialog">
      <form method="post" name="modifyGameInfoForm">
        <div class="titlebar">Modify Game Settings</div>

        <div class="dialogBody" style="margin-top:1em;">

          <table class="prefsTable" style="margin-bottom:1em;">
            <tbody>
              <tr>
                <th>Ruleset&emsp;</th>
                <td>
                  <select id="gameInfoRuleset" name="gameInfoRuleset"></select>
                </td>
              </tr>
              <tr>
                <th>Tech Level&emsp;</th>
                <td>
                  <select id="gameInfoTL" name="gameInfoTL">
                  </select>
                </td>
              </tr>
              <tr>
                <th>Disad points limit&emsp;</th>
                <td>
                  <input id="disadPointsLimit" name="disadPointsLimit" style="width: 4em;" />
                </td>
              </tr>
              <tr>
                <th>Quirks points limit&emsp;</th>
                <td>
                  <input id="quirkPointsLimit" name="quirkPointsLimit" style="width: 4em;" />
                </td>
              </tr>
            </tbody>
          </table>

        </div>

        <input type="submit" value="Close"         style="float:  left; width: auto; margin: 1em;" onClick="document.getElementById('editGameInfoDialog').style.display='none'; return false;" />
        <input type="button" value="Save Settings" style="float:right; width: auto; margin: 1em;" onClick="modifyGameInfo(this.form)" />
      <!-- modifyGameInfo(document.getElementById('gameInfoRuleset').value,document.getElementById('gameInfoTL').value,document.getElementById('disadPointsLimit').value,document.getElementById('quirkPointsLimit').value); -->
      </form>
    </div>

    <!-- - - - - - -->

    <div id="editPrefsDialog" class="dialog">

      <form id="editPrefsForm" name="editPrefsForm" method="post">

        <div class="titlebar">Preferences</div>

        <div class="dialogBody" style="margin-top:1em;">

          <table class="prefsTable" style="width:100%; line-height:24px;">
            <colgroup>
              <col />
              <col />
              <col />
              <col />
            </colgroup>
            <tbody>
              <tr>
                <th>Color Theme&emsp;</th>
                <td colspan="3">
                  <select id="selectThemePref" name="selectThemePref" onchange="savePrefs()">
                    <option value="" selected="selected">Gray</option>
                    <option value="blue">Blue</option>
                    <option value="green">Green</option>
                    <option value="brown">Brown</option>
                    <option value="purple">Purple</option>
                    <option value="blood">Blood</option>
                    <option value="orange">Apricot</option>
                    <option value="metal">Metal</option>
                  </select>
                </td>
              </tr>
              <tr title="Use character art file as a 'watermark' background image">
                <th>Watermark&emsp;</th>
                <td colspan="3">
                  <select id="watermarkPref" name="watermarkPref" onchange="savePrefs()">
                    <option value="null">no watermark</option>
                    <option value="1">watermark first page</option>
                    <option value="2">watermark pages after first</option>
                    <option value="all">watermark all pages</option>
                  </select>
                </td>
              </tr>
              <tr title="Display spells in a Grimoire page&#13;(Magic; 1989 ed. pg 112 or 4th ed. pg 240)">
                <th>Show Grimoire&emsp;</th>
                <td>
                  <input id="showGrimoire" type="checkbox" onchange="savePrefs()" />
                </td>
              </tr>
              <tr title="Display Tech Level information on sheet; particularly skills">
                <th>Show Tech Level info&emsp;</th>
                <td>
                  <input id="showTLinfo" type="checkbox" onchange="savePrefs()" />
                </td>
              </tr>
              <tr title="Show non-integer values equivalent to common fractions (e.g. ½, ¾) as fractions">
                <th>Use fractions&emsp;</th>
                <td>
                  <input id="useFractions" type="checkbox" onchange="savePrefs()" />
                </td>
              </tr>
              <tr id="AdjustTraitRows" title="In a 'partitioned' traits table, trade off Ad/Perk and Disad/Quirk rows to best accommodate character traits">
                <th>Adjust Trait Rows&emsp;</th>
                <td>
                  <input id="AdjustTraitRowsPref" type="checkbox" name="AdjustTraitRowsPref" onchange="savePrefs()" />
                </td>
              </tr>
              <tr>
                <th>Units System&emsp;</th>
                <td colspan="3">
                  <select id="unitSystemPref" name="unitSystemPref" onchange="savePrefs()">
                    <option value="English" selected="selected">inches &amp; pounds (English)</option>
                    <option value="MKS">meters &amp; kilos</option>
                    <option value="CGS">centimeters &amp; grams</option>
                  </select>
                </td>
              </tr>
              <tr title="Tells JCSP to re-calculate height and weight whenever ST is changed&#13; or a 'build' trait (Overweight, Skinny, etc.) is added or removed.">
                <th>Auto-adjust Build&emsp;</th>
                <td>
                  <input id="autoAdjustBuildPref" type="checkbox" name="autoAdjustBuildPref" onchange="savePrefs()" />
                </td>
              </tr>
              <tr title="Display a page listing all belongings and property">
                <th>Show All Property Page&emsp;</th>
                <td>
                  <input id="showAllProperty" type="checkbox" onchange="savePrefs()" />
                </td>
              </tr>
            </tbody>
          </table>

          <div class="fieldsetWrapper">
            <fieldset>
              <legend title="Handling of excess rows for long item lists"><b><i>List Overflow</i></b></legend>
              <table class="prefsTable" style="width:100%; line-height:16px; margin-top: -0.5em;">
                <colgroup>
                  <col style="width:80px;" />
                  <col />
                  <col />
                  <col style="width:50px;" class="zrow" />
              <!--<col />-->
                </colgroup>
                <tbody>
                  <tr class="ready centered-cells-row" style="line-height:12px; height:30px;">
                    <td>&nbsp;</td>
                    <td title="Display excess items by enabling table scrolling for this item type">scrollbar</td>
                    <td title="Display excess items in a type-specific supplemental page">supplemental<br />page</td>
                    <td title="Display all excess items in a single combined supplemental page">combo<br />page</td>
                <!--<td title="Start supplemental page list at the beginning?&#13;(Otherwise, page shows ONLY excess items.)">entire<br />list?</td>-->
                  </tr>
                  <tr class="centered-cells-row">
                    <th>Traits&emsp;</th>
                    <td title="Enable scrolling of the traits list">
                      <input id="traitsScrollPref" name="traitsScrollPref" type="checkbox" onchange="savePrefs()" />
                    </td>
                    <td title="Display excess traits in a 'Supplemental Traits' page">
                      <input id="traitsSuppPagePref" name="traitsSuppPagePref" type="checkbox" onchange="savePrefs()" />
                    </td>
                    <td title="Display all excess items in a single combined supplemental page">&emsp;</td>
                <!--<td title="Start supplemental page traits list at the beginning?&#13;(Otherwise, page shows ONLY excess traits.)">
                      <input id="traitsSuppPageStartPref" name="traitsSuppPageStartPref" type="checkbox" onchange="savePrefs()" />
                    </td>-->
                  </tr>
                  <tr class="centered-cells-row">
                    <th>Skills&emsp;</th>
                    <td title="Enable scrolling of the skills list">
                      <input id="skillsScrollPref" name="skillsScrollPref" type="checkbox" onchange="savePrefs()" />
                    </td>
                    <td title="Display excess skills in a 'Supplemental Skills' page">
                      <input id="skillsSuppPagePref" name="skillsSuppPagePref" type="checkbox" onchange="savePrefs()" />
                    </td>
                    <td title="Display all excess items in a single combined supplemental page">
                      <input id="comboSuppPagePref" name="comboSuppPagePref" type="checkbox" onchange="savePrefs()" />
                    </td>
                <!--<td title="Start supplemental page skills list at the beginning?&#13;(Otherwise, page shows ONLY excess skills.)">
                      <input id="skillsSuppPageStartPref" name="skillsSuppPageStartPref" type="checkbox" onchange="savePrefs()" />
                    </td>-->
                  </tr>
                  <tr class="centered-cells-row">
                    <th>Belongings&emsp;</th>
                    <td title="Enable scrolling of equipment lists">
                      <input id="stuffScrollPref" name="stuffScrollPref" type="checkbox" onchange="savePrefs()" />
                    </td>
                    <td title="Display excess equipment in a supplemental equipment page">
                      <input id="stuffSuppPagePref" name="stuffSuppPagePref" type="checkbox" onchange="savePrefs()" />
                    </td>
                    <td title="Display all excess items in a single combined supplemental page">&emsp;</td>
                <!--<td title="Start supplemental page equipment list at the beginning?&#13;(Otherwise, page shows ONLY excess equipment.)">
                      <input id="stuffSuppPageStartPref" name="stuffSuppPageStartPref" type="checkbox" onchange="savePrefs()" />
                    </td>-->
                  </tr>
                </tbody>
              </table>

            </fieldset>
          </div>

          <input value="Close"            style="float:left;  width: auto; margin: 1em;" onclick="document.getElementById('editPrefsDialog').style.display='none'; return false;" type="submit" />

        </div><!-- .dialogBody -->

      </form>

    </div>


  <!-- Build menu -->
    <div id="selectTraitDialog" class="dialog">
  
      <form method="post" id="selectTraitsForm" name="selectTraitsForm">

        <div class="titlebar">Select <span style="color:darkgreen;">Advantage</span> / <span style="color:darkred;">Disadvantage</span></div>

        <div class="dialogBody">

          <div id="selectTraitSortWrapper" class="dialogSortWrapper">
            Sort&nbsp;by:
            <select id="selectTraitSort" onchange="selectTraitsDialog(this.value)">
              <option value="name">name</option>
              <option value="cost">cost</option>
              <option value="physMntlScl">type</option>
              <option value="group">exclusion group</option>
              <option value="exoticSprntl">exotic/supernatural</option>
            </select>
          </div>
          <div id="TraitTakenNote" class="noticeBox" style="width:70%; "></div>

          <select id="selectTraitMenu" size="7" class="mainSelect" onchange="showTraitInfoInDialog(this.value);">
          </select>

          <div>

            <table class="prefsTable" style="width:100%;">
              <colgroup>
                <col style="width:80px;" />
              </colgroup>
              <tbody>
                <tr>
                  <th colspan="3" style="text-align:center; line-height:10px;">
                    <span id="displayCostLevels"></span>
                    <span id="totalTraitCost"></span>
                  </th>
                </tr>
                <tr>
                  <th id="basicTraitCostWrapper" style="visibility:hidden;">Basic&nbsp;Cost&emsp;</th>
                  <td><input id="basicTraitCost" style="width:2em; visibility:hidden;" onchange="updateTraitCost(this.form)" /></td>
                  <th id="selectTraitLevelsWrapper" style="visibility:hidden;">
                    <span id="selectTraitLevelsName">levels</span>: 
                    <select id="selectTraitLevels" onchange="document.getElementById('selectCustomTraitLevels').value=this.value; updateTraitCost(this.form)"></select>
                  </th>
                </tr>
                <tr id="describeTraitWrapper" style="visibility:hidden;">
                  <th>Description&emsp;</th>
                  <td colspan="2"><input id="describeTrait" style="width:100%;" onkeyup="document.getElementById('customTraitDescription').value=this.value" /></td>
                </tr>
              </tbody>
            </table>

            <!-- modifier forms (Enhancements/Limitations, Multipliers, Constant Mods) -->
            <div style="clear:both; max-height:200px; overflow-y:auto;"><!-- margin-top doesn't work -->

              <div id="TraitConstantModsWrapper" style="text-align:left; padding-top:0.5em; display:none;">
                <a onclick="addNewConstantModRow('newTrait')" class="label">
                  &ensp;<img id="newConstantMod" src="../images/plus_blue.gif" />&nbsp;<span>Modifiers:</span>
                </a>
                <table id="newTraitConstantModsTable" style="clear:both; text-align:left;">
                  <colgroup>
                    <col style="width:20px;" />
                    <col style="width:20px;" />
                    <col />
                    <col style="width:50px;" />
                  </colgroup>
                  <tbody id="newTraitConstantModsTableTbody"></tbody>
                </table>
                <input type="hidden" id="newTraitConstantModRows" value="0" />
              </div>

              <div id="TraitMultipliersWrapper" style="text-align:left; padding-top:0.5em; display:none;">
                <a onclick="addNewMultiplierRow('newTrait')" class="label">
                  &ensp;<img id="newMultiplier" src="../images/plus_blue.gif" />&nbsp;<span>Multipliers:</span>
                </a>
                <table id="newTraitMultipliersTable" style="clear:both; text-align:left;">
                  <colgroup>
                    <col style="width:20px;" />
                    <col style="width:20px;" />
                    <col />
                    <col style="width:50px;" />
                  </colgroup>
                  <tbody id="newTraitMultipliersTableTbody"></tbody>
                </table>
                <input type="hidden" id="newTraitMultiplierRows" value="0" />
              </div>

              <div id="TraitEnhLimsWrapper" style="text-align:left; padding-top:0.5em;">
                <a onclick="addNewEnhLimRow('newTrait')" class="label">
                  &ensp;<img id="newEnhanceLimit" src="../images/plus_blue.gif" />&nbsp;<span>Enhancements/Limitations:</span>
                </a>
                <table id="newTraitEnhLimsTable" style="clear:both; text-align:left;">
                  <colgroup>
                    <col style="width:20px;" />
                    <col style="width:20px;" />
                    <col />
                    <col style="width:50px;" />
                  </colgroup>
                  <tbody id="newTraitEnhLimsTableTbody"></tbody>
                </table>
                <input type="hidden" id="newTraitEnhLimitRows" value="0" />
              </div>

            </div>

            <!-- end prefs table-ish stuff -->

          </div>

          <div class="fieldsetWrapper">

            <fieldset>

              <legend onclick="toggleFieldset2(document.getElementById('customTraitToggleButton'),'customTraitFormWrapper')" style="cursor:pointer;">
                <img id="customTraitToggleButton" src="../images/plus_blue.gif" />
                Custom Advantage / Disadvantage
              </legend>

              <div class="fieldsetNote">If this section is open, stats entered here will be used with those above to create a custom advantage or disadvantage and attach it to the character.</div>

              <div id="customTraitFormWrapper" style="display:none;">

                <table id="customTraitTable" class="prefsTable">
                  <colgroup>
                    <col style="width: 8em;" />
                    <col />
                    <col style="width: 4em;" />
                    <col style="width: 6em;" />
                  </colgroup>
                  <tbody>
                    <tr>
                      <th>Name&emsp;</th>
                      <td>
                        <input id="customTraitName" name="customTraitName" style="width:100%;"
                               onKeyUp="document.getElementById('selectTraitSubmit').innerHTML='take <i>'+this.value+'</i> custom trait'"
                                onBlur="document.getElementById('selectTraitSubmit').innerHTML='take <i>'+this.value+'</i> custom trait'" />
                      </td>
                      <th>Cost&emsp;</th>
                      <td title="If Levels are selected, this will be the per-level cost."><input id="customTraitPointCost" name="customTraitCost" style="width:100%;" onKeyUp="document.getElementById('customTraitEchoCost').innerHTML=this.value" /></td>
                    </tr>
                    <tr>
                      <th>Category&emsp;</th>
                      <td>
                        <select id="customTraitExoticSprntl" name="customTraitExoticSprntl">
                          <option value="M" selected="selected">Mundane (default)</option>
                          <option value="Ex">Exotic</option>
                          <option value="Su">Supernatural</option>
                        </select>
                      </td>
                      <th>Type&emsp;</th>
                      <td>
                        <select id="customTraitType" name="customTraitType" style="width:100%;">
                          <option value="M" selected="selected">Mental</option>
                          <option value="P">Physical</option>
                          <option value="MP">Mntl/Phys</option>
                          <option value="So">Social</option>
                        </select>
                      </td>
                    </tr>
                    <tr>
                      <th>Description&emsp;</th>
                      <td colspan="3"><input id="customTraitDescription" name="customTraitDescription" style="width:100%;" /></td>
                    </tr>
                    <tr>
                      <th>
                        <input type="checkbox" id="customTraitLevelsToggle" style="width:2em;" onclick="var state=(this.checked)?'on':'off'; customTraitLevelSwitch(state)" />
                        <label for="customTraitLevelsToggle">Levels&emsp;</label>
                      </th>
                      <td id="customTraitLevelsInputTD" colspan="3" style="visibility:hidden;">
                        <select id="selectCustomTraitLevels" style="width: 4em;" title="To take this trait at higher levels, use the 'Edit Ad/Disad' tool after taking this trait."></select>
                        &times; ( <span id="customTraitEchoCost">0</span> per <span id="customTraitLevelsName">level</span> )&ensp;&plus;&ensp;
                        <input id="customTraitFixedCost" value="0" style="width:3em;" title="Enter a value only if this trait should have a cost progression with a zero-level cost included; e.g. 5, 15, 25, etc." />
                        fixed cost
                      </td>
                    </tr>
                    <tr>
                      <td colspan="4">
                      </td>
                    </tr>
                  </tbody>
                </table>

                <fieldset>

                  <legend onclick="toggleFieldset2(document.getElementById('customTraitOptionsToggleButton'),'customTraitOptionsTable')" style="cursor:pointer;">
                    <img id="customTraitOptionsToggleButton" src="../images/plus_blue.gif" />
                    Options
                  </legend>

                  <table id="customTraitOptionsTable" class="customOptionsTable" style="display:none;">
                    <colgroup>
                      <col style="width:18em;" />
                      <col />
                    </colgroup>
                    <tbody>
                      <tr>
                        <td>
                          <a onclick="addNewConstantModRow('customTrait')" class="label">
                            <img id="newCustomTraitConstantMod" src="../images/plus_blue.gif" />
                            <span style="font-size:12px;">Modifier:</span>
                          </a>
                          <input type="hidden" id="customTraitConstantModRows" value="0" />
                        </td>
                      </tr>
                      <tr>
                        <td colspan="2">
                          <table id="customTraitConstantModsTable">
                            <colgroup>
                              <col style="width:2em;" />
                              <col style="width:2em;" />
                              <col />
                              <col style="width:5em;" />
                            </colgroup>
                            <tbody></tbody>
                          </table>
                        </td>
                      </tr>
                      <tr>
                        <td>
                          <a onclick="addNewMultiplierRow('customTrait')" class="label">
                            <img id="newCustomTraitMultiplier" src="../images/plus_blue.gif" />
                            <span style="font-size:12px;">Multiplier:</span>
                          </a>
                          <input type="hidden" id="customTraitMultiplierRows" value="0" />
                        </td>
                      </tr>
                      <tr>
                        <td colspan="2">
                          <table id="customTraitMultipliersTable">
                            <colgroup>
                              <col style="width:2em;" />
                              <col style="width:2em;" />
                              <col />
                              <col style="width:5em;" />
                            </colgroup>
                            <tbody></tbody>
                          </table>
                        </td>
                      </tr>
                      <tr>
                        <td>
                          <a onclick="addNewEnhLimRow('customTrait')" class="label">
                            <img id="newCustomTraitEnhanceLimit" src="../images/plus_blue.gif" />
                            <span style="font-size:12px;">Enhance/Limit:</span>
                          </a>
                          <input type="hidden" id="customTraitEnhLimitRows" value="0" />
                        </td>
                      </tr>
                      <tr>
                        <td colspan="2">
                          <table id="customTraitEnhLimsTable">
                            <colgroup>
                              <col style="width:2em;" />
                              <col style="width:2em;" />
                              <col />
                              <col style="width:5em;" />
                            </colgroup>
                            <tbody></tbody>
                          </table>
                        </td>
                      </tr>
                      <tr title="All prerequisites chosen will be required individually, i.e., joined with a logical 'and.'">
                        <td>
                          <a onclick="toggleFieldset2(document.getElementById('newCustomTraitPrerequisitesToggleButton'),'customTraitPrerequisiteTraitMenu')" class="label">
                            <img id="newCustomTraitPrerequisitesToggleButton" src="../images/plus_blue.gif" />
                            <span style="font-size:12px;">Ad/disad prerequisites:</span>
                          </a>
                        </td>
                        <td>
                          <select id="customTraitPrerequisiteTraitMenu" name="customTraitPrerequisiteTraitMenu"
                                  style="display:none;" onchange="addListTR('customTraitPrerequisiteTrait',this)">
                          </select>
                        </td>
                      </tr>
                      <tr>
                        <td colspan="2">
                          <table id="customTraitPrerequisiteTraitsList" class="OptionList" style="padding: 0 1em; width:100%;">
                            <colgroup>
                              <col style="width:15px;" />
                              <col style="min-width:160px;" />
                              <col />
                            </colgroup>
                            <tbody>
                              <tr>
                                <!-- empty row, so the indices used by addListTR and removeListTR work on this headless table -->
                                <th></th>
                                <th style="text-align:left;"></th>
                                <th style="text-align:center;"></th>
                              </tr>
                            </tbody>
                          </table>
                          <input type="hidden" id="customTraitPrerequisiteTraitListLastRowID" name="customTraitPrerequisiteTraitListLastRowID" value="0" />
                        </td>
                      </tr>
                      <tr>
                        <td>
                          <a onclick="toggleFieldset2(document.getElementById('newCustomTraitAdjustmentsToggleButton'),'customTraitAdjustingTraitMenu')" class="label">
                            <img id="newCustomTraitAdjustmentsToggleButton" src="../images/plus_blue.gif" />
                            <span style="font-size:12px;">Modifiers from ads/disads:</span>
                            &ensp;
                          </a>
                        </td>
                        <td>
                          <select id="customTraitAdjustingTraitMenu" name="customTraitAdjustingTrait"
                                  style="display:none;" onchange="addListTR('customTraitAdjustingTrait',this)">
                          </select>
                        </td>
                      </tr>
                      <tr>
                        <td colspan="2">
                          <table id="customTraitAdjustingTraitsList" class="OptionList" style="padding: 0 1em; clear:both;">
                            <colgroup>
                              <col style="width:15px;" />
                              <col style="min-width:160px;" />
                              <col />
                         <!-- <col style="width:40px;" /> -->
                            </colgroup>
                            <tbody>
                              <tr>
                                <th></th>
                                <th style="text-align:left;">Ad / Disad</th>
                                <th title="Modifiers for ads/disads that come in levels will be applied per level, i.e., if 'Night Vision' and '+2' are selected, each level of Night Vision will add 2 to the level of this custom trait."
                                    style="text-align:center;">mod</th>
                           <!-- <th style="text-align:center;">/lvl</th> -->
                              </tr>
                            </tbody>
                          </table>
                          <input type="hidden" id="customTraitAdjustingTraitListLastRowID" name="customTraitAdjustingTraitListLastRowID" value="0" />
                        </td>
                      </tr>
                      <tr>
                        <td>
                          <a onclick="toggleFieldset2(document.getElementById('newCustomTraitAdjustsSkillToggleButton'),'customTraitAdjustsSkillMenu')" class="label">
                            <img id="newCustomTraitAdjustsSkillToggleButton" src="../images/plus_blue.gif" />
                            <span style="font-size:12px;">Modifies these skills:</span>
                            &ensp;
                          </a>
                        </td>
                        <td>
                          <select id="customTraitAdjustsSkillMenu" name="customTraitAdjustsSkillMenu"
                                  style="display:none;" onchange="addListTR('customTraitAdjustsSkill',this)">
                          </select>
                        </td>
                      </tr>
                      <tr>
                        <td colspan="2">
                          <table id="customTraitAdjustsSkillsList" class="OptionList" style="padding: 0 1em; clear:both;">
                            <colgroup>
                              <col style="width:15px;" />
                              <col style="min-width:160px;" />
                              <col />
                            </colgroup>
                            <tbody>
                              <tr>
                                <th></th>
                                <th style="text-align:left;">Skill</th>
                                <th title=""
                                    style="text-align:center;">mod</th>
                              </tr>
                            </tbody>
                          </table>
                          <input type="hidden" id="customTraitAdjustsSkillListLastRowID" name="customTraitAdjustsSkillListLastRowID" value="0" />
                        </td>
                      </tr>
                      <!-- skill groups? -->
  <!--
                      <tr>
                        <td>
                          <a onclick="toggleFieldset2(document.getElementById('newCustomTraitAdjustsAttributeToggleButton'),'customTraitAdjustsAttributeMenu')" class="label">
                            <img id="newCustomTraitAdjustsAttributeToggleButton" src="../images/plus_blue.gif" />
                            <span style="font-size:12px;">Modifies these characteristics:</span>
                            &ensp;
                          </a>
                        </td>
                        <td>
                          <select id="customTraitAdjustsAttributeMenu" name="customTraitAdjustsAttributeMenu"
                                  style="display:none;" onchange="addListTR('customTraitAdjustsAttribute',this)">
                            <option value="ST"  >Strength</option>
                            <option value="DX"  >Dexterity</option>
                            <option value="IQ"  >Intelligence</option>
                            <option value="HT"  >Health</option>

                            <option value="HP"  >Hit Points</option>
                            <option value="Will">Will</option>
                            <option value="Per" >Perception</option>
                            <option value="FP"  >Fatigue Points</option>
                            <option value="spd" >Basic Speed</option>
                            <option value="lift">Basic Lift</option>
                            <option value="mv"  >Move</option>



                            <option value="vis" >Vision</option>
                            <option value="hrng">Hearing</option>
                            <option value="tsm" >Taste/Smell</option>

                            <option value="rxn" >Reaction</option>

                            <option value="def" >Active Defense</option>
                            <option value="dge" >Dodge</option>
                            <option value="par" >Parry</option>
                            <option value="blk" >Block</option>

                            <option value="DR"  >Damage Resistance (DR)</option>

                            <option value="thr" >Thrust Damage</option>
                            <option value="sw"  >Swing Damage</option>

                            <option value="enc" >Encumbrance (how?)</option>

                            <option value="swim">Swim</option>

                          </select>
                        </td>
                      </tr>
                      <tr>
                        <td colspan="2">
                          <table id="customTraitAdjustsAttributesList" class="OptionList" style="padding: 0 1em; clear:both;">
                            <colgroup>
                              <col style="width:15px;" />
                              <col style="min-width:160px;" />
                              <col />
                            </colgroup>
                            <tbody>
                              <tr>
                                <th></th>
                                <th style="text-align:left;">Skill</th>
                                <th title=""
                                    style="text-align:center;">mod</th>
                              </tr>
                            </tbody>
                          </table>
                          <input type="hidden" id="customTraitAdjustsAttributeListLastRowID" name="customTraitAdjustsAttributeListLastRowID" value="0" />
                        </td>
                      </tr>
  -->
                    </tbody>
                  </table>

                </fieldset>

              </div>

            </fieldset>

            <fieldset>

              <legend onclick="toggleFieldset2(document.getElementById('TraitsFiltersToggleButton'),'TraitsFiltersTable')" style="cursor:pointer;">
                <img id="TraitsFiltersToggleButton" src="../images/plus_blue.gif" />
                Filters
              </legend>

              <table id="TraitsFiltersTable" class="customOptionsTable" style="display:none;">
                <colgroup>
                  <col />
                  <col style="width: 2em;" />
                  <col />
                </colgroup>
                <tbody>
                  <tr>
                    <th>Show</th>
                    <td><input id="adsCheckbox" name="adsCheckbox" checked="checked" onchange="selectTraitsDialog();" type="checkbox" /></td>
                    <td><label for="adsCheckbox">Advantages</label></td>
                  </tr>
                  <tr>
                    <td></td>
                    <td><input id="disadsCheckbox" name="disadsCheckbox" checked="checked" onchange="selectTraitsDialog();" type="checkbox" /></td>
                    <td><label for="disadsCheckbox">Disadvantages</label></td>
                  </tr>
                  <tr>
                    <th>Show ads/disads that are</th>
                    <td><input id="physicalCheckbox" name="physicalCheckbox" checked="checked" onchange="selectTraitsDialog();" type="checkbox" /></td>
                    <td><label for="physicalCheckbox">Physical</label></td>
                  </tr>
                  <tr>
                    <td></td>
                    <td><input id="mentalCheckbox" name="mentalCheckbox" checked="checked" onchange="selectTraitsDialog();" type="checkbox" /></td>
                    <td><label for="mentalCheckbox">Mental</label></td>
                  </tr>
                  <tr>
                    <td></td>
                    <td><input id="socialCheckbox" name="socialCheckbox" checked="checked" onchange="selectTraitsDialog();" type="checkbox" /></td>
                    <td><label for="socialCheckbox">Social</label></td>
                  </tr>
                  <tr>
                    <th>Show ads/disads that are</th>
                    <td><input id="mundaneCheckbox" name="mundaneCheckbox" checked="checked" onchange="selectTraitsDialog();" type="checkbox" /></td>
                    <td><label for="mundaneCheckbox">Mundane</label></td>
                  </tr>
                  <tr>
                    <td></td>
                    <td><input id="exoticsCheckbox" name="exoticsCheckbox" checked="checked" onchange="selectTraitsDialog();" type="checkbox" /></td>
                    <td><label for="exoticsCheckbox">Exotic</label></td>
                  </tr>
                  <tr>
                    <td></td>
                    <td><input id="supernaturalsCheckbox" name="supernaturalsCheckbox" checked="checked" onchange="selectTraitsDialog();" type="checkbox" /></td>
                    <td><label for="supernaturalsCheckbox">Supernatural</label></td>
                  </tr>
                  <tr>
                    <th><label for="cinematicCheckbox">Show cinematic ads/disads</label></th>
                    <td><input id="cinematicCheckbox" name="cinematicCheckbox" checked="checked" onchange="selectTraitsDialog();" type="checkbox" /></td>
                    <td></td>
                  </tr>
                  <tr title="E.g., if you already have 'Acute Vision', hide the 'Bad Sight' and 'Blindness' disadvantages.">
                    <th><label for="groupsCheckbox">Show ads/disads from<br />represented exclusive groups</label></th>
                    <td><input id="groupsCheckbox" name="groupsCheckbox" checked="checked" onchange="selectTraitsDialog();" type="checkbox" /></td>
                    <td></td>
                  </tr>
                </tbody>
              </table>
            </fieldset>

          </div>

          <input                          type="submit" value="Close"               style="float:left;  width:auto; margin:1em;" onclick="document.getElementById('selectTraitDialog').style.display='none'; return false;" />
      <!--<input id="selectTraitSubmit" type="submit" value="take this advantage" style="float:right; width:auto; margin:1em;" onclick="loadTraitFromDialog(); return false;" />-->
          <button id="selectTraitSubmit"                                          style="float:right; width:auto; margin:1em;" onclick="loadTraitFromDialog(); return false;">Take this advantage</button>

        </div><!-- .dialogBody -->

      </form>

    </div>

    <div id="quirkPerkDialog" class="dialog">
      <form name="quirkPerkForm" method="post">
        <div class="titlebar">Create a Quirk or Perk</div>
        <div class="dialogBody" style="margin-top:1em; text-align:left;">
          <textarea id="quirkPerkDescription" rows="3" style="width: 100%;" ></textarea>
          <div style="clear: both;"></div>
          This is a
          <input id="quirkPerkChoice" name="quirkPerkChoice" value="Quirk" checked="checked" type="radio" style="width:1em;" /> quirk
          <input id="quirkPerkChoice" name="quirkPerkChoice" value="Perk" type="radio" style="width:1em;" /> perk 
          <input type="button" value="Clear Form" style="float:right; width:auto;" onclick="document.getElementById('quirkPerkDescription').value=''; return false;" />
          <div style="clear: both;"></div>
          <input type="submit" value="Close"   style="clear:both; float:left;  width:auto; margin:1em 0;" onclick="document.getElementById('quirkPerkDialog').style.display='none'; return false;" />
          <input type="submit" value="add this quirk/perk" style="float:right; width:auto; margin:1em 0;" onclick="loadQuirkPerkFromDialog(); return false;" />
        </div>
      </form>
    </div>

    <!-- - - - - - -->

    <div id="customTalentDialog" class="dialog">

      <form method="post" id="customTalentForm" name="customTalentForm">

        <div class="titlebar">Create a Talent group</div>

          <div id="defineTalentBody" class="dialogBody">

            <table class="prefsTable">
              <colgroup>
                <col style="width:12em;" />
              </colgroup>
              <tbody>
                <tr>
                  <th style="white-space:nowrap;">Talent Group name</th>
                  <td>&emsp;
                    <input id="TalentName" name="TalentName" type="text" style="width:90%;"
                           onchange="document.getElementById('TalentGroupName').innerHTML=this.value"
                            onkeyup="document.getElementById('TalentGroupName').innerHTML=this.value" />
                  </td>
                </tr>
                <tr>
                  <th style="white-space:nowrap;">Build Talent Group of</th>
                  <td>&emsp;
                    <input type="radio" id="skillSetSelectorSkills"    name="skillSetSelector" value="Skills" checked="checked"
                           onchange="customTalentDialog(this.value)" />
                    <label for="skillSetSelectorSkills">skills</label>
                    <input type="radio" id="skillSetSelectorSpells"    name="skillSetSelector" value="Spells"
                           onchange="customTalentDialog(this.value)" />
                    <label for="skillSetSelectorSpells">spells</label>
                  </td>
                </tr>
              </tbody>
            </table>

            <div class="clear"><br /></div>

            <div style="width:50%; float:left; padding:0">
              <span>Choose skills to include:</span>
              <select id="selectTalentSkillsMenu" name="selectTalentSkillsMenu" size="9" style="width:100%;"
                      title="click on a skill to include it in this Talent Group"
                      onchange="updateCustomTalent(this)">
              </select>
            </div>

            <div style="width:50%; float:left; padding:0">
              <span>Skills included so far:</span>
              <select id="selectedTalentSkillsMenu" name="selectedTalentSkillsMenu" size="9" style="width:100%;"
                      title="click on a skill to remove it from this Talent Group"
                      onchange="updateCustomTalent(this)">
              </select>
            </div>

            <div class="clear"><br /></div>

            <div style="text-align:left;">
              <input id="applyTalent" name="talentSaveOption" value="apply" type="radio" style="width:1em;" onclick="document.getElementById('customTalentLevelsDiv').style.visibility='visible'" checked="checked" />
              <label for="applyTalent" id="applyTalentLabel" title="This talent will be applied to the current character.">
                apply to 
                <div id="customTalentApplyToDiv" style="display:inline; padding:0">
                  <select id="selectTalentTarget" style=""
                          onchange="var name=document.loadedCharacter.description.name;
                                    this.options[0].text = (name=='New Character') ? 'the current character' : name;
                                    document.getElementById('applyTalentLabel').title = (this.value=='cur')
                                    ? 'This talent will be applied to '+name+'.'
                                    : 'A new character will be created with this talent already applied to it.'">
                    <option value="cur">the current character</option>
                    <option value="new">a new character</option>
                  </select>
                </div>
                <div id="customTalentLevelsDiv" style="display:inline; padding:0">
                  at level
                  <select id="selectTalentLevel" style="width:4em;">
                    <option value="1">1</option>
                    <option value="2">2</option>
                    <option value="3">3</option>
                    <option value="4">4</option>
                  </select>
                </div>
              </label>
              <br />
              <input id="offerTalent"  name="talentSaveOption" value="offer" type="radio" style="width:1em;" onclick="document.getElementById('customTalentLevelsDiv').style.visibility='hidden'" disabled="disabled" />
              <label for="offerTalent" style="color:gray">load into the 'Ads / Disads' menu (temporary)</label>   <!-- title="The talent created will be temporarily available in the 'Ads / Disads' menu, until the browser page is reloaded." -->
              <br />
              <input id="exportTalent" name="talentSaveOption" value="export" type="radio" style="width:1em;" onclick="document.getElementById('customTalentLevelsDiv').style.visibility='hidden'" />
              <label for="exportTalent" style="height:1.5em;" title="A text file will be created that can be saved, and/or appended to a library file using a text editor.  Talents properly appended to an included library file should become permanently available in the 'Ads / Disads' menu.">export as a Talent file</label>
            </div>

            <div style="margin-top:1em; font-weight:bold;">
              This Talent will cost <span id="customTalentCalculatedCost">5</span> points/level
            </div>

          </div>

        <div class="clear"></div>

        <input type="submit" value="Done"   style="float:left; width:auto; margin:1em;"
               onClick="document.getElementById('customTalentDialog').style.display='none'; return false;" />
        <button name="submitTalent" style="float:right; width:auto; margin:1em;" onclick="createCustomTalent(this.form); return false;">Create <em id="TalentGroupName"></em>&ensp;Talent Group</button>

      </form>

    </div>

    <!-- - - - - - -->

    <div id="selectSkillDialog" class="dialog">

      <form method="post" id="selectSkillForm" name="selectSkillForm">

        <div class="titlebar">Select
          <select id="selectSkillOrSpell" style="font:inherit; border:none; background-color:inherit;" onchange="selectSkillDialog()">
            <option value="Skill">Skill</option>
            <option value="Spell">Spell</option>
          </select>
        </div>

        <div id="skillsDialogExtras" class="dialogBody">

          <div id="hasVersionNoticeBox" class="noticeBox" style="float:left; visibility:hidden; width:65%; text-indent:-8px;">
            * <span id="nameHasSkill"></span> already has one or more specializations/TLs of this skill
          </div>
          <div id="selectSkillSortWrapper" class="dialogSortWrapper">
            Sort by:
            <select id="selectSkillSort" onchange="selectSkillDialog(this.form.selectSkillMenu.value,this.value)">
              <option value="name">name</option>
              <option value="attribute">attribute</option>
              <option value="difficulty">difficulty</option>
            </select>
          </div>

          <select id="selectSkillMenu" name="selectSkillMenu" size="7" class="mainSelect" onchange="showSkillInfoInDialog(this.value);">
          </select>

          <div>

            <div id="selectSkillTLcollegeWrapper" style="float:left; width:30%; text-align:left;">
              <div id="selectSpellCollegeInfo" class="SkillSpellInfo" style="height:15px; line-height:14px;"></div>
              <div id="selectSkillTLwrapper" style="display:none;">
                Select TL:&nbsp;<select id="selectSkillTL" style="display:inline;"></select>
              </div>
            </div>
            <div id="displayAttDiff" class="SkillSpellInfo" style="float:left; width:40%; text-align:center; height:15px; line-height:14px; white-space:nowrap;">attribute / difficulty</div>
            <div style="float:right; width:30%; text-align:right;" title="You can change points assigned to a skill later.">
              points:
              <select id="selectSkillPts">
                <option value="1" selected="selected">1</option>
                <option value="2">2</option>
                <option value="4">4</option>
              </select>
            </div>

            <table id="spellStatsTable" class="prefsTable" style="width:100%; font-size:8pt; line-height:16px;">
              <tbody>
                <tr>
                  <td id="selectedSpellCostStats" style="text-align:center;"></td>
                </tr>
              </tbody>
            </table>

            <table id="skillSpecializationsTable" class="prefsTable" style="width:100%; height:24px;">

              <colgroup>
                <col />
                <col />
              </colgroup>

              <tbody>
                <tr id="skillSpecializationTR" style="display:none;">
                  <th>&emsp;</th>
                  <th style="text-align:left;">
                    <span id="selectSkillSpecInstructions">Select a specialization</span>
                    <span id="selectSkillSpecializationWrapper" style="display:inline;">:
                      <select id="selectSkillSpecialization" style="display:inline;"
                              onchange="this.form.selectSkillSpecChosen.value=this.value; showSkillInfoInDialog(this.form.selectSkillMenu.value);">
                      </select>
                      <input type="hidden" id="selectSkillSpecChosen" name="selectSkillSpecChosen" value="" />
                    </span>
                    <span id="specifySkillSpecializationWrapper" style="display:none;">:
                      <input id="specifySkillSpecialization" type="text" style="width:60%; " />
                    </span>
                  </th>
                </tr>

                <tr id="selectSkillOptSpecWrapper" style="display:none;">
                  <th>&emsp;</th>
                  <th style="text-align:left;">
                    <input id="optSpecChbox" name="optSpecChbox" type="checkbox" style="width:auto; padding:0; margin:0;"
                           onchange="var elmt=document.getElementById('optionalSpecializationInputWrapper'); if(this.checked){elmt.style.visibility='inherit';}else{elmt.style.visibility='hidden';} " />
                    <label for="optSpecChbox">Optional&nbsp;specialization</label>
                    <span id="optionalSpecializationInputWrapper" style="visibility:hidden; text-align:left;">:
                      <input id="selectSkillOptSpec" name="selectSkillOptSpec" style="width:50%;" />
                    </span>
                  </th>
                </tr>
              </tbody>

            </table>

            <!-- This option is not used for any skill in either the 3rd or 4th edition libraries -->
            <div id="selectSkillTLSpecWrapper" style="clear:both; display:none;">
              Select a specialization/TL:
              <select id="selectSkillTLSpec" style="width:60%;">
              </select>
            </div>

          </div>

          <div class="fieldsetWrapper">

            <fieldset>

              <legend onclick="toggleFieldset2(document.getElementById('customSkillToggleButton'),'customSkillFormWrapper'); showSkillInfoInDialog(this.form.selectSkillMenu.value)">
                <img id="customSkillToggleButton" src="../images/plus_blue.gif" />
                <span id="customSkillFieldsetLegendText">Custom Skill</span>
              </legend>

              <div class="fieldsetNote">If this section is open, stats entered here will be used with those above to create a custom skill/spell and attach it to the character.</div>

              <div id="customSkillFormWrapper" style="display:none; padding:0px;">

                <div>

                  <table class="prefsTable">
                    <colgroup>
                      <col />
                      <col />
                      <col />
                      <col />
                      <col />
                      <col />
                    </colgroup>
                    <tbody>
                      <tr>
                        <th>Name&emsp;</th>
                        <td colspan="5">
                          <input id="customSkillName" name="customSkillName" type="text" style="width:100%;"
                                 onKeyUp="$('#selectSkillSubmit').html('take <i>'+this.value+'</i> custom '+$('#selectSkillOrSpell').val().toLowerCase());$('#selectSkillSubmit').prop('disabled',false)"
                                  onBlur="$('#selectSkillSubmit').html('take <i>'+this.value+'</i> custom '+$('#selectSkillOrSpell').val().toLowerCase())" />
                        </td>
                      </tr>
                      <tr>
                        <th>Attribute&emsp;</th>
                        <td>
                          <select id="customSkillAttribute" name="customSkillAttribute">
                          </select>
                        </td>
                        <th id="customSkillTypeLabelCell">Type&ensp;</th>
                        <td id="customSkillTypeInputCell">
                          <select id="customSkillType" name="customSkillType">
                            <option value="M">Mental  </option>
                            <option value="P">Physical</option>
                          </select>
                        </td>
                        <th>Difficulty&ensp;</th>
                        <td>
                          <select id="customSkillDifficulty" name="customSkillDifficulty">
                            <option value="0">Easy</option>
                            <option value="1" selected="selected">Average</option>
                            <option value="2">Hard</option>
                            <option value="3">Very Hard</option><!-- only IQ-based skills in 3e -->
                          </select>
                        </td>
                      </tr>
                    </tbody>
                  </table>

                </div>

                <div id="customSkillCustomSpellFormWrapper" style="padding:0px;">

                  <table class="prefsTable">
                    <colgroup>
                      <col style="width: 8em;" />
                      <col />
                      <col />
                      <col />
                    </colgroup>
                    <tbody>
                      <tr>
                        <th title="select all that apply">College(s)&emsp;</th>
                        <td title="select all that apply">
                          <select id="customSkillSpellCollegeMenu" name="customSkillSpellCollegeMenu" multiple size="5" style="">
                          </select>
                        </td>
                        <td colspan="2" rowspan="5" style="text-align:center;">
                          <table style="line-height:16px; margin-left:6px;">
                            <tr>
                              <th colspan="2" style="text-align:center;">Spell Classes&emsp;</th>
                            </tr>
                            <tr>
                              <td><input id="SpellClassCB_reg"  name="SpellClassCB_reg"  type="checkbox" checked="checked" /><label for="SpellClassCB_reg">Regular</label></td>
                              <td><input id="SpellClassCB_area" name="SpellClassCB_area" type="checkbox" /><label for="SpellClassCB_area">Area</label></td>
                            </tr>
                            <tr>
                              <td><input id="SpellClassCB_melee" name="SpellClassCB_melee" type="checkbox" /><label for="SpellClassCB_melee">Melee</label></td>
                              <td><input id="SpellClassCB_msl"   name="SpellClassCB_msl"   type="checkbox" /><label for="SpellClassCB_msl">Missile</label></td>
                            </tr>
                            <tr>
                              <td><input id="SpellClassCB_block" name="SpellClassCB_block" type="checkbox" /><label for="SpellClassCB_block">Blocking</label></td>
                              <td><input id="SpellClassCB_info"  name="SpellClassCB_info"  type="checkbox" /><label for="SpellClassCB_info">Info</label></td>
                            </tr>
                            <tr>
                              <td><input id="SpellClassCB_ench" name="SpellClassCB_ench" type="checkbox" /><label for="SpellClassCB_ench">Enchant</label></td>
                              <td><input id="SpellClassCB_spcl" name="SpellClassCB_spcl" type="checkbox" /><label for="SpellClassCB_spcl">Special</label></td>
                            </tr>
                            <tr>
                              <td colspan="2">
                                <input id="SpellClassResistedCB" name="SpellClassResistedCB" type="checkbox" /><label for="SpellClassResistedCB">Resisted by</label>
                                <select id="CustomSpellResistedByMenu">
                                </select>
                              </td>
                            </tr>
                          </table>
                        </td>
                      </tr>
                      <tr>
                        <th>Custom&nbsp;College&emsp;</th>
                        <td><input id="customSkillSpell_customCollege" name="customSkillSpell_customCollege" type="text" style="width:10em;" /></td>
                      </tr>
                      <tr>
                        <th>Casting&nbsp;Cost&emsp;</th>
                        <td><input id="customSkillSpell_castcost" name="customSkillSpell_castcost" type="text" style="width:6em;" /></td>
                      </tr>
                      <tr>
                        <th>Maint.&nbsp;Cost&emsp;</th>
                        <td><input id="customSkillSpell_maintaincost" name="customSkillSpell_maintaincost" type="text" style="width:6em;" /></td>
                      </tr>
                      <tr>
                        <th>Time&nbsp;to&nbsp;Cast&emsp;</th>
                        <td><input id="customSkillSpell_time" name="customSkillSpell_time" type="text" placeholder="1" style="width:6em;" /></td>
                      </tr>
                      <tr>
                        <th>Duration&emsp;</th>
                        <td><input id="customSkillSpell_duration" name="customSkillSpell_duration" type="text" placeholder="instant" style="width:6em;" /></td>
                      </tr>
                    </tbody>
                  </table>

                </div>

              </div><!-- #customSkillFormWrapper -->

              <fieldset>

                <legend onclick="toggleDisplay(document.getElementById('customSkillsOptionsToggleButton'),'customSkillsOptionsTable','table')" style="cursor:pointer;">
                  <img id="customSkillsOptionsToggleButton" src="../images/plus_blue.gif" />
                  Options
                </legend>

                <table id="customSkillsOptionsTable" class="customOptionsTable" style="display:none;">

                  <colgroup>
                    <col style="width:18em;" />
                    <col />
                  </colgroup>

                  <tbody>

                    <tr>
                      <td>
                        <input id="customSkillTLCheckbox" name="customSkillTLCheckbox" type="checkbox" style="cursor:pointer;"
                               onChange="toggleViewCB(this,'display','block',[document.getElementById('customSkillTL')])" />
                        <label for="customSkillTLCheckbox" style="cursor:pointer;">Tech level:</label>
                      </td>
                      <td>
                        <select id="customSkillTL" name="customSkillTL" style="width:5em; display:none;">
                          <option value="" >N/A</option>
                          <option value="1" >1 </option>
                          <option value="2" >2 </option>
                          <option value="3" >3 </option>
                          <option value="4" >4 </option>
                          <option value="5" >5 </option>
                          <option value="6" >6 </option>
                          <option value="7" >7 </option>
                          <option value="8" >8 </option>
                          <option value="9" >9 </option>
                          <option value="10">10</option>
                          <option value="11">11</option>
                          <option value="12">12</option>
                          <option value="13">13</option>
                          <option value="14">14</option>
                          <option value="15">15</option>
                        </select>
                      </td>
                    </tr>

                    <tr>
                      <td>
                        <input id="customSkillReqSpecCheckbox" name="customSkillReqSpecCheckbox" type="checkbox" style="cursor:pointer;"
                               onChange="toggleViewCB(this,'display','block',[document.getElementById('customSkillReqSpec')])" />
                        <label for="customSkillReqSpecCheckbox" style="cursor:pointer;">Required specialization:</label>
                      </td>
                      <td><input id="customSkillReqSpec"  name="customSkillReqSpec" type="text" style="display:none;" /></td>
                    </tr>

                    <tr>
                      <td>
                        <input id="customSkillOptSpec1Checkbox" name="customSkillOptSpec1Checkbox" type="checkbox" style="cursor:pointer;"
                               onChange="toggleViewCB(this,'display','block',[document.getElementById('customSkillOptSpec1')])" />
                        <label for="customSkillOptSpec1Checkbox" style="cursor:pointer;">Optional specializations:</label>
                      </td>
                      <td>
                        <input id="customSkillOptSpec1" name="customSkillOptSpec1" type="text" style="display:none;"
                               onkeyup="if(this.value){document.getElementById('customSkillOptSpec2TR').style.visibility='visible';} else {document.getElementById('customSkillOptSpec2').value=''; document.getElementById('customSkillOptSpec2TR').style.visibility='hidden'; }" />
                      </td>
                    </tr>

                    <tr id="customSkillOptSpec2TR" style="visibility:hidden;">
                      <td>
                        &emsp;
                        <input id="customSkillOptSpec2Checkbox" name="customSkillOptSpec2Checkbox" type="checkbox" style="cursor:pointer;visibility:inherit;"
                               onChange="var inpt=document.getElementById('customSkillOptSpec2'); var lbl=document.getElementById('customSkillOptSpec2Label'); if(this.checked) {inpt.disabled=false; inpt.style.backgroundColor=null; lbl.style.color='black'} else {inpt.disabled='disabled'; inpt.style.backgroundColor='#EEE';  lbl.style.color='darkgrey'}" />
                        <label id="customSkillOptSpec2Label" for="customSkillOptSpec2Checkbox" style="cursor:pointer;color:darkgrey">2<sup>nd</sup> Opt Spec:</label>
                      </td>
                      <td><input id="customSkillOptSpec2" name="customSkillOptSpec2" type="text" disabled="disabled" style="background-color:#EEE" /></td>
                    </tr>

                    <!-- attribute defaults -->
                    <tr>
                      <td>
                        <a onclick="toggleVisibility(document.getElementById('newCustomSkillAttDefaultsToggleButton'),'customSkillCustomAttDefaultsTD','visible')" class="label">
                          <img id="newCustomSkillAttDefaultsToggleButton" src="../images/plus_blue.gif" />
                          <span style="font-size:12px;">Custom attribute defaults:</span>
                        </a>
                      </td>
                      <td id="customSkillCustomAttDefaultsTD" style="visibility:hidden;">
                        <select id="customSkillDefaultAttMenu" name="attributeDefault" style="visibility:inherit; height:18px; width:auto;">
                          <option value="ST"  > ST </option>
                          <option value="DX"  > DX </option>
                          <option value="IQ"  > IQ </option>
                          <option value="HT"  > HT </option>
                          <option value="Will">Will</option>
                          <option value="Per" >Per </option>
                        </select>
                        &emsp;
                        <select id="customSkillAttDefaultPenaltyMenu" name="defaultPenalty" style="visibility:inherit; height:18px; width:auto;">
                          <option value="0" > 0</option>
                          <option value="-1">-1</option>
                          <option value="-2">-2</option>
                          <option value="-3">-3</option>
                          <option value="-4">-4</option>
                          <option value="-5">-5</option>
                          <option value="-6">-6</option>
                          <option value="-7">-7</option>
                          <option value="-8">-8</option>
                        </select>
                        &emsp;
                        <input type="button" value="add default" style="visibility:inherit; height:18px; width:auto;"
                               onclick="addListTR('customSkillCustomAttDefault',document.getElementById('customSkillDefaultAttMenu'))" />
                      </td>
                    </tr>

                    <tr>
                      <td colspan="2">
                        <table id="customSkillCustomAttDefaultsList" class="OptionList">
                          <colgroup>
                            <col style="width:15px;" />
                            <col style="min-width:60px;" />
                            <col style="width:40px;" />
                          </colgroup>
                          <tbody>
                            <tr>
                              <th></th>
                              <th style="text-align:left;">Attribute</th>
                              <th style="text-align:center;">penalty</th>
                            </tr>
                          </tbody>
                        </table>
                        <input id="customSkillCustomAttDefaultListLastRowID" type="hidden"
                               name="customSkillCustomAttDefaultListLastRowID" value="0" />
                      </td>
                    </tr>

                    <!-- Skill defaults -->
                    <tr>
                      <td>
                        <a onclick="toggleFieldset2(document.getElementById('newCustomSkillDefaultSkillsToggleButton'),'customSkillDefaultSkillsMenu')" class="label">
                          <img id="newCustomSkillDefaultSkillsToggleButton" src="../images/plus_blue.gif" />
                          <span style="font-size:12px;">Defaults from other skills:</span>
                        </a>
                      </td>
                      <td>
                        <select id="customSkillDefaultSkillsMenu" name="defaultSkills"
                                style="display:none;" onChange="addListTR('customSkillDefaultSkill',this)">
                        </select>
                      </td>
                    </tr>
                    <tr>
                      <td colspan="2">
                        <table id="customSkillDefaultSkillsList" class="OptionList">
                          <colgroup>
                            <col style="width:15px;" />
                            <col style="min-width:100px;" />
                            <col style="min-width:100px;" />
                            <col style="width:40px;" />
                          </colgroup>
                          <tbody>
                            <tr>
                              <th></th>
                              <th style="text-align:left;">Skill</th>
                              <th style="text-align:left;">specialization</th>
                              <th style="text-align:center;">penalty</th>
                            </tr>
                          </tbody>
                        </table>
                        <input type="hidden" id="customSkillDefaultSkillListLastRowID"
                               name="customSkillDefaultSkillListLastRowID" value="0" />
                      </td>
                    </tr>

                    <!-- Skill prerequisites -->
                    <tr title="All prerequisites chosen will be required individually, i.e., joined with a logical 'and.'">
                      <td>
                        <a onclick="toggleFieldset2(document.getElementById('newCustomSkillPrereqsToggleButton'),'customSkillPrerequisiteSkillsMenu')" class="label">
                          <img id="newCustomSkillPrereqsToggleButton" src="../images/plus_blue.gif" />
                          <span style="font-size:12px;">Skill prerequisites:</span>
                        </a>
                      </td>
                      <td>
                        <select id="customSkillPrerequisiteSkillsMenu" name="defaultSkills"
                                style="display:none;" onChange="addListTR('customSkillPrerequisiteSkill',this)">
                        </select>
                      </td>
                    </tr>
                    <tr id="customSkillPrerequisiteSkillsMenuTR"
                        title="All prerequisites chosen will be required individually, i.e., joined with a logical 'and.'">
                      <td colspan="2">
                        <table id="customSkillPrerequisiteSkillsList" class="OptionList">
                          <colgroup>
                            <col style="width:15px;" />
                            <col style="min-width:100px;" />
                            <col style="width:40px;" />
                          </colgroup>
                          <tbody>
                            <tr>
                              <th></th>
                              <th style="text-align:left;">Skill</th>
                              <th style="text-align:center;">level</th>
                            </tr>
                          </tbody>
                        </table>
                        <input type="hidden" id="customSkillPrerequisiteSkillListLastRowID" style="display:none;"
                               name="customSkillPrerequisiteSkillListLastRowID" value="0" />
                      </td>
                    </tr>

                    <!-- Spell prerequisites -->
                    <tr title="All prerequisites chosen will be required individually, i.e., joined with a logical 'and.'">
                      <td>
                        <a onclick="toggleFieldset2(document.getElementById('newCustomSkillPrereqSpellsToggleButton'),'customSkillPrerequisiteSpellsMenu')" class="label">
                          <img id="newCustomSkillPrereqSpellsToggleButton" src="../images/plus_blue.gif" />
                          <span style="font-size:12px;">Spell prerequisites:</span>
                        </a>
                      </td>
                      <td>
                        <select id="customSkillPrerequisiteSpellsMenu" name="defaultSpells" style="display:none;"
                                onChange="addListTR('customSkillPrerequisiteSpell',this)">
                        </select>
                      </td>
                    </tr>
                    <tr id="customSkillPrerequisiteSpellsMenuTR"
                        title="All prerequisites chosen will be required individually, i.e., joined with a logical 'and.'">
                      <td colspan="2">
                        <table id="customSkillPrerequisiteSpellsList" class="OptionList">
                          <colgroup>
                            <col style="width:15px;" />
                            <col style="min-width:100px;" />
                            <col style="width:40px;" />
                          </colgroup>
                          <tbody>
                            <tr>
                              <th></th>
                              <th style="text-align:left;">Spell</th>
                              <!-- <th style="text-align:center;">level</th> -->
                            </tr>
                          </tbody>
                        </table>
                        <input type="hidden" id="customSkillPrerequisiteSpellListLastRowID"
                               name="customSkillPrerequisiteSpellListLastRowID" value="0" />
                      </td>
                    </tr>

                    <!-- Group prerequisites -->
                    <tr title="For prerequisites like '4 Earth Spells' or '3 Languages'">
                      <td>
                        <a onclick="toggleFieldset2(document.getElementById('newCustomSkillPrereqGroupsToggleButton'),'customSkillPrerequisiteGroup')" class="label">
                          <img id="newCustomSkillPrereqGroupsToggleButton" src="../images/plus_blue.gif" />
                          <span style="font-size:12px;">Group prerequisites:</span>
                        </a>
                      </td>
                      <td id="customSkillPrerequisiteGroup" style="display:none;"
                          title="When these menus are visible, the indicated Group prerequisite will be applied.">
                        <select id="customSkillPrerequisiteGroupNumberMenu"
                              name="customSkillPrerequisiteGroupNumberMenu" style="float:left; width:20%;">
                          <option value="1">1</option>
                          <option value="2">2</option>
                          <option value="3">3</option>
                          <option value="4" selected="selected">4</option>
                          <option value="5">5</option>
                          <option value="6">6</option>
                          <option value="7">7</option>
                          <option value="8">8</option>
                          <option value="9">9</option>
                          <option value="10">10</option>
                        </select>
                        <select id="customSkillPrerequisiteGroupsMenu" style="width:80%;"
                              name="customSkillPrerequisiteGroupsMenu">
                        </select>
                      </td>
                    </tr>

                    <!-- Trait prerequisites -->
                    <tr title="All prerequisites chosen will be required individually, i.e., joined with a logical 'and.'">
                      <td>
                        <a onclick="toggleFieldset2(document.getElementById('newCustomSkillPrereqTraitsToggleButton'),'customSkillPrerequisiteTraitsMenu')" class="label">
                          <img id="newCustomSkillPrereqTraitsToggleButton" src="../images/plus_blue.gif" />
                          <span style="font-size:12px;">Ad/disad prerequisites:</span>
                        </a>
                      </td>
                      <td>
                        <select id="customSkillPrerequisiteTraitsMenu" style="display:none;"
                                name="prerequisiteTrait" onchange="addListTR('customSkillPrerequisiteTrait',this)">
                        </select>
                      </td>
                    </tr>
                    <tr id="customSkillPrerequisiteTraitsMenuTR"
                        title="All prerequisites chosen will be required individually, i.e., joined with a logical 'and.'">
                      <td colspan="2">
                        <table id="customSkillPrerequisiteTraitsList" class="OptionList">
                          <colgroup>
                            <col style="width:15px;" />
                            <col style="min-width:160px;" />
                          </colgroup>
                          <tbody>
                            <tr>
                              <!-- empty row, so the indices used by addListTR and removeListTR work on this headless table -->
                              <th></th>
                              <th style="text-align:left;"></th>
                              <th style="text-align:center;"></th>
                            </tr>
                          </tbody>
                        </table>
                        <input type="hidden" id="customSkillPrerequisiteTraitListLastRowID"
                               name="customSkillPrerequisiteTraitsListLastRowID" value="0" />
                      </td>
                    </tr>

                    <!-- Trait-based modifiers -->
                    <tr>
                      <td>
                        <a onclick="toggleFieldset2(document.getElementById('newCustomSkillTraitModsToggleButton'),'customSkillAdjustingTraitMenu')" class="label">
                          <img id="newCustomSkillTraitModsToggleButton" src="../images/plus_blue.gif" />
                          <span style="font-size:12px;">Modifiers from Ads/Disads:</span>
                        </a>
                      </td>
                      <td id="traitAdjustmentTD1">
                        <select id="customSkillAdjustingTraitMenu" style="display:none;"
                                name="adjustingTrait" onchange="addListTR('customSkillAdjustingTrait',this)">
                        </select>
                      </td>
                    </tr>
                    <tr id="adjustingTraitMenuTR">
                      <td colspan="2">
                        <table id="customSkillAdjustingTraitsList" class="OptionList">
                          <colgroup>
                            <col style="width:15px;" />
                            <col style="min-width:160px;" />
                            <col />
                          </colgroup>
                          <tbody>
                            <tr>
                              <th></th>
                              <th style="text-align:left;">Ad / Disad</th>
                              <th style="text-align:center;"
                                  title="Modifiers for ads/disads that come in levels will be applied per level, i.e., if 'Night Vision' and '+2' are selected, each level of Night Vision will add 2 to the level of this custom skill.">mod</th>
                            </tr>
                          </tbody>
                        </table>
                        <input type="hidden" id="customSkillAdjustingTraitListLastRowID" name="customSkillAdjustingTraitListLastRowID" value="0" />
                      </td>
                    </tr>

                  </tbody>

                </table>

              </fieldset>

            </fieldset>

            <fieldset>

              <legend onclick="toggleFieldset2(document.getElementById('skillsFiltersToggleButton'),'skillsFiltersTable')" style="cursor:pointer;">
                <img id="skillsFiltersToggleButton" src="../images/plus_blue.gif" />
                Filters
              </legend>

              <table id="skillsFiltersTable" class="customOptionsTable" style="display:none;">
                <colgroup>
                  <col />
                  <col style="width: 2em;" />
                  <col style="width: 5em;" />
                  <col style="width: 2em;" />
                  <col style="width:10em;" />
                </colgroup>
                <tbody>
                  <tr>
                    <th>Show skills based on</th>
                    <td><input id="STCheckbox" name="STCheckbox" checked="checked" onchange="selectSkillDialog();" type="checkbox" /></td>
                    <td><label for="STCheckbox">ST</label></td>
                    <td><input id="IQCheckbox" name="IQCheckbox" checked="checked" onchange="selectSkillDialog();" type="checkbox" /></td>
                    <td><label for="IQCheckbox">IQ</label></td>
                  </tr>
                  <tr>
                    <td></td>
                    <td><input id="DXCheckbox" name="DXCheckbox" checked="checked" onchange="selectSkillDialog();" type="checkbox" /></td>
                    <td><label for="DXCheckbox">DX</label></td>
                    <td><input id="HTCheckbox" name="HTCheckbox" checked="checked" onchange="selectSkillDialog();" type="checkbox" /></td>
                    <td><label for="HTCheckbox">HT</label></td>
                  </tr>
                  <tr id="skillsFiltersTable4eAttsRow" style="display:none;">
                    <td></td>
                    <td><input id="PerCheckbox" name="PerCheckbox" checked="checked" onchange="selectSkillDialog();" type="checkbox" /></td>
                    <td><label for="PerCheckbox">Per</label></td>
                    <td><input id="WillCheckbox" name="WillCheckbox" checked="checked" onchange="selectSkillDialog();" type="checkbox" /></td>
                    <td><label for="WillCheckbox">Will</label></td>
                  </tr>
                  <tr>
                    <th>Show skills that are</th>
                    <td><input id="easyCheckbox" name="easyCheckbox" checked="checked" onchange="selectSkillDialog();" type="checkbox" /></td>
                    <td><label for="easyCheckbox">Easy</label></td>
                    <td><input id="averageCheckbox" name="averageCheckbox" checked="checked" onchange="selectSkillDialog();" type="checkbox" /></td>
                    <td><label for="averageCheckbox">Average</label></td>
                  </tr>
                  <tr>
                    <td></td>
                    <td><input id="hardCheckbox" name="hardCheckbox" checked="checked" onchange="selectSkillDialog();" type="checkbox" /></td>
                    <td><label for="hardCheckbox">Hard</label></td>
                    <td><input id="veryhardCheckbox" name="veryhardCheckbox" checked="checked" onchange="selectSkillDialog();" type="checkbox" /></td>
                    <td><label for="veryhardCheckbox">Very Hard</label></td>
                  </tr>
                  <tr id="SkillCategoryFilterTR" style="display:none;">
                    <td colspan="5">
                      Show only
                      <select id="SkillCategoryDisplayMenu" name="SkillCategoryDisplayMenu" onchange="selectSkillDialog();"
                              style="width:auto; font:inherit;">
                      </select>
                      skills
                    </td>
                  </tr>
                  <tr id="SkillPrereqDisplayTR">
                    <td style="text-align:right;">
                      <select id="SkillPrereqDisplayMenu" name="SkillPrereqDisplayMenu" onchange="selectSkillDialog();"
                              style="width:auto; font:inherit;">
                        <option value="mark">Mark</option>
                        <option value="disable">Disable</option>
                        <option value="hide">Hide</option>
                      </select>
                      &ensp;
                    </td>
                    <td colspan="4" style="line-height:14px;">
                      skills for which <span id="selectSkillsFiltersPrereqNoticeCharacter">Character</span><br />does not have prerequisites
                    </td>
                  </tr>
                  <tr id="SpellCollegeFilterTR">
                    <td colspan="5">
                      Show only spells from
                      <select id="SpellCollegeDisplayMenu" name="SpellCollegeDisplayMenu" onchange="selectSkillDialog();"
                              style="width:auto; font:inherit;">
                        <option value="all" selected="selected">(any)</option>
                        <option value="Air">Air</option>
                        <option value="Earth">Earth</option>
                        <option value="Fire">Fire</option>
                        <option value="Water">Water</option>
                        <option value="AnimalSpells">Animal</option>
                        <option value="BodyControl">Body Control</option>
                        <option value="CommunicationEmpathy">Communication</option>
                        <option value="Enchantment">Enchantment</option>
                        <option value="Healing">Healing</option>
                        <option value="Knowledge">Knowledge</option>
                        <option value="LightDarkness">Light & Darkness</option>
                        <option value="MindControl">Mind Control</option>
                        <option value="Movement">Movement</option>
                        <option value="Necromantic">Necromantic</option>
                        <option value="ProtectionWarning">Protection & Warning</option>
                      </select>
                      College
                    </td>
                  </tr>
                </tbody>
              </table>

            </fieldset>

          </div><!-- .fieldsetWrapper -->

          <div id="selectedSkillPrereqs" class="dialogSubTable"></div>

          <input type="submit" class="controls" value="Close" style="float:left;"                           onclick="document.getElementById('selectSkillDialog').style.display='none'; return false;" />
          <button id="selectSkillSubmit"                      style="float:right; width:auto; margin:1em;" onclick="loadSkillFromDialog(); return false;">Take this skill</button>

        </div><!-- #skillsDialogExtras -->

      </form>

    </div>

    <div id="defineTechniqueDialog" class="dialog">

      <form method="post" id="defineTechniqueForm" name="defineTechniqueForm">

        <div class="titlebar">Define a Technique (ne'e Maneuver)</div>

        <div id="defineTechniqueBody" class="dialogBody" style="margin-top:1em;">

          <table class="prefsTable">
            <colgroup>
              <col style="width:9em;" />
            </colgroup>
            <tbody>
              <tr>
                <th>Technique&nbsp;name&emsp;</th>
                <td>
                  <input id="techniqueName" name="techniqueName" type="text" style="width:100%;"
                         onchange="showTechniqueInfoInWindow(this.form)"
                          onkeyup="showTechniqueInfoInWindow(this.form)" />
                </td>
              </tr>
              <tr title="Skill on which this technique is based">
                <th style="vertical-align:bottom;">Default from&emsp;</th>
                <td rowspan="2">
                  <select id="selectTechniqueDefaultSkillMenu" name="techniqueDefaultSkill" size="5" style="width:100%;"
                          onchange="showTechniqueInfoInWindow(this.form)">
                  </select>
                </td>
              </tr>
              <tr>
                <th style="vertical-align:top;">
                  at
                  <select id="defineTechniqueDefaultPenalty" name="techniqueDefaultPenalty" style="width:40px; text-align:right;">
                    <option value="2">+2</option>
                    <option value="1">+1</option>
                    <option value="0" selected="selected">+0</option>
                    <option value="-1">-1</option>
                    <option value="-2">-2</option>
                    <option value="-3">-3</option>
                    <option value="-4">-4</option>
                    <option value="-5">-5</option>
                    <option value="-6">-6</option>
                    <option value="-7">-7</option>
                    <option value="-8">-8</option>
                    <option value="-9">-9</option>
                  </select>
                  &ensp;
                </th>
              </tr>
              <tr>
                <th>Difficulty&emsp;</th>
                <td>
                  <label>
                    <input name="techniqueDifficulty" id="techniqueDifficultyAverage" value="1" type="radio" checked="checked" />
                    Average
                  </label>
                </td>
              </tr>
              <tr>
                <th></th>
                <td>
                  <label>
                    <input name="techniqueDifficulty" id="techniqueDifficultyHard" value="2" type="radio" />
                    Hard
                  </label>
                </td>
              </tr>
              <tr>
                <th>Cost table&emsp;</th>
                <td title="See 'GURPS Compendium' (I, 3rd ed), p162">
                  <label>
                    <input name="techniqueCostTable" id="maneuver3eCostTable" value="M" type="radio" />
                    3<sup>rd</sup> edition (Maneuver) rules
                  </label>
                </td>
              </tr>
              <tr>
                <th></th>
                <td title="See 'GURPS (4th ed) Basic Set - Characters', p230">
                  <label>
                    <input name="techniqueCostTable" id="technique4eCostTable" value="T" type="radio" />
                    4<sup>th</sup> edition (Technique) rules
                  </label>
                </td>
              </tr>
            </tbody>
          </table>


          <fieldset>
            <legend onclick="toggleFieldset2(document.getElementById('techniqueOptionsToggleButton'),'techniqueOptionsTable')" style="cursor:pointer;">
              <img id="techniqueOptionsToggleButton" src="../images/plus_blue.gif" />
              Options
            </legend>

            <table id="techniqueOptionsTable" class="prefsTable" style="display:none; width:100%;">
              <colgroup>
                <col />
                <col />
              </colgroup>
              <tbody>
                <tr>
                  <th style="text-align:left; width:10em;">
                    <label>
                      <input name="techniqueSpecChbox" type="checkbox" onChange="var td=document.getElementById('techniqueSpecializationWrapper'); if(this.checked){td.style.visibility='visible';} else{td.style.visibility='hidden';} " />
                      Specialization&emsp;
                    </label>
                  </th>
                  <td id="techniqueSpecializationWrapper" style="visibility:hidden;">
                    <!--<input id="techniqueSpecialization" name="techniqueSpecialization" type="text" style="width:100%;" />-->
                    <span style="font-size:10px; white-space:normal; line-height:12px;">
                      Base skill will be shown in parentheses after name.
                      Check if Maneuver/Technique can be based on more than one skill.
                    </span>
                  </td>
                </tr>
  <!--  There are NO examples of techniques with multiple prerequisites in the corpus; only allusions that GMs could do that.
        So 'prerequisite' here is just another term for 'base skill', and there is no need to ask about it separately.
                <tr>
                  <th style="text-align:left;">
                    <label>
                      <input name="techniquePrereqChbox" type="checkbox" onChange="var div=document.getElementById('techniquePrerequisiteWrapper'); if(this.checked){div.style.visibility='visible';} else{div.style.visibility='hidden';} " />
                      Prerequisite&emsp;
                    </label>
                  </th>
                  <td id="techniquePrerequisiteWrapper" style="visibility:hidden;">
                    <input id="techniquePrerequisite" name="techniquePrerequisite" type="text" style="width:100%;" />
                  </td>
                </tr>
  -->
                <tr>
                  <th style="text-align:left;">
                    <label>
                      <input name="techniqueBonusChbox" type="checkbox" onChange="var td=document.getElementById('techniqueBonus'); if(this.checked){td.style.visibility='visible';} else{td.style.visibility='hidden';} " />
                      Maximum&emsp;
                    </label>
                  </th>
                  <td id="techniqueBonus" style="visibility:hidden;">
                    <span id="techniqueDefaultFromName">parent skill</span>
                    <select name="techniqueMaxIncrease" style="width:50px; text-align:right;">
                      <option value="-2">-2</option>
                      <option value="-1">-1</option>
                      <option value="0" selected="selected">+0</option>
                      <option value="1">+1</option>
                      <option value="2">+2</option>
                      <option value="3">+3</option>
                      <option value="4">+4</option>
                      <option value="5">+5</option>
                    </select>
                  </td>
                </tr>
                <tr>
                  <th style="text-align:left; vertical-align:top;">
                    <label>
                      <input name="techniqueDescChbox" type="checkbox" onChange="var td=document.getElementById('techniqueDescriptionWrapper'); if(this.checked){td.style.visibility='visible';} else{td.style.visibility='hidden';} " />
                      Description&emsp;
                    </label>
                  </th>
                  <td id="techniqueDescriptionWrapper" style="visibility:hidden;">
                    <textarea id="techniqueDescription" name="techniqueDescription" type="text" style="width:99%;" ></textarea>
                  </td>
                </tr>
              </tbody>
            </table>

          </fieldset>

        </div>

        <input  id="defineTechniqueClose"  style="float: left; width:auto; margin:1em;" onClick="document.getElementById('defineTechniqueDialog').style.display='none'; return false;" type="submit" value="Close" />
        <button id="defineTechniqueSubmit" style="float:right; width:auto; margin:1em;" onclick="attachTechniqueToCharacter(this.form); return false;">Add <em id="TechniqueSubmitName"></em>&ensp;Technique</button>

      </form>

    </div>

    <!-- - - - - - -->

    <div id="languagesDialog" class="dialog" style="width:420px;">

      <form method="post" id="languagesForm" name="languagesForm">

        <div class="titlebar"><span id="languagesDialogTitlebarVerb">Choose</span> Language</div>

        <div class="dialogBody" style="margin-top:1em;">

          <select id="selectLanguageMenu" name="selectLanguageMenu" size="5" style="width:100%;" onchange="/*alert('selectLanguageMenu');*/languageInfo(this.value)">
          </select>

          <table class="prefsTable">
            <tbody>
              <tr style="line-height:30px;">
                <th style="text-align:left;">
                  <input id="native" name="native" type="checkbox" onclick="/*alert('native');*/languageInfo()" />
                  <label id="nativeLabel" for="native">&ensp;<span id="language_name">This</span> is <span id="languages_charname">your character</span>'s native language</label>
                </th>
              </tr>
            </tbody>
          </table>

          <!-- below are the 'custom' language form elements -->

          <fieldset style="padding: 0 0 0 0.5em;">

            <legend onclick="toggleFieldset2(document.getElementById('customLanguagesToggleButton'),'customLanguageSubform')">
                <img id="customLanguagesToggleButton" src="../images/minus_blue.gif" />
                Language Options
            </legend>

            <div id="customLanguageSubform" style="font-size:9pt; ">

                <table class="prefsTable" style="">
                  <colgroup>
                    <col />
                    <col />
                  </colgroup>
                  <tbody>
                    <tr>
                      <th>Language&nbsp;name&emsp;</th>
                      <td style="text-align:left;">
                        <input id="customLanguageName" name="customLanguageName" style="width:96%;" onkeyup="/*alert('customLanguageName');languageInfo()*/this.form.languageSubmit.innerHTML='Take <i>'+this.value+'</i>';document.getElementById('language_name').innerHTML='<i>'+this.value+'</i>';" />
                      </td>
                    </tr>
                    <tr style="line-height:5px;">
                      <td>&nbsp;</td>
                    </tr>
                    <tr>
                      <th>Language&nbsp;is&emsp;</th>
                      <td style="text-align:left;">
                        <select id="languageImplementation" name="languageImplementation" disabled="disabled" style="width:100%;" onChange="/*alert('languageImplementation (has to call languageInfo() so that the difficulty inputs will change)');*/languageInfo()">
                          <option value="3" >a skill (3<sup>rd</sup> edition rules)</option>
                          <option value="4" >an advantage (4<sup>th</sup> edition rules)</option>
                        </select>
                      </td>
                    </tr>
                    <tr id="3e_language_options" style="line-height:32px; display:none;">
                      <th>Language&nbsp;difficulty&emsp;</th>
                      <td>
                        <select id="languageDifficulty" name="languageDifficulty">
                          <option value="0">easy</option>
                          <option value="1" selected="selected">average</option>
                          <option value="2">hard</option>
                          <option value="3">very hard</option>
                        </select>
                      </td>
                    </tr>
                    <tr id="4e_language_options" style="line-height:32px;">
                      <th>Language&nbsp;comprehension&emsp;</th>
                      <td>
                        <table>
                          <colgroup>
                            <col style="width:50%;" />
                            <col />
                          </colgroup>
                          <tbody>
                            <tr style="line-height:12px; font-variant:small-caps">
                              <td style="text-align:center;">Spoken</td>
                              <td style="text-align:center;" id="languageWrittenMenuLabel">Written</td>
                            </tr>
                            <tr>
                              <td style="text-align:center;">
                                <select id="SpokenComp" name="SpokenComp" onchange="synchWritten(this.value)">
                                  <option value="0">[none]</option>
                                  <option value="1">broken</option>
                                  <option value="2" selected="selected">accented</option>
                                  <option value="3">'native'</option>
                                </select>
                              </td>
                              <td style="text-align:center;">
                                <select id="WrittenComp" name="WrittenComp">
                                  <option value="0">[illiterate]</option>
                                  <option value="1">semi-literate</option>
                                  <option value="2" selected="selected">literate</option>
                                  <option value="3">'native'</option>
                                </select>
                              </td>
                            </tr>
                          </tbody>
                        </table>
                      </td>
                    </tr>
                    <tr id="adLanguagePointsNotice" style="line-height:10px; font-size:10px;">
                      <td colspan="2" style="text-align:center;">(1 point/level each)</td>
                    </tr>
                  </tbody>
                </table>

            </div>

          </fieldset>

          <input  id="languageNewOrEdit" type="hidden" value="new" />
          <input  id="languageClose" type="submit" value="Close" style="float: left; width:auto; margin:1em;" onClick="document.getElementById('languagesDialog').style.display='none'; return false;" />
          <button id="languageSubmit"                            style="float:right; width:auto; margin:1em;" onClick="loadLanguage(this.form); return false;">Take this language</button>

        </div>

      </form>

    </div>

    <div id="specifyCulturesDialog" class="dialog">

      <form method="post" id="specifyCulturesForm" name="specifyCulturesForm">

        <div class="titlebar">Cultural Familiarities</div>

        <div class="dialogBody" style="margin-top:1em;">

          <div id="selectCultureMenuWrapper" style="display:block">
            <select id="selectCultureMenu" name="selectCultureMenu" size="6" style="width:100%;" onchange="showCultureInfo()" onfocus="showCultureInfo()">
            </select>
          </div>

          <table class="prefsTable">
            <tbody>
              <tr>
                <th style="text-align:left;">or specify a culture&emsp;</th>
              </tr>
              <tr>
                <td><input id="customCultureName" name="customCultureName" style="width:100%;" onkeyup="showCultureInfo()" onchange="showCultureInfo()" onfocus="showCultureInfo()" /></td>
              </tr>
            </tbody>
          </table>

          <table class="prefsTable">
            <tbody>
              <tr style="line-height:30px;">
                <th style="text-align:left;">
                  <input id="nativeCulture" name="native" type="checkbox" checked="checked" onchange="showCultureInfo()" />
                  <label id="nativeCultureLabel" for="nativeCulture">&ensp;This is <span id="charname">your character</span>'s native culture</label>
                </th>
              </tr>
            </tbody>
          </table>

          <table class="prefsTable" id="cultureSimilarity">
            <tbody>
              <tr>
                <th>Culture is&emsp;</th>
                <td><input name="cultureDissimilarity" id="foreign" type="radio" value="1" checked="checked" /><label for="foreign"> foreign (1 point)</label></td>
              </tr>
              <tr>
                <th></th>
                <td><input name="cultureDissimilarity" id="alien" type="radio" value="2" /><label for="alien"> completely alien (2 points)</label></td>
              </tr>
            </tbody>
          </table>

        </div>

        <input id="cultureFormSource" type="hidden" />

        <input id="specifyCultureClose"  type="submit" value="Done"              style="float: left; width:auto; margin:1em;" onClick="document.getElementById('specifyCulturesDialog').style.display='none'; return false;" />
        <button id="specifyCultureSubmit"                                        style="float:right; width:auto; margin:1em;" onClick="loadCulture(this.form); return false;">Take this language</button>

      </form>

    </div>

    <!-- - - - - - -->

    <div id="chooseTemplateDialog" class="dialog">
  
      <form method="post" id="chooseTemplateForm" name="chooseTemplateForm">

        <div class="titlebar">Use a Template</div>

        <div id="chooseTemplateMenuWrapper" style="padding:1em; display:block">
          <select id="chooseTemplateMenu" name="chooseTemplateMenu" size="9" style="width:100%;" onchange="showTemplateInfo()">
          </select>
        </div>

        <button id="chooseTemplateClose"  style="float:left;  width:auto; margin:1em;" onClick="document.getElementById('chooseTemplateDialog').style.display='none'; return false;">Done</button>
        <button id="chooseTemplateSubmit" style="float:right; width:auto; margin:1em;" onClick="applyTemplate(this.form.chooseTemplateMenu.value); return false;">apply this template</button>

      </form>

    </div>


  <!-- Equip menu -->
    <div id="selectEquipmentDialog" class="dialog" style="width:360px;">

      <form method="post">

        <div class="titlebar">Select Basic Equipment</div>
        <div id="selectEquipmentDialogExtras" style="padding:0 1em; font-size:10pt; text-align:center;">
          <div id="selectEquipmentSortWrapper" style="float:right; font-size:9pt;">
            Sort by:
            <select id="selectEquipmentSort" style="font-size:9px;" onchange="selectEquipmentDialog(this.value)">
              <option value="name">name</option>
              <option value="cost">cost</option>
              <option value="weight">weight</option>
              <option value="TL">tech level</option>
              <option value="LC">leg. class</option>
            </select>
          </div>
          <div style="width:21em; padding:2px; font-size:10px; text-align:left;">
            To see only equipment from Tech Levels at or below that of the character,
            uncheck the Tech Level filter below.
          </div>
          <select id="selectEquipmentMenu" size="9" style="width: 100%;" onchange="showEquipmentInfoInDialog(this.value);">
          </select>
          <div style="height:22px; text-align:left;">
            <div style="float:left; padding: 2px 0pt 0pt;">How many: <input id="selectEquipmentAmount" value="1" style="width:4em;" /></div>
            <div id="displayEquipmentWeight" style="float:left; padding: 2px 0pt 0pt 8em;">&nbsp;</div>
            <div id="displayEquipmentCost"   style="float:right; padding: 2px 0pt 0pt;">&nbsp;</div>
          </div>
        </div>

        <div style="padding:0pt; clear:both;"></div>

        <div style="font-size: 9pt; padding: 8pt 1em 0;">

          <fieldset style="padding: 0pt;" title="If this section is open, custom information entered here will be used to create a new equipment item and attach it to the character.">

            <legend onclick="toggleFieldset2(document.getElementById('customEquipmentToggleButton'),'customEquipmentTable')" style="cursor:pointer;">
              <img id="customEquipmentToggleButton" src="../images/plus_blue.gif" />
              Custom Equipment
            </legend>

            <table id="customEquipmentTable" style="font-size:8pt; display:none;">
              <colgroup><!-- widths here seem to have no effect on this table, for some reason -->
                <col />
                <col style="width: 4em;" />
                <col style="width: 5em;" />
                <col />
              </colgroup>
              <tbody>
                <tr>
                  <th style="text-align:right;">Name&emsp;</th>
                  <td colspan="3">
                    <input id="customEquipmentItemName" name="customEquipmentItemName" style="width:98%;"
                           onchange="document.getElementById('selectEquipmentSubmitName').innerHTML=this.value; document.getElementById('selectEquipmentSubmit').disabled=(this.value)?null:'disabled'"
                            onkeyup="document.getElementById('selectEquipmentSubmitName').innerHTML=this.value; document.getElementById('selectEquipmentSubmit').disabled=(this.value)?null:'disabled'" />
                  </td>
                </tr>
                <tr>
                  <th style="text-align:right;">Description&emsp;</th>
                  <td colspan="3">
                    <input id="customEquipmentItemDescription" name="customEquipmentItemDescription" style="width:98%;" placeholder="this is optional" />
                  </td>
                </tr>
                <tr>
                  <th style="text-align:right;">Weight&emsp;</th>
                  <td>
                    <input id="customEquipmentItemWeight" name="customEquipmentItemWeight" style="width:4em;" />
                    <span id="customEquipmentItemWeightUnit" name="customEquipmentItemWeightUnit">lbs</span>
                  </td>
                  <th style="text-align:right;">Cost&nbsp;&nbsp;$</th>
                  <th style="text-align:right">
                    <input id="customEquipmentItemCost" name="customEquipmentItemCost" style="width:5em;" />
                    &plus;
                    $<input id="customEquipmentItemAddedCost" name="customEquipmentItemAddedCost" style="width:5em;" placeholder="optional" title="adds for expensive materials, etc.; negatives for age, damage, etc." />
                  </th>
                </tr>
                <tr>
                  <th style="text-align:right;" title="Tech Level (see 3rd ed., page 185 or 4th ed., page B22)">&emsp;TL&emsp;</th>
                  <td>
                    <select id="customEquipmentItemTL" name="customEquipmentItemTL" style="width:100%;" title="Tech Level (see 3rd ed., page 185 or 4th ed., page B22)">
                    </select>
                  </td>
                  <th style="text-align:right;" title="Legality Class (see 4th ed., page B267)">LC&emsp;</th>
                  <td>
                    <select id="customEquipmentItemLC" name="customEquipmentItemLC" style="" title="Legality Class (see 4th ed., page B267)">
                    </select>
                  </td>
                </tr>
              </tbody>
            </table>

          </fieldset>

        </div>

        <div style="font-size:9pt; padding: 0pt 1em;">
          <fieldset style="padding:0pt;">
            <legend onclick="toggleFieldset2(document.getElementById('equipmentFiltersToggleButton'),'equipmentFiltersTable')" style="cursor:pointer;">
              <img id="equipmentFiltersToggleButton" src="../images/plus_blue.gif" />
              Filters
            </legend>
            <table id="equipmentFiltersTable" style="display: none;">
              <tbody><tr>
                <td style="text-align:right;"><label for="equipmentDialogAllTLCheckbox">Show equipment from all Tech Levels</label></td>
                <td style="text-align:right;">
                  <input id="equipmentDialogAllTLCheckbox" name="allTLCheckbox" checked="checked" onchange="selectEquipmentDialog();" type="checkbox" />
                </td>
              </tr>
            </tbody></table>
          </fieldset>
        </div>

        <div style="clear: both;"></div>
        <button type="submit" style="float:left; width: auto; margin: 1em;" onclick="document.getElementById('selectEquipmentDialog').style.display='none'; return false;">Close</button>
        <button id="selectEquipmentSubmit" type="button" disabled="disabled" style="float:right; width: auto;" onclick="loadBasicEquipmentFromDialog();">
          take <span id="selectEquipmentSubmitName" style="max-width:15em; text-overflow:ellipsis">this equipment</span> item
        </button>

      </form>

    </div>

    <div id="selectWeaponDialog" class="dialog" style="min-width:420px;">

      <form method="post">

        <div class="titlebar">Select Weapon</div>

        <div id="selectWeaponDialogExtras" style="padding: 0 1em; text-align:center; font-size:10pt;">

          <div id="displayWeaponWieldOptionSkillKey" style="float:left; text-align:left; padding-top:4px; font-size:11px;"></div>
          <div id="selectWeaponSortWrapper" class="dialogSortWrapper" style="font-size:12px;">
            Sort list by:
            <select id="selectWeaponSort" onchange="selectWeaponDialog(this.value)">
              <option value="name">name</option>
              <option value="cost">cost</option>
              <option value="weight">weight</option>
              <option value="TL">tech level</option>
              <option value="LC">legality class</option>
              <option value="qualityEffectGroup">quality group</option>
            </select>
          </div>
          <select id="selectWeaponMenu" size="6" style="width:100%;" onchange="showWeaponInfoInDialog(this.value);">
          </select>
          <div style="height:1.5em;">
            <div id="displayWeaponWeight" style="float:left; padding: 2px 0pt 0pt;">&nbsp;</div>
            <div id="displayWeaponCost" style="float:right; padding: 2px 0pt 0pt;">&nbsp;</div>
            <div id="displayWeaponDamage" style="padding: 2px 0pt 0pt;">&nbsp;</div>
          </div>
          <div id="selectWeaponAmountWrapper" style="clear:both; float:left; text-align:left;">
            How many: <input id="selectWeaponAmount" value="1" style="width:4em;" />
          </div>
          <div id="displayWeaponSTmenu" style="float:right; text-align:left; visibility:hidden;">
            Specify a weapon ST:
            <select id="selectWeaponST" style="width:4em;">
            </select>
          </div>
          <div id="displayWeaponQualitymenu" style="clear:both; float:left; text-align:left; padding: 4px 0;">
            Select weapon quality:
            <select id="selectWeaponQuality" onchange="showWeaponInfoInDialog()">
              <option value="0">cheap</option>
              <option value="1" selected="selected">good</option>
              <option value="2">fine</option>
              <option value="3">very fine</option>
            </select>
          </div>
        </div>

        <div style="padding:0pt; clear:both;"></div>

        <div style="font-size: 9pt; padding: 0pt 1em;">
          <fieldset style="padding: 0pt;" >
            <legend onclick="var box=document.getElementById('selectWeaponDialog'); box.style.minWidth=(box.style.minWidth=='420px')?'530px':'420px'; toggleFieldset2(document.getElementById('customWeaponToggleButton'),'customWeaponTable')" style="cursor:pointer;">
              <img id="customWeaponToggleButton" src="../images/plus_blue.gif" />
              Custom Weapon
            </legend>
            <div style="font-size:10px; text-align:center; padding:0px; width:100%;">
              If this section is open, stats entered here<br />
              will be used to create a custom weapon.
            </div>
            <table id="customWeaponTable" style="font-size:8pt; display:none;">
              <tbody style="width:100%;">
                <tr>
                  <th style="text-align:right;">Name&emsp;</th>
                  <td>
                    <input id="customWeaponItemName" name="customWeaponItemName" style="width:100%;"
                           onkeyup="var button=this.form.selectWeaponSubmit; button.disabled=null; button.value='take '+this.value" />
                  </td>
                  <th style="text-align:right;">&ensp;Weight&emsp;</th>
                  <td>
                    <input id="customWeaponItemWeight" name="customWeaponItemWeight" style="width:4em;" />
                    <span id="customWeaponItemWeightUnit">lbs</span>
                  </td>
                </tr>
                <tr>
                  <th style="text-align:right;" title="see Weapon Quality (3rd ed., page 74 sidebar; 4th ed., page B274, B277, B280)">Quality Group&emsp;</th>
                  <td>
                    <select id="customWeaponItemQualGp" name="customWeaponItemQualGp" title="see Weapon Quality (3rd ed., page 74 sidebar; 4th ed., page B274, B277, B280)">
                    </select>
                  </td>
                  <th style="text-align:right;">Cost&ensp;$</th>
                  <td>
                    <input id="customWeaponItemCost" name="customWeaponItemCost" style="width:4em;" />
                    &plus;
                    <b>$</b><input id="customWeaponItemAddedCost" name="customWeaponItemAddedCost" style="width:4em;" />
                  </td>
                </tr>
                <tr>
                  <th style="text-align:right;">Description&emsp;</th>
                  <td colspan="3">
                    <input id="customWeaponItemDescription" name="customWeaponItemDescription" style="width:90%;" placeholder="this is optional" />
                  </td>
                </tr>
                <tr>
                  <th style="text-align:right;" title="Tech Level (see 3rd ed., page 185 or 4th ed., page B22)">Tech&nbsp;Level&emsp;</th>
                  <td>
                    <select id="customWeaponItemTL" name="customWeaponItemTL" title="Tech Level (see 3rd ed., page 185 or 4th ed., page B22)">
                    </select>
                  </td>
                  <th style="text-align:right;" title="Legality Class (see 4th ed., page B267)">Legality&nbsp;Class&emsp;</th>
                  <td>
                    <select id="customWeaponItemLC" name="customWeaponItemLC" title="Legality Class (see 4th ed., page B267)">
                    </select>
                  </td>
                </tr>
                <tr><!-- This row only applies to ranged weapons (although I have defined 'bulk' for a number of melee weapons). -->
                  <th style="text-align:right;" title="Bulk; measures weapon size and 'handiness' (4th ed., page B270)">Bulk&emsp;</th>
                  <td>
                    <select id="customWeaponItemBulk" name="customWeaponItemBulk" style="width:auto;" title="Bulk; measures weapon size and 'handiness' (4th ed., page B270)">
                    </select>
                  </td>
                  <th style="text-align:right;" title="see 3rd ed., page 208; 4th ed., page B270)">Shots&emsp;</th>
                  <td><input id="customWeaponItemShots" name="customWeaponItemShots" style="width:4em;" /></td>
                </tr>
                <!-- weaponST, shots inputs? -->
                <tr>
                  <td colspan="4">
                    <fieldset>
                      <legend>Attack Options</legend>
                      <button onclick="addNewAttackOptionRow(this.form.customWeaponItemAttackOptionSkillsMenu.value,1*this.form.attackOptionRows.value+1,null,this.form.customWeaponItemAttackOptionAttackTypeMenu.value); return false;">Add</button>new
                      <select id="customWeaponItemAttackOptionAttackTypeMenu"><option value="melee">melee</option><option value="ranged">ranged</option></select>
                      attack option using attack skill
                      <select id="customWeaponItemAttackOptionSkillsMenu" name="customWeaponItemAttackOptionSkillsMenu" style="width:12em;"
                              title="Select an attack skill; an 'attack option' form row will appear.">
                      </select>
                      <table id="customWeaponAttackOptionsTable" style="width:480px; padding-bottom:1em; display:none; overflow:auto;">
                      </table>
                      <input type="hidden" id="attackOptionRows" name="attackOptionRows" value="0" />
                    </fieldset>
                  </td>
                </tr>
              </tbody>
            </table>
          </fieldset>
        </div>

        <div style="padding: 0pt; clear: both;"></div>

        <div style="font-size: 9pt; padding: 0pt 1em;">
          <fieldset style="padding: 0pt;">
            <legend onclick="toggleFieldset2(document.getElementById('WeaponFiltersToggleButton'),'WeaponFiltersTable')" style="cursor:pointer;">
              <img id="WeaponFiltersToggleButton" src="../images/plus_blue.gif" />
              Filters
            </legend>
            <table id="WeaponFiltersTable" style="font-size:8pt; display:none;">
              <tbody>
                <tr>
                  <td style="text-align:right;">Hand/Ranged: show&nbsp;</td>
                  <td>
                    <select id="WeaponDialogTypeFilter" name="WeaponDialogTypeFilter" onchange="selectWeaponDialog();">
                      <option value="all">all</option>
                      <option value="hand">hand</option>
                      <option value="ranged">ranged</option>
                    </select>
                    weapons
                  </td>
                </tr>
                <tr>
                  <td style="text-align:right;">Weapon 'quality' groups: show&nbsp;</td>
                  <td>
                    <select id="WeaponDialogGroupFilter" name="WeaponDialogGroupFilter" onchange="selectWeaponDialog(null,this.value);">
                      <option value="all">all</option>
                      <option value="">other</option>
                      <option value="blade">blades</option>
                      <option value="cut">cutting non-blade</option>
                      <option value="cr/imp">crushing or impaling</option>
                      <option value="bow">muscle-powered ranged</option>
                      <option value="gun">firearms</option>
                    </select>
                    weapons
                  </td>
                </tr>
                <tr>
                  <td style="text-align:right;"><label for="WeaponDialogAllTLCheckbox">Show weapons from all Tech Levels </label></td>
                  <td><input id="WeaponDialogAllTLCheckbox" name="allTLCheckbox" checked="checked" onchange="selectWeaponDialog();" type="checkbox" /></td>
                </tr>
                <tr>
                  <td style="text-align:right;"><label for="WeaponDialogSTreqCheckbox">Show weapons w/ ST req &le; character ST </label></td>
                  <td><input id="WeaponDialogSTreqCheckbox" name="STreqCheckbox" onchange="selectWeaponDialog();" type="checkbox" /></td>
                </tr>
              </tbody>
            </table>
          </fieldset>
        </div>

        <div style="clear: both;"></div>

        <input id="weaponLabel" name="weaponLabel" value="" type="hidden" />
        <button type="submit" style="float:left; width: auto; margin: 1em;" onclick="document.getElementById('selectWeaponDialog').style.display='none'; return false;">Close</button>
        <button id="selectWeaponSubmit" type="button"         style="float:right; width: auto;" disabled="disabled" onclick="loadWeaponFromDialog(); return false;">
          take <span id="selectWeaponSubmitName" style="max-width:15em; text-overflow:ellipsis">this weapon</span> item
        </button>

      </form>

    </div>

    <div id="selectArmorDialog" class="dialog">
      <form method="post" id="selectArmorForm" name="selectArmorForm">
        <div class="titlebar">Select Armor</div>
        <div id="selectArmorDialogExtras" style="padding: 0 1em; font-size: 10pt; text-align:center;">
         <!--
          <div style="padding: 2px; font-size: 10px; text-align:left;">
            To see armor from Tech Levels above that of the character,
            uncheck the Tech Level filter below.
          </div>
         -->
          <div id="selectArmorSortWrapper" class="dialogSortWrapper" style="float:right; text-align:left;">
            Sort list by:
            <select id="selectArmorSort" onchange="selectArmorDialog(this.value)">
              <option value="name">name</option>
              <option value="cost">cost</option>
              <option value="weight">weight</option>
              <option value="TL">tech level</option>
              <option value="DR">DR</option>
            </select>
          </div>
          <select id="selectArmorMenu" size="9" style="width: 100%;" onchange="showArmorInfoInDialog(this.value);">
          </select>
          <div style="height:56px;">
            <div id="displayArmorWeight" style="float:left; padding: 2px 0pt 0pt;">&nbsp;</div>
            <div id="displayArmorCost"   style="float:right; padding: 2px 0pt 0pt;">&nbsp;</div>
            <div id="displayArmorDR"     style="padding: 2px 0pt 0pt;">&nbsp;</div>
            <div id="displayCoverage"    style="clear:both; text-align:left; font-size:9pt; padding-top:2px; width:350px;">&nbsp;</div>
          </div>
          <div id="selectArmorAmountWrapper" style="clear:both; float:left; text-align:left;">
            How many: <input id="selectArmorAmount" value="1" style="width:4em;" />
          </div>
        </div>
        <div style="padding: 0pt; clear: both;"></div>
        <style>
          #customArmorTable td {padding: 1px}
        </style>
        <div style="font-size: 9pt; padding: 0pt 1em;">
          <fieldset style="padding: 0pt;">
            <legend onclick="toggleFieldset2(document.getElementById('customArmorToggleButton'),'customArmorTable')" style="cursor:pointer;">
              <img id="customArmorToggleButton" src="../images/plus_blue.gif" />
              Custom Armor
            </legend>
            <table id="customArmorTable" style="display:none;">
                <colgroup>
                  <col />
                  <col />
                  <col />
                  <col style="width:5em;" />
                  <col />
                  <col />
                </colgroup>
              <tbody>
                <tr>
                  <th style="text-align:right;" colspan="2">Name&emsp;</th>
                  <td colspan="4">
                    <input id="customArmorDialogName" name="customArmorDialogName" style="width:95%;"
                           onkeyup="this.form.selectArmorSubmit.value='take '+this.value" />
                  </td>
                </tr>
                <tr>
                  <th style="text-align:right;" colspan="2">Description&emsp;</th>
                  <td colspan="4">
                    <input id="customArmorDialogDescription" name="customArmorDialogDescription" style="width:95%;" placeholder="this is optional" />
                  </td>
                </tr>
                <tr>
                  <th style="text-align:right;" colspan="2">Cost&ensp;$</th>
                  <td colspan="2">
                    <input id="customArmorDialogCost" name="customArmorDialogCost" style="width:3em;" />
                    &plus;
                    <b>$</b><input id="customArmorDialogAddedCost" name="customArmorDialogAddedCost" style="width:3em;" title="added (or subtracted) cost for decoration, condition, rarity, etc." />
                  </td>
                  <th style="text-align:right;">Weight&emsp;</th>
                  <td>
                    <input id="customArmorDialogWeight" name="customArmorDialogWeight" style="width:3em; text-align:right;" />
                    <span id="customArmorWeightUnit" name="customArmorWeightUnit">lbs</span>
                  </td>
                </tr>


                <tr id="customArmorDialogPDrow">
                  <th style="text-align:right;" colspan="2">Passive&nbsp;Defense&emsp;</th>
                  <td><input id="customArmorDialogPD" name="customArmorDialogPD" style="text-align:center; width:3em;" /></td>
                  <th id="customArmorDialogsplitPDcell" style="text-align:left; display:none;" title="Split PD">
                    / <input id="customArmorDialogsplitPD" name="customArmorDialogsplitPD" style="text-align:center; width:3em;" />
                  </th>
                </tr>
                <tr>
                  <th style="text-align:right;" colspan="2">Damage&nbsp;Resistance&emsp;</th>
                  <td><input id="customArmorDialogDR" name="customArmorDialogDR" style="text-align:center;width:3em;" /></td>
                  <th id="customArmorDialogsplitDRcell" style="text-align:left; display:none;" title="Split DR">
                    / <input id="customArmorDialogsplitDR" name="customArmorDialogsplitDR" style="text-align:center;width:3em;" />
                  </th>
                </tr>


                <tr>
                  <th style="text-align:right;" colspan="2">Layering&emsp;</th>
                  <td colspan="4">
                    <input id="customArmorDialoglayerableCB" name="customArmorDialoglayerableCB" value="layerable" type="checkbox" />
                    can wear under clothing / armor
                  </td>
                </tr>
                <tr><th style="text-align:right;" colspan="2">Coverage&emsp;</th></tr>
                <tr>
                  <td></td>
                  <td></td>
                  <td style="text-align:right;">skull</td>
                  <td style="text-align:left;">
                    <input id="customArmorDialogskullCB" name="customArmorDialogskullCB" value="skull" type="checkbox" />
                  </td>
                  <td style="text-align:right;">
                    <input id="customArmorDialogsuitCB" name="customArmorDialogsuitCB" value="suit" type="checkbox"
                            onchange="/* toggle all the 'body' checkboxes */" />
                  </td>
                  <td style="text-align:left;">full suit</td>
                </tr>
                <tr>
                  <td></td>
                  <td></td>
                  <td style="text-align:right;">eyes</td>
                  <td style="text-align:left;">
                    <input id="customArmorDialogeyesCB" name="customArmorDialogeyesCB" value="eyes" type="checkbox" />
                  </td>
                  <td></td>
                  <td></td>
                </tr>
                <tr>
                  <td></td>
                  <td></td>
                  <td style="text-align:right;">face</td>
                  <td style="text-align:left;">
                    <input id="customArmorDialogfaceCB" name="customArmorDialogfaceCB" value="face" type="checkbox" />
                  </td>
                  <td></td>
                  <td></td>
                </tr>
                <tr>
                  <td></td>
                  <td></td>
                  <td style="text-align:right;">neck</td>
                  <td style="text-align:left;">
                    <input id="customArmorDialogneckCB" name="customArmorDialogneckCB" value="neck" type="checkbox" />
                  </td>
                  <td></td>
                  <td></td>
                </tr>
                <tr>
                  <td style="text-align:right;">dom arm</td>
                  <td style="text-align:left;">
                    <input id="customArmorDialogdomArmCB" name="customArmorDialogdomArmCB" value="domArm" type="checkbox" />
                  </td>
                  <td style="text-align:right;">torso</td>
                  <td style="text-align:left;">
                    <input id="customArmorDialogtorsoCB" name="customArmorDialogtorsoCB" value="torso" type="checkbox" />
                  </td>
                  <td style="text-align:right;">
                    <input id="customArmorDialogoffArmCB" name="customArmorDialogoffArmCB" value="offArm" type="checkbox" />
                  </td>
                  <td style="text-align:left;">off arm</td>
                </tr>
                <tr>
                  <td style="text-align:right;">dom hand</td>
                  <td style="text-align:left;">
                    <input id="customArmorDialogdomHandCB" name="customArmorDialogdomHandCB" value="domHand" type="checkbox" />
                  </td>
                  <td style="text-align:right;">waist</td>
                  <td style="text-align:left;">
                    <input id="customArmorDialogwaistCB" name="customArmorDialogwaistCB" value="waist" type="checkbox" />
                  </td>
                  <td style="text-align:right;">
                    <input id="customArmorDialogoffHandCB" name="customArmorDialogoffHandCB" value="offHand" type="checkbox" />
                  </td>
                  <td style="text-align:left;">off hand</td>
                </tr>
                <tr>
                  <td></td>
                  <td></td>
                  <td style="text-align:right;">groin</td>
                  <td style="text-align:left;">
                    <input id="customArmorDialoggroinCB" name="customArmorDialoggroinCB" value="groin" type="checkbox" />
                  </td>
                  <td></td>
                  <td></td>
                </tr>
                <tr>
                  <td></td>
                  <td style="text-align:right;">dom leg</td>
                  <td style="text-align:left;">
                    <input id="customArmorDialogdomLegCB" name="customArmorDialogdomLegCB" value="domLeg" type="checkbox" />
                  </td>
                  <td style="text-align:right;">
                    <input id="customArmorDialogoffLegCB" name="customArmorDialogoffLegCB" value="offLeg" type="checkbox" />
                  </td>
                  <td colspan="2" style="text-align:left;">off leg</td>
                </tr>
                <tr>
                  <td></td>
                  <td style="text-align:right;">dom foot</td>
                  <td style="text-align:left;">
                    <input id="customArmorDialogdomFootCB" name="customArmorDialogdomFootCB" value="domFoot" type="checkbox" />
                  </td>
                  <td style="text-align:right;">
                    <input id="customArmorDialogoffFootCB" name="customArmorDialogoffFootCB" value="offFoot" type="checkbox" />
                  </td>
                  <td colspan="2" style="text-align:left;">off foot</td>
                </tr>
                <tr>
                  <th style="text-align:right;" title="Legality Class (see 4th ed., page B267)">LC&emsp;</th>
                  <td colspan="2">
                    <select id="customArmorDialogLC" name="customArmorDialogLC" style="width:8em;">
                    </select>
                  </td>
                  <th style="text-align:right;" title="Tech Level (see 3rd ed., page 185 or 4th ed., page B22)">TL&emsp;</th>
                  <td colspan="2">
                    <select id="customArmorDialogTL" name="customArmorDialogTL">
                    </select>
                  </td>
                </tr>

              </tbody>
            </table>
          </fieldset>
        </div>
        <div style="clear: both;"></div>
        <div style="font-size: 9pt; padding: 0pt 1em;">
          <fieldset style="padding: 0pt;">
            <legend onclick="toggleFieldset2(document.getElementById('armorFiltersToggleButton'),'armorFiltersTable')" style="cursor:pointer;">
              <img id="armorFiltersToggleButton" src="../images/plus_blue.gif" />
              Filters
            </legend>
            <table id="armorFiltersTable" style="display: none;">
              <tbody>
                <tr>
                  <td style="text-align:right;">&nbsp;</td>
                  <td style="text-align:right;">Show only armor from TL <span id="displayChArmorTL1"></span></td>
                  <td style="text-align:right;">
                    <input id="armorDialogSameTLradio" name="armorTLradio" onchange="selectArmorDialog();" type="radio" />
                  </td>
                </tr>
                <tr>
                  <td style="text-align:right;">&nbsp;</td>
                  <td style="text-align:right;">Show armor from TL <span id="displayChArmorTL2"></span> and lower</td>
                  <td style="text-align:right;">
                    <input id="armorDialogAvailableTLradio" name="armorTLradio" checked="checked" onchange="selectArmorDialog();" type="radio" />
                  </td>
                </tr>
                <tr>
                  <td style="text-align:right;">&nbsp;</td>
                  <td style="text-align:right;">Show armor from all Tech Levels</td>
                  <td style="text-align:right;">
                    <input id="armorDialogAllTLradio" name="armorTLradio" onchange="selectArmorDialog();" type="radio" />
                  </td>
                </tr>
                <tr><td style="text-align:right;">&nbsp;</td></tr>
                <tr>
                  <td style="text-align:right;">&nbsp;</td>
                  <td style="text-align:right;">head</td>
                  <td style="text-align:right;">
                    <input id="armorDialogHeadRadio" name="armorBodyPartRadioGroup" value="head" onchange="selectArmorDialog();" type="radio" />
                  </td>
                </tr>
                <tr>
                  <td style="text-align:right;" colspan="2">Show only armor that covers the body</td>
                  <td style="text-align:right;">
                    <input id="armorDialogBodyRadio" name="armorBodyPartRadioGroup" value="body" onchange="selectArmorDialog();" type="radio" />
                  </td>
                </tr>
                <tr>
                  <td style="text-align:right;">&nbsp;</td>
                  <td style="text-align:right;">arms</td>
                  <td style="text-align:right;">
                    <input id="armorDialogArmsRadio" name="armorBodyPartRadioGroup" value="arms" onchange="selectArmorDialog();" type="radio" />
                  </td>
                </tr>
                <tr>
                  <td style="text-align:right;">&nbsp;</td>
                  <td style="text-align:right;">legs</td>
                  <td style="text-align:right;">
                    <input id="armorDialogLegsRadio" name="armorBodyPartRadioGroup" value="legs" onchange="selectArmorDialog();" type="radio" />
                  </td>
                </tr>
                <tr>
                  <td style="text-align:right;">&nbsp;</td>
                  <td style="text-align:right;">hands</td>
                  <td style="text-align:right;">
                    <input id="armorDialogHandsRadio" name="armorBodyPartRadioGroup" value="hands" onchange="selectArmorDialog();" type="radio" />
                  </td>
                </tr>
                <tr>
                  <td style="text-align:right;">&nbsp;</td>
                  <td style="text-align:right;">feet</td>
                  <td style="text-align:right;">
                    <input id="armorDialogFeetRadio" name="armorBodyPartRadioGroup" value="feet" onchange="selectArmorDialog();" type="radio" />
                  </td>
                </tr>
                <tr>
                  <td style="text-align:right;" colspan="2">Show full-suit armor</td>
                  <td style="text-align:right;">
                    <input id="armorDialogSuitRadio" name="armorBodyPartRadioGroup" value="suit" onchange="selectArmorDialog();" type="radio" />
                  </td>
                </tr>
                <tr>
                  <td style="text-align:right;" colspan="2">Show armor covering any body part</td>
                  <td style="text-align:right;">
                    <input id="armorDialogTorsoRadio" name="armorBodyPartRadioGroup" value="all" onchange="selectArmorDialog();" type="radio" checked="checked" />
                  </td>
                </tr>
                <tr><td style="text-align:right;">&nbsp;</td></tr>
              </tbody>
            </table>
          </fieldset>
        </div>
        <div style="clear: both;"></div>
        <button style="float:left; width: auto; margin: 1em;" onclick="document.getElementById('selectArmorDialog').style.display='none'; return false;">Close</button>
        <button id="selectArmorSubmit" name="selectArmorSubmit" style="float:right; width: auto; margin: 1em;" onclick="loadArmorFromDialog(); return false;">take this item</button>
      </form>
    </div>

    <div id="selectShieldDialog" class="dialog" style="max-width:none;">

      <form method="post" id="selectShieldForm" name="selectShieldForm">

        <div class="titlebar">Select Shield</div>

        <div id="selectShieldDialogExtras" class="dialogBody" style="margin-top:1em;">

          <select id="selectShieldMenu" size="7" style="width: 100%;" onchange="showShieldInfoInDialog(this.value);">
          </select>

          <div id="displayShieldWeight" style="float:left; padding: 2px 0pt 0pt;">&nbsp;</div>
          <div id="displayShieldCost" style="float:right; padding: 2px 0pt 0pt;">&nbsp;</div>
          <div id="displayShieldDefense" style="padding: 2px 0pt 0pt;">&nbsp;</div>

          <table id="selectShieldFormTable" class="prefsTable">
            <colgroup>
              <col />
              <col />
              <col />
              <col />
            </colgroup>
            <tbody>
              <tr>
                <th style="text-align:right;">How&nbsp;many&emsp;</th>
                <td><input id="selectShieldAmount" value="1" style="width: 4em;" /></td>
                <th style="text-align:right;">Made&nbsp;of&ensp;</th>
                <td>
                  <select id="selectShieldComposition" style="width:6em;" onchange="showShieldInfoInDialog(this.form.selectShieldMenu.value);">
                    <option value="wood" selected="selected">wood</option>
                    <option value="metal" title="bronze (TL 2+) or iron (TL 3+)">metal</option>
                    <option value="plastic" title="Lexan, etc. (TL 7+)">plastic</option>
                  </select>
                </td>
                <th id="selectShieldBucklerChoiceCell"> <!-- toggle display by ruleset -->
                  <input id="selectShieldBuckler" type="checkbox" style="width:1em;" onchange="showShieldInfoInDialog(this.form.selectShieldMenu.value);" />
                  <label for="selectShieldBuckler">Buckler</label>
                </th>
              </tr>
          </table>

          <div class="fieldsetWrapper">

            <fieldset>
              <legend onclick="toggleFieldset2(document.getElementById('customShieldToggleButton'),'customShieldFormWrapper')" style="cursor:pointer;">
                <img id="customShieldToggleButton" src="../images/plus_blue.gif" />
                Custom Shield
              </legend>
              <div id="customShieldFormWrapper" style="display:none; width:420px; font-size:8pt;">
                <div class="fieldsetNote" style="">If this section is open, stats entered here will be used with those above to create a customized shield and equip the character with it.</div>
                <table id="customShieldFormTable" class="prefsTable">
                  <colgroup>
                    <col />
                    <col style="width:3em;" />
                    <col />
                    <col />
                    <col />
                    <col style="width:3em;" />
                    <col style="width:1em;" />
                    <col style="width:3em;" />
                  </colgroup>
                  <tbody>
                    <tr>
                      <th style="text-align:right;">Name&emsp;</th>
                      <td colspan="7">
                        <input id="customShieldDialogName" name="customShieldDialogName" style="width:100%;"
                               onkeyup="this.form.selectShieldSubmit.value='take '+this.value" />
                      </td>
                    </tr>
                    <tr>
                      <th style="text-align:right;">Description&emsp;</th>
                      <td colspan="7">
                        <input id="customShieldDialogDescription" name="customShieldDialogDescription" style="width:100%;"
                               placeholder="this is optional" />
                      </td>
                    </tr>
                    <tr>
                      <th style="text-align:right;">Cost&ensp;$</th>
                      <td><input id="customShieldDialogCost" name="customShieldDialogCost" style="width:3em;" /></td>
                      <th style="text-align:right;">Weight&emsp;</th>
                      <td>
                        <input id="customShieldDialogWeight" name="customShieldDialogWeight" style="width:3em;" />
                        <span id="customShieldWeightUnit" name="customShieldWeightUnit">lbs</span>
                      </td>
                      <th style="text-align:right;">Skill&emsp;</th>
                      <td colspan="3">
                        <select id="customShieldDialogSkill" name="customShieldDialogSkill" style="width:100%;" >
                        </select>
                      </td>
                    </tr>
                    <tr style="line-height:7px; height:16px;">
                      <td></td>
                      <th id="customShieldPDB" style="text-align:center; vertical-align:bottom;">PD</th>
                      <td></td>
                      <td></td>
                      <td></td>
                      <th style="text-align:center; vertical-align:bottom;" title="The shield's Damage Resistance and Hit Points if using the optional Damage to Shields rule (B120 or Campaigns 484). This DR protects the shield, not the wielder.">DR</th>
                      <th style="text-align:center; vertical-align:bottom;">/</th>
                      <th style="text-align:center; vertical-align:bottom;" title="The shield's Damage Resistance and Hit Points if using the optional Damage to Shields rule (B120 or Campaigns 484). This DR protects the shield, not the wielder.">HP</th>
                    </tr>
                    <tr>
                      <th id="customShieldPDBlabel" style="text-align:right;">&nbsp;Protection&emsp;</th>
                      <td ><input id="customShieldDialogPDB" name="customShieldDialogPDB" style="text-align:center;width:3em;" /></td>
                      <th colspan="3" style="text-align:right;" title="The shield's Damage Resistance and Hit Points if using the optional Damage to Shields rule (B120 or Campaigns 484). This DR protects the shield, not the wielder.">Shield&nbsp;Damage&emsp;</th>
                      <td title="The shield's Damage Resistance and Hit Points if using the optional Damage to Shields rule (B120 or Campaigns 484). This DR protects the shield, not the wielder.">
                        <input id="customShieldDialogDR" name="customShieldDialogDR" style="text-align:center;width:3em;" />
                      </td>
                      <td style="text-align:center;">/</td>
                      <td title="The shield's Damage Resistance and Hit Points if using the optional Damage to Shields rule (B120 or Campaigns 484). This DR protects the shield, not the wielder.">
                        <input id="customShieldDialogHP" name="customShieldDialogHP" style="text-align:center;width:3em;" />
                      </td>
                    </tr>
                    <tr>
                      <th style="text-align:right;" title="Tech Level (see 3rd ed., page 185 or 4th ed., page B22)">Tech&nbsp;Level&emsp;</th>
                      <td colspan="3">
                        <select id="customShieldDialogTL" name="customShieldDialogTL" style="width:12em;">
                        </select>
                      </td>
                      <th style="text-align:right;" title="Legality Class (see 4th ed., page B267)">Legality&nbsp;Class&emsp;</th>
                      <td colspan="3">
                        <select id="customShieldDialogLC" name="customShieldDialogLC" style="width:100%;">
                          <option value="null">[no LC defined]</option>
                          <option value="4" selected="selected">Open (4)</option>
                          <option value="3">Licensed (3)</option>
                          <option value="2">Restricted (2)</option>
                          <option value="1">Military (1)</option>
                          <option value="0">Banned (0)</option>
                        </select>
                      </td>
                    </tr>
                  </tbody>
                </table>
              </div>
            </fieldset>

            <fieldset>
              <legend onclick="toggleFieldset2(document.getElementById('shieldFiltersToggleButton'),'shieldFiltersTable')" style="cursor:pointer;">
                <img id="shieldFiltersToggleButton" src="../images/plus_blue.gif" />
                Filters
              </legend>
              <table id="shieldFiltersTable" style="display: none;">
                <tbody>
                  <tr>
                    <td style="text-align:right;"><label for="shieldDialogAllTLradio">Show shields from all Tech Levels</label></td>
                    <td style="text-align:right;">&nbsp;</td>
                    <td style="text-align:right;"><input id="shieldDialogAllTLradio" name="shieldTLradio" onchange="selectShieldDialog();" type="radio" /></td>
                  </tr>
                  <tr><td style="text-align:right;">&nbsp;</td></tr>
                </tbody>
              </table>
            </fieldset>

            <div style="clear: both;"></div>

            <button                         style="float:left;  width:auto; margin:1em;" onclick="document.getElementById('selectShieldDialog').style.display='none'; return false;">Close</button>
            <button id="selectShieldSubmit" style="float:right; width:auto; margin:1em;" onclick="loadShieldFromDialog(); return false;">take this shield</button>

          </div><!-- .fieldsetWrapper -->

        </div><!-- #selectShieldDialogExtras -->

      </form>

    </div>

    <!-- - - - - - -->

    <div id="manageCollectionsDialog" class="dialog" style="min-width:600px; left:4em; ">

      <style>
        #manageCollectionsForm button {
          margin:  0;
          padding: 0;
          font-weight: bold;
        }
      </style>

      <script>
      // union:'∪', intersection:'∩', difference:'-'
      symbolLookup = { union: '&cup;', intersection: '&cap;', difference: '&minus;' }
      styleLookup  = { union: 20, intersection: 18, difference: 20 };
      </script>

      <form method="post" id="manageCollectionsForm" name="manageCollectionsForm">

        <div class="titlebar">Manage Equipment Collections</div>

        <div style="text-align:center; padding:4px;">
          <div style="width:50%; float:left;">
            All Owned Equipment
          </div>
          Collection:&ensp;
          <select id="collectionsMenu" onchange="loadManageCollectionsMenus(this.value)">
          </select>
        </div>

        <div style="width:50%; float:left;">
          <div style="margin:4px;">
            <select id="allOwnedEquipmentMenu" size="12" style="width:100%;"
                    onclick="matches=this.value.match(/(.*)_(\d+)$/); if(matches) {i=matches[2];g=matches[1];} else {i=this.value;g='collections'}; addToCollection(i,g,document.getElementById('collectionsMenu').value)"
                    title="Click on an item to copy it into the collection.">
            </select>
            <span style="font-size:8pt;">&emsp;Click on an item to copy it into the collection.</span>
          </div>
        </div>

        <div style="width:50%; float:left;">
          <div style="margin:4px;">
            <select id="collectionEquipmentMenu" size="12" style="width:100%;"
                    onclick="removeFromCollection(this.value,document.getElementById('collectionsMenu').value)"
                    title="Click on an item to remove it from the collection.">
            </select>
            <span style="font-size:8pt;">
              &emsp;Click on an item to remove it from the collection.
              <br />
              &emsp;<input type="button" id="editCollectionListButton" class="slimButton" value="Edit this collection list" />
            </span>
          </div>
        </div>

        <div class="clear"></div><!-- spacer -->

        <div class="dialogBody" style="text-align:left;">

          <table class="prefsTable" style="line-height:30px;">
            <tbody>
              <tr>
                <th>
                  <button id="deleteCollectionButton" onclick="deleteCollectionScript(); return false;">
                    Delete&nbsp;the&nbsp;<em id="deleteCollectionNamed">default</em>&nbsp;collection
                  </button>
                  &emsp;
                </th>
                <td></td>
              </tr>
              <tr>
                <th>
                  <button id="renameCollectionButton" onclick="renameCollectionScript(); return false;">
                    Rename&nbsp;the&nbsp;<em id="renameCollectionNamed">default</em>&nbsp;collection
                  </button>
                  &emsp;
                </th>
                <td>
                  <input id="collectionRename" placeholder="new collection name" style="width:100%;" />
                </td>
              </tr>
              <tr>
                <th>
                  <button id="duplicateCollectionButton" onclick="duplicateCollectionScript(); return false;">
                    Duplicate&nbsp;the&nbsp;<em id="duplicateCollectionNamed">default</em>&nbsp;collection as
                  </button>
                  &emsp;
                </th>
                <td>
                  <input id="collectionDuplicate" placeholder="duplicate collection name" style="width:100%;" />
                </td>
              </tr>
              <tr>
                <th>
                  <button onclick="makeNewCollectionScript(); return false;">
                    Create&nbsp;a&nbsp;new&nbsp;empty&nbsp;collection
                  </button>
                  &emsp;
                </th>
                <td>
                  <input id="newCollectionName" placeholder="new collection name" style="width:100%;" />
                </td>
              </tr>
              <tr>
                <th>
                  &nbsp;
                  <select name="setop" style="font-weight:inherit;" onchange="symbolLookup={union:'&cup;', intersection:'&cap;', difference:'&minus;'}; document.getElementById('setopSymbol').innerHTML=symbolLookup[this.value]; styleLookup={union:24, intersection:16, difference:18}; document.getElementById('setopSymbol').style.fontSize=styleLookup[this.value]+'pt';">
                    <option value="union">Combine</option>
                    <option value="intersection">Intersect</option>
                    <option value="difference">Subtract</option>
                  </select>
                  &nbsp;collections&nbsp;below&nbsp;to&nbsp;
                  <button name="combineCollectionsButton" onclick="combineCollections(this.form.setop.value); return false;">
                    build&nbsp;a&nbsp;new&nbsp;collection
                  </button>
                  &emsp;
                </th>
                <td>
                  <input id="combinedCollectionName" placeholder="new collection name" value="new collection" style="width:100%;" />
                </td>
              </tr>
            </tbody>
          </table>

          <table class="prefsTable" style="line-height:30px; width:100%;">
            <tbody>
              <colgroup>
                <col />
                <col />
                <col />
              </colgroup>
              <tr>
                <th>
                  <select id="collectionAMenu" size="5" style="width:20em;">
                  </select>
                </th>
                <td style="width: 3em; text-align: center">
                  <span id="setopSymbol" style="font-size:24pt;">&cup;</span>
                </td>
                <td>
                  <select id="collectionBMenu" size="5" style="width:20em;">
                  </select>
                </td>
              </tr>
            </tbody>
          </table>

        </div>

        <div class="clear" style="text-align:center;">
  <!--
          <input type="submit" value="Cancel"        style="width:auto; margin:1em;"
                onClick="document.getElementById('manageCollectionsDialog').style.display='none'; return false;">
          <input type="submit" value="Apply Changes" style="width:auto; margin:1em; float:right;"
                onClick="applyChangesToCollections(); return false;">
  -->
          <button style="width:8em; margin:1em; text-align:center;"
                 onClick="document.getElementById('manageCollectionsDialog').style.display='none'; return false;">
            Close
          </button>
        </div>

      </form>

    </div>

    <!-- Equip With Collection (not a dialog) -->

    <!-- - - - - - -->

    <!-- Wear / Wield Item (not a dialog) -->



  <!-- not called directly from menu -->
    <div id="selectWieldOptionsDialog" class="dialog">
      <form method="post" name="selectWieldOptionsForm">
        <div class="titlebar">Select Weapon Wielding Options</div>
        <div id="wieldOptions" style="padding: 1em; text-align: center;">
          Select skill with which to use <span id="wieldOptionsWeaponName">the weapon</span>
          <select id="selectWieldSkillMenu" size="6" style="width: 100%;" onchange="showWieldSkillInfoInDialog(this.value);">
          </select>
          <div class="resetDiv" style="padding: 0pt;"></div>
          <div id="selectSkillSpecializationWrapper" style="clear: both; display: none;">
            Select a specialization:<br />
            <select id="selectSkillSpecialization" style="width: 100%;">
            </select>
          </div>
          <div id="displayWieldSkillLevel" style="float:left; padding: 2px 0pt 0pt;">&nbsp;</div>
        </div>
        <div style="clear: both;"></div>
        <!-- need one hidden input to store item's index in the equipped collection for ch.wieldWeapon() -->
        <input name="id" value="" type="hidden" />
        <input value="Close"  style="float:left; width: auto; margin: 1em;" onclick="document.getElementById('selectWieldOptionsDialog').style.display='none'; return false;" type="submit" />
    <!--<input id="selectWieldOptionsSubmit" value="use these options" style="float:right; width: auto; margin: 1em;" onclick="click2useToggle(this.parentNode.item.value,this.parentNode.row.value,this.parentNode.type.value); return false;" type="submit" />-->
        <input id="selectWieldOptionsSubmit" value="use these options" style="float:right; width: auto; margin: 1em;" onclick="click2useToggle(this.parentNode.id.value,this.parentNode.selectWieldSkillMenu.value); return false;" type="submit" />
      </form>
    </div>


    <div id="popupListDiv" class="dialog">
      <table id="popupListTable" style="font: 8pt Verdana, ariel, sans-serif;">
      </table>
    </div>


    <div id="editListDialog" class="dialog" style="">

       <style>
      #editListTableBody .ui-selecting {
        border: 2px solid blue;
      }
      #editListTableBody .ui-selected {
        background: 2px solid black;
      }
      </style>

      <div class="titlebar">Edit <span id="listName"></span> List</div>

      <div class="dialogBody" style="margin: 1em 0;">
    
        <p>
          Drag list items to rearrange the list.
          Use buttons to add headers or spacers.
          Double-click headers/spacers to remove.
          Skills cannot be edited or deleted here.
        </p>
  <!--
        <button id="editOtherListButton" type="button" style="margin-top:0;">
          Edit <span id="editOtherList"></span> list instead
        </button>
  -->
        <div style="overflow-y:auto; border: 2px ridge; max-height:400px; margin-bottom:4px;">
          <table id="editListTable" style="font: 8pt Verdana, ariel, sans-serif;">
            <tbody id="editListTableBody" class="rearrangeable">
            </tbody>
          </table>
        </div>

        <input type="hidden" name="editListType" value="" />

        <input type="button" id="addSpacerButton"  class="slimButton" value="Add spacer row" title="New spacer row will be created at the end of the list; drag it to desired position." />
        <input type="button" id="addHeadingButton" class="slimButton" value="Add heading row" title="New heading row will be created at the end of the list; drag it to desired position." />

      </div>

      <input  type="hidden" id="editListType" name="editListType" value="" />
      <button type="button" style="float:left;"  onclick="document.getElementById('editListDialog').style.display='none';">Close</button>
      <button type="button" style="float:right;" onclick="applyListEdits();" id="editTraitSubmit">Apply list edits</button>

    </div>

  </div><!-- csheet_dialogs -->

  <div id="navWrapper" style="position:fixed; top:0px; overflow:visible; z-index:50;">

  <ul id="nav">

    <li class="top">
    	<a href="" class="top_link" onclick="return false;" style="padding:0;">
	    	<span class="down" style="padding: 0 8px;"><img src="../images/SJGames_logo.jpg" style="width: 15px; margin-top: 8px;" /></span>
    	</a>
    	<ul class="sub wide">
    		<li><a href="http://www.sjgames.com/gurps/" style="padding:0;"><span>GURPS @ SJ Games</span></a></li>
        <li><hr /></li>
        <li id="loadedLibrariesFlyout"><a class="flywide">Loaded Libraries</a>
          <ul class="wider" style="width:160px;"><!-- 3<sup>rd</sup> -->
            <li></li>
          </ul>
        </li>
    	</ul>
    </li>

    <li class="top">
    	<a href="" id="file" class="top_link" onclick="return false;"><span class="down">File</span></a>
      <ul class="sub wide">
        <li><a onclick="newCharacterDialog();  return false;" >New Character</a></li>
        <li><a onclick="openFileDialog();      return false;" >Open Character File</a></li>
        <li><a onclick="openURLDialog();       return false;" >Open Character URL</a></li>
        <li><a class="flywide">Open New Sheet</a>
          <ul style="width:120px;">
            <li><a id="open_new_3e1pg_sheet_link"            onclick="window.open('3e1pg.html','_blank');            return false;">3<sup>rd</sup> Edition, 1 page</a></li>
            <li><a id="open_new_3e2pg_sheet_link"            onclick="window.open('3e2pg.html','_blank');            return false;">3<sup>rd</sup> Edition, 2 page</a></li>
            <li><a id="open_new_4e2pg_sheet_link"            onclick="window.open('4e2pg.html','_blank');            return false;">4<sup>th</sup> Edition</a></li>
            <li><a id="open_new_4e2pg_landscape1_sheet_link" onclick="window.open('4e2pg_landscape1.html','_blank'); return false;">4<sup>th</sup> Edition landscape 1</a></li>
            <li><a id="open_new_4e2pg_landscape2_sheet_link" onclick="window.open('4e2pg_landscape2.html','_blank'); return false;">4<sup>th</sup> Edition landscape 2</a></li>
            <li><a id="open_new_Jim4e_sheet_link"            onclick="window.open('Jim4e.html','_blank');            return false;">4<sup>th</sup> Edition remix</a></li>
            <li><a id="open_new_Jim4e_halfpg_sheet_link"     onclick="window.open('Jim4e_halfpg.html','_blank');     return false;">4<sup>th</sup> Edition small</a></li>
            <li><a id="open_new_NPCcard_link"                onclick="window.open('NPCcard.html','_blank');          return false;">4<sup>th</sup> Edition NPC card</a></li>
          </ul>
        </li>
        <li><hr /></li>
        <li><a onclick="loadedCharacter.viewCharacterAsFile(); return false;">View As File</a></li>
        <li><a id="SaveAsFileLink" class="disabled" style="color:grey;">Save As File</a></li>
        <li><a id="SaveAsTemplateLink" onclick="saveAsTemplateDialog()">Save As Template</a></li>
        <li><hr /></li>
<!--
        <li><a class="disabled" style="color:grey;" onclick="$('#uploadLibrary').trigger('click'); return false;">Import Library</a></li>
        <li><hr /></li>
-->
        <li><a onclick="applyCharacterArtDialog(); return false;">Add Character Art</a></li>
        <li><hr /></li>
        <li><a onclick="window.print(); return false;">Print</a></li>
      </ul>
    </li>

    <li class="top"><a href="" id="edit" class="top_link" onclick="return false;"><span class="down">Edit</span></a>
      <ul class="sub wide">
        <li><a class="disabled" id="undoMenuText" style="color:grey;">Can't Undo</a></li>
        <li><a class="disabled" id="redoMenuText" style="color:grey;">Can't Redo</a></li>
        <li><hr /></li>
        <li><a onclick="editTraitDialog(); return false;">Edit Ads / Disads</a></li>
        <li><a onclick="editSkillDialog(); return false;">Edit Skills / Spells</a></li>
        <li><a onclick="languagesDialog(true); return false">Edit Languages</a></li>
        <li><a onclick="editEquipmentDialog()">Edit Equipment</a></li>
        <li><a onclick="editLinkersDialog(); return false;">Edit Linkers</a></li>
        <li><hr /></li>
        <li><a onclick="editCharacterInfoDialog(); return false;">Edit Character Info</a></li>
        <li><a onclick="editGameInfoDialog(); return false;">Edit Game Info</a></li>
        <li><hr /></li>
        <li><a onclick="openPrefsDialog(); return false;">Preferences</a></li>
      </ul>
    </li>

    <li class="top"><a href="" id="build" class="top_link" onclick="return false;"><span class="down">Build</span></a>
      <ul class="sub wide">
        <li><a onclick="selectTraitsDialog(); return false;">Ads / Disads</a></li>
        <li><a onclick="createQuirkPerkDialog(); return false;">Perks / Quirks</a></li>
        <li><hr /></li>
        <li><a onclick="customTalentDialog(); return false;">Build Talent</a></li>
        <li><hr /></li>
        <li><a onclick="selectSkillDialog()">Skills / Spells</a></li>
        <li><a onclick="defineTechniqueDialog()" title="called 'Maneuvers' in 3rd edition GURPS">Techniques</a></li>
        <li><hr /></li>
        <li><a onclick="languagesDialog(); return false">Languages</a></li>
        <li><a onclick="culturalFamiliaritiesDialog(); return false">Cultural Familiarities</a></li>
        <li><hr /></li>
        <li><a onclick="chooseTemplateDialog(); return false">Use a Template</a></li>
      </ul>
    </li>

    <li class="top"><a id="equip" class="top_link"><span class="down">Equip</span></a>
      <ul class="sub wide">
        <li><a onclick="selectEquipmentDialog()">Basic Equipment</a></li>
        <li><a onclick="selectWeaponDialog()">Weapons</a></li>
        <li><a onclick="selectArmorDialog()">Armor</a></li>
        <li><a onclick="selectShieldDialog()">Shield</a></li>
        <li><hr /></li>
        <li><a onclick="manageCollectionsDialog()">Manage Collections</a></li>
        <li><a class="flywide">Equip with Collection</a>
          <ul id="navbarCollectionsList">
          	<li><a onclick="equipWith('default')" style="width:90px">default collection</a></li>
          </ul>
        </li>
        <li><hr /></li>
        <li id="wearWieldItemMenu"><a class="flywide">Wear / Wield Item</a></li>
      </ul>
    </li>
<!--
    <li class="top"><a id="equip" class="top_link"><span class="down">Data</span></a>
      <ul class="sub" style="width:100px">
        <li><a onclick="openTranslateGDFsWindow()" style="width:100px" title="requires internet access">Translate GDFs</a></li>
        <li><a onclick="loadDataFileWindow()" style="color: grey; width:100px">Load Data File</a></li>
      </ul>
    </li>
-->
    <!-- Example of menu with sub-menus (and sub-sub-sub-etc-menus) -->
    <!--
    <li class="top"><a href="#nogo27" id="contacts" class="top_link"><span class="down">Contacts</span></a>
      <ul class="sub">
        <li><a href="#nogo28">Support</a></li>
        <li><a href="#nogo29" class="fly">Sales</a>
          <ul>
            <li><a href="#nogo30">USA</a></li>
            <li><a href="#nogo31">Canadian</a></li>
            <li><a>South American</a></li>
            <li><a href="#nogo33" class="fly">European</a>
              <ul>
                <li><a href="#nogo34" class="fly">British</a>
                  <ul>
                    <li><a href="#nogo35">London</a></li>
                    <li><a href="#nogo36">Liverpool</a></li>
                    <li><a href="#nogo37">Glasgow</a></li>
                    <li><a href="#nogo38" class="fly">Bristol</a>
                      <ul>
                        <li><a href="#nogo39">Redland</a></li>
                        <li><a href="#nogo40">Hanham</a></li>
                        <li><a href="#nogo41">Eastville</a></li>
                      </ul>
                    </li>
                    <li><a href="#nogo42">Cardiff</a></li>
                    <li><a href="#nogo43">Belfast</a></li>
                  </ul>
                </li>
                <li><a href="#nogo44">French</a></li>
                <li><a href="#nogo45">German</a></li>
                <li><a href="#nogo46">Spanish</a></li>
              </ul>
            </li>
            <li><a href="#nogo47">Australian</a></li>
            <li><a href="#nogo48">Asian</a></li>
          </ul>
        </li>
        <li><a href="#nogo49">Buying</a></li>
        <li><a href="#nogo50">Photographers</a></li>
        <li><a href="#nogo51">Stockist</a></li>
        <li><a href="#nogo52">General</a></li>
      </ul>
    </li>

    <li class="top"><a href="" class="top_link" onclick="return false;"><span>NAVBAR IS INCLUDED</span></a></li>
    -->

  </ul>

</div><!-- navWrapper -->


  <div class="wrapper" style="height:3in; width:5in; overflow:visible">

    <div style="float:left; width:1.9in; height:2.9in; padding:0.05in">

      <div style="float:left;">Name:&ensp;</div>
      <div class="scribed">
        <input id="nameBox" type="text" class="editable " style="width:100%; " onChange="loadedCharacter.description.name=this.value; loadCharacter(loadedCharacter);" />
      </div>
      <div style="float:left; padding-top:1px">Appearance:&ensp;</div>
      <div style="">
        <input id="appearanceBox" type="text" class="editable scribed" style="width:100%;" onChange="loadedCharacter.description.appearance=this.value; loadCharacter(loadedCharacter);" />
      </div>
      <br />

      <div style="width:0.6in; float:left;">
        <div id="STbox" class="scribed fill-in" style="float:left; width:30px;">&nbsp;</div>
        <div                                    style="font-weight:900; text-align:left; ">&nbsp;ST</div>
        <div id="DXbox" class="scribed fill-in" style="float:left; width:30px;">&nbsp;</div>
        <div                                    style="font-weight:900; text-align:left; ">&nbsp;DX</div>
        <div id="IQbox" class="scribed fill-in" style="float:left; width:30px;">&nbsp;</div>
        <div                                    style="font-weight:900; text-align:left; ">&nbsp;IQ</div>
        <div id="HTbox" class="scribed fill-in" style="float:left; width:30px;">&nbsp;</div>
        <div                                    style="font-weight:900; text-align:left;">&nbsp;HT</div>
        <div style="float:left; ">Will</div><div><div id="Willbox" class="scribed fill-in" style="width:90%;">&nbsp;</div></div>
      </div>

      <div style="width:1.3in; float:left">
        <div style="float:left; ">HP: </div>    <div id="HPbox"  class="scribed fill-in" style="float:left; width:30px;">&nbsp;</div><div style="float:left;">&ensp;</div><div><div class="scribed fill-in" style="width:100%;"><input id="currentHPbox" type="text" class="fill-in editable" style="text-align:center; height:15px; margin-top:-2px;" onChange="document.loadedCharacter.description.currentHP=this.value; loadCharacter(document.loadedCharacter);" /></div></div>
        <div style="text-align:center; width:100%;">Basic&nbsp;Damage</div>
        <div style="clear:both; float:left; font-style:italic">Thrust:</div><div><div id="ThrDmg" class="scribed fill-in" style="width:100%;">&nbsp;</div></div>
        <div style="clear:both; float:left; font-style:italic">Swing:</div> <div><div id="SwDmg"  class="scribed fill-in" style="width:100%;">&nbsp;</div></div>
        <div style="float:left; ">FP:</div>     <div id="FPbox"  class="scribed fill-in" style="float:left; width:30px;">&nbsp;</div><div style="float:left;">&ensp;</div><div><div class="scribed fill-in" style="width:100%;"><input id="currentFPbox" type="text" class="fill-in editable" style="text-align:center; height:15px; margin-top:-2px;" onChange="document.loadedCharacter.description.currentFP=this.value; loadCharacter(document.loadedCharacter);" /></div></div>
        <div style="float:left; ">Per</div><div><div id="Perbox" class="scribed fill-in" style="width:100%;">&nbsp;</div></div>
      </div>

      <div style="width:1.9in;">
        <div style="float:left;">Basic&nbsp;Speed:</div><div id="basicSpeedBox" class="scribed fill-in" style="float:left;width:40px;">&nbsp;</div><div style="float:left;">&nbsp;Move:</div><div><div id="basicMoveBox"  class="scribed fill-in" style="width:100%;">&nbsp;</div></div>
        <div style="float:left;">Encumbrance:</div><div><div id="encumbranceBox"  class="scribed fill-in" style="width:100%; text-align:center;">&nbsp;</div></div>
        <div style="float:left;">Dodge:</div><div id="dodgeBox" class="scribed fill-in" style="float:left;width:25px;">&nbsp;</div><div style="float:left;">&nbsp;Parry:</div><div id="parryBox" class="scribed fill-in" style="float:left;width:25px;">&nbsp;</div><div style="float:left;">&nbsp;Block:</div><div><div id="blockBox"  class="scribed fill-in" style="width:100%;">&nbsp;</div></div>

        <div style="float:left;">Shield&nbsp;DB</div>
        <div id="basicSpeedBox" class="scribed fill-in" style="float:left;width:30px;">&nbsp;</div>
        <div style="float:left;">&nbsp;Size&nbsp;Modifier</div>
        <div><div id="sizeModBox"  class="scribed fill-in" style="width:100%;">&nbsp;</div></div>
      </div>

      <table class="angledHeaders" style="margin-top:20px;">
        <tr style="height:30px;">
          <td></td>
          <td><div>Head</div></td>
          <td><div>Torso</div></td>
          <td><div>Arms</div></td>
          <td><div>Hands</div></td>
          <td><div>Legs</div></td>
          <td><div>Feet</div></td>
        </tr>
        <tr class="BPgridrow" title="DR listed here is from armor ONLY">
          <td style="border:none;">DR</td>
          <td id="headArmorDRbox"  class="fill-in"></td>
          <td id="bodyArmorDRbox"  class="fill-in"></td>
          <td id="armsArmorDRbox"  class="fill-in"></td>
          <td id="handsArmorDRbox" class="fill-in"></td>
          <td id="legsArmorDRbox"  class="fill-in"></td>
          <td id="feetArmorDRbox"  class="fill-in"></td>
        </tr>
      </table>

    </div>

    <div style="width:2.9in; height:2.9in; padding:0.05in;">
		  <div style="height:14px"><div style="float:left;">Reaction&nbsp;+/-:</div> <div id="reactionModsBox" class="scribed fill-in" style="float:left;width:110px;">&nbsp;</div> <div style="float:left;">&ensp;Point&nbsp;Total:</div> <div><input id="pointTotalBox" type="text" class="editable scribed" style="text-align:center; height:12px; width:100%" onChange="loadedCharacter.pointTotal(1*this.value); loadCharacter(loadedCharacter);" /></div></div>
      <div class="clickable" onclick="openEditListDialog('traits')" title="click here to edit the Traits list" style="position:absolute; text-align:left; z-index:5; background-color:white; height:16px; line-height:18px;">Advantages,&nbsp;Disadvantages,&nbsp;Quirks:</div>
      <div id="TraitsBox" class="scribed-box16" style="height:0.82in; text-align:left; overflow-y:auto; clear:both;">
        <span>Advantages,&nbsp;Disadvantages,&nbsp;Quirks:</span>
        <span id="trait1"  class="fill-in" ></span>
        <span id="trait2"  class="fill-in" ></span>
        <span id="trait3"  class="fill-in" ></span>
        <span id="trait4"  class="fill-in" ></span>
        <span id="trait5"  class="fill-in" ></span>
        <span id="trait6"  class="fill-in" ></span>
        <span id="trait7"  class="fill-in" ></span>
        <span id="trait8"  class="fill-in" ></span>
        <span id="trait9"  class="fill-in" ></span>
        <span id="trait10" class="fill-in" ></span>
        <span id="trait11" class="fill-in" ></span>
        <span id="trait12" class="fill-in" ></span>
        <span id="trait13" class="fill-in" ></span>
        <span id="trait14" class="fill-in" ></span>
        <span id="trait15" class="fill-in" ></span>
        <span id="trait16" class="fill-in" ></span>
        <span id="trait17" class="fill-in" ></span>
        <span id="trait18" class="fill-in" ></span>
        <span id="trait19" class="fill-in" ></span>
        <span id="trait20" class="fill-in" ></span>
        <span id="trait21" class="fill-in" ></span>
        <span id="trait22" class="fill-in" ></span>
        <span id="trait23" class="fill-in" ></span>
        <span id="trait24" class="fill-in" ></span>
        <span id="trait25" class="fill-in" ></span>
        <span id="trait26" class="fill-in" ></span>
        <span id="trait27" class="fill-in" ></span>
        <span id="trait28" class="fill-in" ></span>
        <span id="trait29" class="fill-in" ></span>
        <span id="trait30" class="fill-in" ></span>
        <span id="trait31" class="fill-in" ></span>
        <span id="trait32" class="fill-in" ></span>
        <span id="trait33" class="fill-in" ></span>
        <span id="trait34" class="fill-in" ></span>
        <span id="trait35" class="fill-in" ></span>
        <span id="trait36" class="fill-in" ></span>
        <span id="trait37" class="fill-in" ></span>
        <span id="trait38" class="fill-in" ></span>
        <span id="trait39" class="fill-in" ></span>
        <span id="trait40" class="fill-in" ></span>
      </div>
      <input type="hidden" id="traitsTableVisibleLength" name="traitsTableVisibleLength" value="100" /><!-- of course not, but this sheet will never have a supplement -->
      <div class="clickable" onclick="openEditListDialog('skills')" title="click here to edit the Skills list" style="position:absolute; text-align:left; z-index:5; background-color:white; line-height:18px;">Skills:&nbsp;</div>
      <div id="SkillsBox" class="scribed-box16" style="height:0.84in; text-align:left; overflow-y:auto;">
        <span>Skills:&nbsp;</span>
        <span id="skillCompact1" ></span>
        <span id="skillCompact2" ></span>
        <span id="skillCompact3" ></span>
        <span id="skillCompact4" ></span>
        <span id="skillCompact5" ></span>
        <span id="skillCompact6" ></span>
        <span id="skillCompact7" ></span>
        <span id="skillCompact8" ></span>
        <span id="skillCompact9" ></span>
        <span id="skillCompact10"></span>
        <span id="skillCompact11"></span>
        <span id="skillCompact12"></span>
        <span id="skillCompact13"></span>
        <span id="skillCompact14"></span>
        <span id="skillCompact15"></span>
        <!-- 15 or so fit before scrolling -->
        <span id="skillCompact16"></span>
        <span id="skillCompact17"></span>
        <span id="skillCompact18"></span>
        <span id="skillCompact19"></span>
        <span id="skillCompact20"></span>
        <span id="skillCompact21"></span>
        <span id="skillCompact22"></span>
        <span id="skillCompact23"></span>
        <span id="skillCompact24"></span>
        <span id="skillCompact25"></span>
        <span id="skillCompact26"></span>
        <span id="skillCompact27"></span>
        <span id="skillCompact28"></span>
        <span id="skillCompact29"></span>
        <span id="skillCompact30"></span>
        <span id="skillCompact31"></span>
        <span id="skillCompact32"></span>
        <span id="skillCompact33"></span>
        <span id="skillCompact34"></span>
        <span id="skillCompact35"></span>
        <span id="skillCompact36"></span>
        <span id="skillCompact37"></span>
        <span id="skillCompact38"></span>
        <span id="skillCompact39"></span>
        <span id="skillCompact40"></span>
        <span id="skillCompact41"></span>
        <span id="skillCompact42"></span>
        <span id="skillCompact43"></span>
        <span id="skillCompact44"></span>
        <span id="skillCompact45"></span>
        <span id="skillCompact46"></span>
        <span id="skillCompact47"></span>
        <span id="skillCompact48"></span>
        <span id="skillCompact49"></span>
        <span id="skillCompact50"></span>
        <span id="skillCompact51"></span>
        <span id="skillCompact52"></span>
        <span id="skillCompact53"></span>
        <span id="skillCompact54"></span>
        <span id="skillCompact55"></span>
        <span id="skillCompact56"></span>
        <span id="skillCompact57"></span>
        <span id="skillCompact58"></span>
        <span id="skillCompact59"></span>
        <span id="skillCompact60"></span>
        <span id="skillCompact61"></span>
        <span id="skillCompact62"></span>
        <span id="skillCompact63"></span>
        <span id="skillCompact64"></span>
        <span id="skillCompact65"></span>
        <span id="skillCompact66"></span>
        <span id="skillCompact67"></span>
        <span id="skillCompact68"></span>
        <span id="skillCompact69"></span>
        <span id="skillCompact70"></span>
        <span id="skillCompact71"></span>
        <span id="skillCompact72"></span>
        <span id="skillCompact73"></span>
        <span id="skillCompact74"></span>
        <span id="skillCompact75"></span>
        <span id="skillCompact76"></span>
        <span id="skillCompact77"></span>
        <span id="skillCompact78"></span>
        <span id="skillCompact79"></span>
        <span id="skillCompact80"></span>
        <span id="skillCompact81"></span>
        <span id="skillCompact82"></span>
        <span id="skillCompact83"></span>
        <span id="skillCompact84"></span>
        <span id="skillCompact85"></span>
        <span id="skillCompact86"></span>
        <span id="skillCompact87"></span>
        <span id="skillCompact88"></span>
        <span id="skillCompact89"></span>
        <span id="skillCompact90"></span>
        <span id="skillCompact91"></span>
        <span id="skillCompact92"></span>
        <span id="skillCompact93"></span>
        <span id="skillCompact94"></span>
        <span id="skillCompact95"></span>
        <span id="skillCompact96"></span>
        <span id="skillCompact97"></span>
        <span id="skillCompact98"></span>
        <span id="skillCompact99"></span>
      </div>
      <input type="hidden" id="skillsTableVisibleLength" name="skillsTableVisibleLength" value="100" /><!-- of course not, but this sheet will never have a supplement -->
      <div style="position:absolute; text-align:left; z-index:5; background-color:white; line-height:18px;">Weapon&nbsp;Statistics:&ensp;</div>
      <div id="WeaponStatsBox" class="scribed-box16" style="height:1.15in; text-align:left; overflow-y:auto;">
        <span>Weapon&nbsp;Statistics:&ensp;</span>
        <span id="equipItemCompact1" ></span>
        <span id="equipItemCompact2" ></span>
        <span id="equipItemCompact3" ></span>
        <span id="equipItemCompact4" ></span>
        <span id="equipItemCompact5" ></span>
        <span id="equipItemCompact6" ></span>
        <span id="equipItemCompact7" ></span>
        <span id="equipItemCompact8" ></span>
        <span id="equipItemCompact9" ></span>
        <span id="equipItemCompact10"></span>
        <span id="equipItemCompact11"></span>
        <span id="equipItemCompact12"></span>
        <span id="equipItemCompact13"></span>
        <span id="equipItemCompact14"></span>
        <span id="equipItemCompact15"></span>
        <span id="equipItemCompact16"></span>
        <span id="equipItemCompact17"></span>
        <span id="equipItemCompact18"></span>
        <span id="equipItemCompact19"></span>
        <span id="equipItemCompact20"></span>
      </div>
      <input type="hidden" id="stuffTableVisibleLength" name="stuffTableVisibleLength" value="100" /><!-- of course not, but this sheet will never have a supplement -->
    </div>

  </div><!-- csheet_pg1_wrapper -->


</body>

<script>
  $( window ).load( initializeSheet );
</script>

</html>